"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[496],{7496:(W,v,r)=>{r.r(v),r.d(v,{MyGradesModule:()=>P});var g=r(9808),p=r(5357),f=r(4707),G=r(4782),d=r(4004),h=r(9841),y=r(3900),M=r(4128),C=r(8029),c=r(3978),e=r(5e3),$=r(1303),I=r(2024),Z=r(9118),z=r(4381),L=r(6401),T=r(6629);let u=(()=>{class s{constructor(t,a,E,X,b,D,V){var m;this.storageService=t,this.loadingService=a,this.coursesRestService=E,this.subscriptionRestService=X,this.reportsService=b,this.gradingScalesRestService=D,this.settings=V,this.studentId$=new f.t(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe((0,G.d)(1)),this.studentCoursesSorted$=this.studentCourses$.pipe((0,d.U)(o=>o.slice().sort((i,l)=>i.Designation.localeCompare(l.Designation)).map(i=>{var l;return Object.assign(Object.assign({},i),{Tests:(null===(l=i.Tests)||void 0===l?void 0:l.filter(K=>K.IsPublished))||null})}))),this.studentCourseIds$=this.studentCourses$.pipe((0,d.U)(o=>o.flatMap(i=>i.Id))),this.idSubscriptions$=(0,h.a)([this.studentId$,this.studentCourseIds$]).pipe((0,y.w)(([o,i])=>this.subscriptionRestService.getIdSubscriptionsByStudentAndCourse(o,i))),this.ids$=this.idSubscriptions$.pipe((0,d.U)(o=>o.map(i=>i.Id))),this.testReportUrl$=this.ids$.pipe((0,d.U)(o=>this.reportsService.getSubscriptionReportUrl(this.settings.testsBySubscriptionReportId,o))),this.tests$=this.studentCourses$.pipe((0,d.U)(o=>o.flatMap(i=>i.Tests).filter(c.Nf))),this.gradingScaleIdsFromTests$=this.tests$.pipe((0,d.U)(o=>[...o.map(i=>i.GradingScaleId)].filter(c.Tw))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe((0,d.U)(o=>o.flatMap(i=>i.GradingScaleId).filter(c.Nf).filter(c.Tw))),this.gradingScaleIds$=(0,h.a)([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe((0,d.U)(([o,i])=>o.concat(i).filter(c.Tw))),this.gradingScales$=this.gradingScaleIds$.pipe((0,y.w)(o=>(0,M.D)(o.map(i=>this.gradingScalesRestService.getGradingScale(i)))));const S=null===(m=this.storageService.getPayload())||void 0===m?void 0:m.id_person;S&&this.studentId$.next(Number(S))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}}return s.\u0275fac=function(t){return new(t||s)(e.LFG($.V),e.LFG(I.b),e.LFG(Z.s),e.LFG(z.o),e.LFG(L.F),e.LFG(T.R),e.LFG(C.L))},s.\u0275prov=e.Yz7({token:s,factory:s.\u0275fac}),s})(),F=(()=>{class s{constructor(){}}return s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["erz-my-grades"]],features:[e._Bn([u])],decls:1,vars:0,template:function(t,a){1&t&&e._UZ(0,"router-outlet")},directives:[p.lC],styles:[""]}),s})();var U=r(8980),R=r(1104),A=r(8995);let x=(()=>{class s{constructor(t){this.myGradesService=t}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(u))},s.\u0275cmp=e.Xpm({type:s,selectors:[["erz-my-grades-header"]],decls:9,vars:6,consts:[[1,"d-flex","justify-content-between","header"],["target","_blank",1,"report","btn","btn-primary",3,"href"],[1,"material-icons"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.TgZ(1,"div"),e._uU(2),e.ALo(3,"translate"),e.qZA(),e.TgZ(4,"div"),e.TgZ(5,"a",1),e.ALo(6,"async"),e.TgZ(7,"i",2),e._uU(8,"description"),e.qZA(),e.qZA(),e.qZA(),e.qZA()),2&t&&(e.xp6(2),e.Oqu(e.lcZ(3,2,"my-grades.header")),e.xp6(3),e.Q6J("href",e.lcZ(6,4,a.myGradesService.testReportUrl$),e.LSH))},pipes:[A.X$,g.Ov],styles:[".header[_ngcontent-%COMP%]{padding-left:1.5rem;padding-bottom:1.5rem}@media (max-width: 750px){.header[_ngcontent-%COMP%]{padding-right:1.5rem}}.report[_ngcontent-%COMP%]{margin-left:1.5rem}"]}),s})();var w=r(7681),B=r(2925);function O(s,n){if(1&s&&e._UZ(0,"erz-dossier-grades-view",4),2&s){const t=e.oxw().erzLet;e.Q6J("courses",t.courses)("studentId",t.studentId)("gradingScales",t.gradingScales)("isEditable",!1)}}function J(s,n){1&s&&(e.ynx(0),e._UZ(1,"erz-spinner"),e.BQk())}function Q(s,n){if(1&s&&(e.ynx(0),e._UZ(1,"erz-my-grades-header"),e.YNc(2,O,1,4,"erz-dossier-grades-view",2),e.YNc(3,J,2,0,"ng-container",3),e.BQk()),2&s){const t=n.erzLet;e.xp6(2),e.Q6J("ngIf",!t.loading),e.xp6(1),e.Q6J("ngIf",t.loading)}}const j=function(s,n,t,a){return{loading:s,studentId:n,courses:t,gradingScales:a}},N=[{path:"",component:F,children:[{path:"",component:(()=>{class s{constructor(t){this.myGradesService=t}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(u))},s.\u0275cmp=e.Xpm({type:s,selectors:[["erz-my-grades-show"]],features:[e._Bn([U.S])],decls:6,vars:14,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y","erz-container-padding-x-responsive"],[4,"erzLet"],[3,"courses","studentId","gradingScales","isEditable",4,"ngIf"],[4,"ngIf"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(t,a){1&t&&(e.TgZ(0,"div",0),e.YNc(1,Q,4,2,"ng-container",1),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.qZA()),2&t&&(e.xp6(1),e.Q6J("erzLet",e.l5B(9,j,e.lcZ(2,1,a.myGradesService.loading$),e.lcZ(3,3,a.myGradesService.studentId$),e.lcZ(4,5,a.myGradesService.studentCoursesSorted$),e.lcZ(5,7,a.myGradesService.gradingScales$))))},directives:[R.e,x,g.O5,w.d,B.O],pipes:[g.Ov],styles:[""]}),s})()}]}];let Y=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[p.Bz.forChild(N)],p.Bz]}),s})();var H=r(9415);let P=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[g.ez,Y,H.m]]}),s})()}}]);