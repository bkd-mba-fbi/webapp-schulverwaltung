import{l as U,m as V,n as J,s as K}from"./chunk-YS4AKCSY.js";import{i as Y}from"./chunk-XWISOVKN.js";import{e as H,f as N}from"./chunk-6LRQCBUO.js";import"./chunk-Y4QYVF5K.js";import"./chunk-JE6RMKPQ.js";import"./chunk-RXV77OBQ.js";import"./chunk-M3VKTN3S.js";import{a as O}from"./chunk-USF5QQBL.js";import{b as z}from"./chunk-YCHMPHMO.js";import"./chunk-GXPB5I4C.js";import"./chunk-D2H555EG.js";import{i as q}from"./chunk-QWYAXZZX.js";import"./chunk-KKDVS2NL.js";import"./chunk-WNZFLLQC.js";import"./chunk-DVBPCEX4.js";import{b as M}from"./chunk-GH7I4V3C.js";import{H as A,O as j,s as T}from"./chunk-RYYQAFJB.js";import{Ac as y,Bc as C,Cc as b,Fc as I,Gc as P,Hb as _,Ib as D,Jb as B,Lc as o,Mc as d,Ob as v,Pb as f,Q as k,Qb as m,Rb as p,X as u,_ as h,dc as F,fb as a,ha as L,j as w,je as $,ma as s,o as x,rc as S,sc as g,t as n,td as G,u as E,ub as c}from"./chunk-CHBP6U4G.js";var l=(()=>{class t{constructor(){this.storageService=s(O),this.loadingService=s(H),this.coursesRestService=s(U),this.subscriptionRestService=s(z),this.reportsService=s(Y),this.gradingScalesRestService=s(V),this.loading$=this.loadingService.loading$,this.studentId$=new w(1),this.subscriptionAndEventsIds$=this.studentId$.pipe(h(this.loadSubscriptionAndEventIds.bind(this)),u(1)),this.subscriptionIds$=this.subscriptionAndEventsIds$.pipe(n(e=>e.subscriptionIds)),this.eventIds$=this.subscriptionAndEventsIds$.pipe(n(e=>e.eventIds)),this.studentCourses$=this.eventIds$.pipe(h(this.loadCourses.bind(this))).pipe(u(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(n(e=>e.slice().sort((i,ee)=>i.Designation.localeCompare(ee.Designation)))),this.testReports$=this.subscriptionIds$.pipe(n(e=>this.reportsService.getStudentSubscriptionGradesReports(e))),this.tests$=this.studentCourses$.pipe(n(e=>e.flatMap(i=>i.Tests).filter(M))),this.gradingScaleIds$=E([this.tests$.pipe(n(e=>[...e.map(i=>i.GradingScaleId)])),this.studentCourses$.pipe(n(e=>e.map(i=>i.GradingScaleId)))]).pipe(n(([e,i])=>j([...e,...i]).filter(M)),k(A),u(1)),this.gradingScales$=this.gradingScaleIds$.pipe(h(e=>this.gradingScalesRestService.getListForIds(e)),u(1));let r=this.storageService.getPayload()?.id_person;r&&this.studentId$.next(Number(r))}loadCourses(r){return r.length===0?x([]):this.loadingService.load(this.coursesRestService.getCoursesForMyGrades(r))}loadSubscriptionAndEventIds(r){return this.loadingService.load(this.subscriptionRestService.getSubscriptionsByStudent(r).pipe(n(e=>({subscriptionIds:e.map(i=>i.Id),eventIds:e.map(i=>i.EventId).filter(M)}))))}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=L({token:t,factory:t.\u0275fac})}}return t})();var te=()=>[],Q=(()=>{class t{constructor(){this.myGradesService=s(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-header"]],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(e,i){e&1&&(f(0,"div",0)(1,"div"),S(2),o(3,"translate"),m(),f(4,"div"),p(5,"bkd-reports-link",1),o(6,"async"),m()()),e&2&&(a(2),g(d(3,2,"my-grades.header")),a(3),v("reports",d(6,4,i.myGradesService.testReports$)??P(6,te)))},dependencies:[N,G,$],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return t})();function ie(t,Z){t&1&&p(0,"bkd-spinner")}function re(t,Z){if(t&1&&p(0,"bkd-dossier-grades-view",1),t&2){F();let r=b(0),e=b(2),i=b(4);v("courses",r)("studentId",e)("gradingScales",i)("isEditable",!1)}}var W=(()=>{class t{constructor(){this.myGradesService=s(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-show"]],features:[I([J])],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(e,i){e&1&&(y(0),o(1,"async"),y(2),o(3,"async"),y(4),o(5,"async"),f(6,"div",0)(7,"h1"),S(8),o(9,"translate"),m(),p(10,"bkd-my-grades-header"),_(11,ie,1,0,"bkd-spinner"),o(12,"async"),D(13,re,1,4,"bkd-dossier-grades-view",1),m()),e&2&&(C(d(1,2,i.myGradesService.studentCoursesSorted$)),a(2),C(d(3,5,i.myGradesService.studentId$)),a(2),C(d(5,8,i.myGradesService.gradingScales$)),a(4),g(d(9,11,"my-grades.title")),a(3),B(d(12,13,i.myGradesService.loading$)?11:13))},dependencies:[Q,K,q,G,$],encapsulation:2})}}return t})();var X=(()=>{class t{constructor(){}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades"]],features:[I([l])],decls:1,vars:0,template:function(e,i){e&1&&p(0,"router-outlet")},dependencies:[T],encapsulation:2})}}return t})();var Ae=[{path:"",component:X,children:[{path:"",component:W}]}];export{Ae as MY_GRADES_ROUTES};
