"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[76],{1037:(b,v,e)=>{e.d(v,{m2:()=>S,XB:()=>h,t1:()=>I});var t=e(5818),n=e(4273);function C(i,s){return+(0,n.a)(i)<+(0,n.a)(s)}function l(i,s){const f=+(0,n.a)(i),[a,m]=[+(0,n.a)(s.start),+(0,n.a)(s.end)].sort((E,D)=>E-D);return f>=a&&f<=m}var o=e(7233);class g{constructor(s,f,a){this.TeacherInformation=s,this.LessonDateTimeFrom=f,this.LessonDateTimeTo=a,this.lessons=[]}addLesson(s){this.lessons.some(f=>(0,o.ib)(f,s))||(this.lessons.push(s),this.updateId(),this.updateStudyClassNumbers(),this.updateEventDesignations())}getIds(){return[...new Set(this.lessons.map(s=>s.LessonRef.Id))]}getEventIds(){return[...new Set(this.lessons.map(s=>s.EventRef.Id))]}updateId(){this.id=[...new Set(this.lessons.map(s=>s.LessonRef.Id).sort())].join("-")}updateStudyClassNumbers(){this.studyClassNumbers=[...new Set(this.lessons.map(s=>s.StudyClassNumber).sort((s,f)=>s.localeCompare(f)))].join(", ")}updateEventDesignations(){this.eventDesignations=[...new Set(this.lessons.map(s=>s.EventDesignation).sort())].join(", ")}}function h(i){return I(i).reduce((s,f)=>{const a=s.find(E=>function r(i,s){return null===i&&null===s||null!==i&&null!==s&&i.TeacherInformation===s.TeacherInformation&&i.LessonDateTimeFrom.getTime()===s.LessonDateTimeFrom.getTime()&&i.LessonDateTimeTo.getTime()===s.LessonDateTimeTo.getTime()}(E,f));if(a)return a.addLesson(f),s;const m=function c(i){const s=new g(i.TeacherInformation,i.LessonDateTimeFrom,i.LessonDateTimeTo);return s.addLesson(i),s}(f);return[...s,m]},[]).sort(o.qZ)}function S(i){if(0===i.length)return null;const s=new Date;if(i=[...i].sort(o.qZ),(0,t.r)(s,i[0].LessonDateTimeFrom)){for(const f of i)if(C(s,f.LessonDateTimeFrom)||l(s,{start:f.LessonDateTimeFrom,end:f.LessonDateTimeTo}))return f;return i[i.length-1]}return i[0]}function I(i){return i.reduce((s,f)=>s.some(a=>(0,o.ib)(a,f))?s:[...s,f],[])}},181:(b,v,e)=>{e.d(v,{m:()=>p});var t=e(4438),n=e(9417),C=e(1324),u=e(3955),l=e(1195);let p=(()=>{class o{constructor(){this.value=null,this.placeholder="shared.date-select.default-placeholder",this.minDate=null,this.valueChange=new t.bkB,this.componentId=(0,l.A)("bkd-date-select-")}static#t=this.\u0275fac=function(g){return new(g||o)};static#e=this.\u0275cmp=t.VBU({type:o,selectors:[["bkd-date-select"]],inputs:{value:"value",placeholder:"placeholder",minDate:"minDate"},outputs:{valueChange:"valueChange"},standalone:!0,features:[t.aNF],decls:8,vars:10,consts:[["dp","ngbDatepicker"],[1,"input-group"],[1,"input-group-text",3,"id"],[1,"material-icons"],["type","text","ngbDatepicker","",1,"form-control",3,"click","ngModelChange","minDate","ngModel"]],template:function(g,h){if(1&g){const S=t.RV6();t.j41(0,"div",1)(1,"span",2)(2,"i",3),t.EFF(3,"calendar_today"),t.k0s()(),t.j41(4,"input",4,0),t.nI1(6,"translate"),t.nI1(7,"translate"),t.bIt("click",function(){t.eBV(S);const i=t.sdS(5);return t.Njj(i.toggle())})("ngModelChange",function(i){return t.eBV(S),t.Njj(h.valueChange.emit(i))}),t.k0s()()}2&g&&(t.R7$(),t.Y8G("id",h.componentId),t.R7$(3),t.Y8G("minDate",h.minDate)("ngModel",h.value),t.BMQ("placeholder",t.bMT(6,6,h.placeholder))("aria-label",t.bMT(7,8,h.placeholder))("aria-describedby",h.componentId))},dependencies:[C.cw,n.YN,n.me,n.BC,n.vS,u.h,u.D9]})}return o})()},2239:(b,v,e)=>{e.d(v,{B:()=>u});var t=e(177),n=e(4438);function C(l,p){if(1&l){const o=n.RV6();n.j41(0,"button",5),n.bIt("click",function(){n.eBV(o);const c=n.XpG();return n.Njj(c.valueChange.emit(""))}),n.j41(1,"i",2),n.EFF(2,"clear"),n.k0s()()}}let u=(()=>{class l{constructor(){this.value="",this.disabled=!1,this.valueChange=new n.bkB}static#t=this.\u0275fac=function(r){return new(r||l)};static#e=this.\u0275cmp=n.VBU({type:l,selectors:[["bkd-resettable-input"]],inputs:{value:"value",disabled:"disabled",placeholder:"placeholder",label:"label"},outputs:{valueChange:"valueChange"},standalone:!0,features:[n.aNF],decls:6,vars:7,consts:[[1,"input-group"],["id","resettable-input",1,"input-group-text"],[1,"material-icons"],["type","text","aria-describedby","resettable-input",1,"form-control",3,"keyup","value","disabled"],["class","clear btn btn-link text-decoration-none","type","button",3,"click",4,"ngIf"],["type","button",1,"clear","btn","btn-link","text-decoration-none",3,"click"]],template:function(r,c){1&r&&(n.j41(0,"div",0)(1,"span",1)(2,"i",2),n.EFF(3,"search"),n.k0s()(),n.j41(4,"input",3),n.bIt("keyup",function(h){return c.valueChange.emit(null==h.target?null:h.target.value)}),n.k0s(),n.DNE(5,C,3,0,"button",4),n.k0s()),2&r&&(n.R7$(4),n.AVh("has-value",c.value),n.Y8G("value",c.value)("disabled",c.disabled),n.BMQ("placeholder",c.placeholder)("aria-label",c.label),n.R7$(),n.Y8G("ngIf",c.value))},dependencies:[t.bT],styles:["input.has-value[_ngcontent-%COMP%]{padding-right:2.5em}.btn.clear[_ngcontent-%COMP%]{position:absolute;right:0;z-index:5;padding-left:.5rem;padding-right:.5rem}"]})}return l})()},6914:(b,v,e)=>{e.d(v,{RJ:()=>f,I4:()=>g,aZ:()=>h,$1:()=>s,H_:()=>S,u8:()=>I,tl:()=>c});var t=e(5783);var u=e(3813);function l(a,m,E){return void 0===E&&(E="withFallback("+a.name+")"),function C(a,m,E){void 0===E&&(E=a.name);var D=function n(a){var m=Object.create(Object.getPrototypeOf(a));return Object.assign(m,a),m}(a);return D.validate=m,D.decode=function(O){return m(O,t.TY(D))},D.name=E,D}(a,function(D,O){return(0,u.NW)(function(){return t.kX(m)})(a.validate(D,O))},E)}var p=e(5306),o=e(5666);const r=t.NW({Key:t.Yj,Value:t.Yj}),c=t.NW({Id:t.Yj,Settings:t.tB(t.YO(r))}),g=p.js.pipe(t.NW({mail:l(t.zM,!1),gui:l(t.zM,!1),phoneMobile:l(t.zM,!1)})),h=new t.ZU("NotificationTypesInactive",a=>Array.isArray(a)&&a.every(m=>"string"==typeof m),(a,m)=>"string"==typeof a?t.kX(a.split(";").filter(Boolean)):t.V2(a,m),a=>a.join(";"));var S=function(a){return a.Grid="grid",a.List="list",a}(S||{});const I=p.js.pipe(t.NW({presenceControl:t.ZE({grid:null,list:null})})),i=t.NW({eventId:(0,p.c$)(t.ai),group:(0,p.c$)(o.H.props.Key)}),s=p.js.pipe(t.tB(t.YO(i))),f=t.NW({AccessInfo:t.NW({Roles:t.YO(t.Yj),Permissions:t.YO(t.Yj)})})},5400:(b,v,e)=>{e.d(v,{z:()=>g});var t=e(1626),n=e(5558),C=e(2809),u=e(5783);const l=u.NW({Id:u.ai,Designation:u.Yj,StudentCount:u.ai});var p=e(1015),o=e(785),r=e(6952),c=e(4438);let g=(()=>{class h extends r.G{constructor(I,i){super(I,i,l,"Events")}getStudyCourseEvents(){const I=(new t.Nl).set("filter.EventTypeId=","1");return this.getList({params:I})}getSubscriptionDetailsDefinitions(I){return this.http.get(`${this.baseUrl}/${I}/SubscriptionDetails`).pipe((0,n.n)((0,o.k$)(p.t)))}static#t=this.\u0275fac=function(i){return new(i||h)(c.KVO(t.Qq),c.KVO(C.yy))};static#e=this.\u0275prov=c.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},3515:(b,v,e)=>{e.d(v,{A:()=>O});var t=e(1413),n=e(9172),C=e(152),u=e(5558),l=e(6354),p=e(4668),o=e(8141),r=e(6914),c=e(785),g=e(172),h=e(4438),S=e(2809),I=e(6952),i=e(1626);let s=(()=>{class y extends I.G{constructor(d,T){super(d,T,r.tl,"UserSettings")}getUserSettingsCst(d){return this.http.get(`${this.baseUrl}/Cst`,{params:d}).pipe((0,u.n)((0,c.D4)(this.codec)))}updateUserSettingsCst(d){return this.http.patch(`${this.baseUrl}/Cst`,d)}getAccessInfo(){return this.http.get(`${this.baseUrl}/?expand=AccessInfo`).pipe((0,u.n)((0,c.D4)(r.RJ)),(0,l.T)(({AccessInfo:d})=>d))}static#t=this.\u0275fac=function(T){return new(T||y)(h.KVO(i.Qq),h.KVO(S.yy))};static#e=this.\u0275prov=h.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})();const a="presenceControlViewMode",m="presenceControlGroupView",E="notification",D="notificationTypesInactive";let O=(()=>{class y{constructor(d){this.settingsRestService=d,this.refetch$=new t.B,this.settings$=this.refetch$.pipe((0,n.Z)(null),(0,C.B)(100),(0,u.n)(()=>this.settingsRestService.getUserSettingsCst()),(0,l.T)(T=>T.Settings),(0,p.t)(1)),this.accessInfo$=this.settingsRestService.getAccessInfo().pipe((0,p.t)(1))}refetch(){this.refetch$.next()}getSetting(d){return this.settings$.pipe((0,l.T)(T=>T.find(N=>N.Key===d)?.Value??null))}saveSetting(d,T){return this.settingsRestService.updateUserSettingsCst(this.buildSettings(d,T)).pipe((0,o.M)(()=>this.refetch$.next()))}getPresenceControlViewMode(){return this.getSetting(a).pipe((0,g.Jh)('{"presenceControl":"grid"}'),(0,u.n)((0,c.D4)(r.u8)),(0,l.T)(({presenceControl:d})=>d))}savePresenceControlViewMode(d){return this.saveSetting(a,r.u8.encode({presenceControl:d}))}getPresenceControlGroupView(){return this.getSetting(m).pipe((0,g.Jh)("[]"),(0,u.n)((0,c.D4)(r.$1)))}savePresenceControlGroupView(d){return this.saveSetting(m,r.$1.encode(d))}getNotificationChannels(){return this.getSetting(E).pipe((0,g.Jh)("{}"),(0,u.n)((0,c.D4)(r.I4)))}saveNotificationChannels(d){return this.saveSetting(E,r.I4.encode(d))}getNotificationTypesInactive(){return this.getSetting(D).pipe((0,g.Jh)(""),(0,u.n)((0,c.D4)(r.aZ)))}saveNotificationTypesInactive(d){return this.saveSetting(D,r.aZ.encode(d))}getRolesAndPermissions(){return this.accessInfo$.pipe((0,l.T)(({Roles:d,Permissions:T})=>[...d,...T]),(0,n.Z)(null))}buildSettings(d,T){return{Id:"Cst",Settings:[{Key:d,Value:T}]}}static#t=this.\u0275fac=function(T){return new(T||y)(h.KVO(s))};static#e=this.\u0275prov=h.jDH({token:y,factory:y.\u0275fac,providedIn:"root"})}return y})()},2930:(b,v,e)=>{e.d(v,{F:()=>n,r:()=>C});var t=e(5314);function n(u,l,p){return u.map(o=>{let c,r=null;return o.TypeRef.Id&&(r=l.find(g=>g.Id===o.TypeRef.Id)||null),o.ConfirmationStateId&&(c=p.find(g=>g.Key===o.ConfirmationStateId)),new t.Jt(o,r,null,c)})}function C(u,l,p){return u?l.filter(o=>p.find(r=>r===o.lessonPresence.StudentRef.Id)):l}},8358:(b,v,e)=>{e.d(v,{x:()=>n});var t=e(8116);function n(p,o){return o?p.filter(function C(p){const o=l(p);return r=>u(r.studentFullName,o)||u(r.studyClassNumber,o)||u(r.designation,o)||u(r.evaluationText,o)}(o)):p}function u(p,o){return!!p&&l(p).includes(o)}function l(p){return(0,t.A)(p.toLowerCase())}}}]);