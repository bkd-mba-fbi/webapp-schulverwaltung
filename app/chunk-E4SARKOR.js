import{f as ue,g as he}from"./chunk-RDNZARDR.js";import{a as le}from"./chunk-C4EQUSNO.js";import{e as fe}from"./chunk-6LRQCBUO.js";import{j as Z,k as G}from"./chunk-RXV77OBQ.js";import{a as pe}from"./chunk-USF5QQBL.js";import{b as V}from"./chunk-KZWEGXU2.js";import{d as ce}from"./chunk-KFP6476W.js";import{a as z,b as q}from"./chunk-QWYAXZZX.js";import{b as me}from"./chunk-GH7I4V3C.js";import{A as T,e as H,i as w,u as se}from"./chunk-RYYQAFJB.js";import{$d as x,Ac as oe,Bc as B,Cc as C,Ec as S,Hb as s,Ja as W,Jb as d,Lc as f,Mc as E,Md as u,Nc as N,Nd as U,Ob as te,Rb as ie,Sb as m,Sc as J,Sd as j,Tb as c,Ub as l,Wc as R,_ as X,ac as v,ae as k,cb as g,dc as p,fb as o,ha as I,je as de,ma as h,o as F,pc as ne,rc as r,rd as re,sc as y,t as L,tc as _,u as O,ub as A,uc as P,ud as ae,xb as ee}from"./chunk-CHBP6U4G.js";function Le(t,a){if(t&1&&(r(0),l(1,"br")),t&2){let e=p();_(" ",e.student().AddressLine2)}}function Ie(t,a){if(t&1&&(m(0,"a",0),r(1),c(),l(2,"br")),t&2){let e=p();v("href",S("tel:",e.student().PhonePrivate),g),o(),_(" ",e.student().PhonePrivate," ")}}function Te(t,a){if(t&1&&(m(0,"a",0),r(1),c(),l(2,"br")),t&2){let e=p();v("href",S("tel:",e.student().PhoneMobile),g),o(),_(" ",e.student().PhoneMobile," ")}}function Me(t,a){if(t&1&&(m(0,"a",0),r(1),c()),t&2){let e=p();v("href",S("mailto:",e.email()),g),o(),_(" ",e.email()," ")}}var ot=(()=>{class t{constructor(){this.student=R.required(),this.emailProperty=R("DisplayEmail"),this.postalCode=J(()=>{let e=this.student();return"PostalCode"in e?e.PostalCode:e.Zip}),this.email=J(()=>{let e=this.student();return this.emailProperty()==="Email2"&&"Email2"in e?e.Email2||null:e.DisplayEmail})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-address"]],inputs:{student:[1,"student"],emailProperty:[1,"emailProperty"]},decls:9,vars:7,consts:[[3,"href"]],template:function(i,n){i&1&&(m(0,"address"),r(1),l(2,"br"),s(3,Le,2,1),r(4),l(5,"br"),s(6,Ie,3,3),s(7,Te,3,3),s(8,Me,2,3,"a",0),c()),i&2&&(o(),_(" ",n.student().AddressLine1),o(2),d(n.student().AddressLine2?3:-1),o(),P(" ",n.postalCode()||""," ",n.student().Location),o(2),d(n.student().PhonePrivate?6:-1),o(),d(n.student().PhoneMobile?7:-1),o(),d(n.email()?8:-1))},styles:["address[_ngcontent-%COMP%]{padding-left:1rem}"],changeDetection:0})}}return t})();var Y=(()=>{class t{transform(e){return e?.DisplayEmail||e?.Email||e?.Email2||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=ee({name:"bkdPersonEmail",type:t,pure:!0})}}return t})();function Ne(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);_(" ",e.CompanyName)}}function Re(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);_(" ",e.CompanyNameAddition)}}function ke(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);P(" ",e.Lastname||""," ",e.Firstname||"")}}function Fe(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);_(" ",e.AddressLine1)}}function Oe(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);_(" ",e.AddressLine2)}}function Be(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(0);P(" ",e.PostalCode," ",e.Location)}}function we(t,a){if(t&1&&(m(0,"a",1),r(1),l(2,"br"),c()),t&2){p(2);let e=C(0);v("href",S("tel:",e.PhoneBusiness),g),o(),y(e.PhoneBusiness)}}function Ue(t,a){if(t&1&&(m(0,"a",1),f(1,"bkdPersonEmail"),r(2),f(3,"bkdPersonEmail"),c()),t&2){p(2);let e=C(0);v("href",S("mailto:",E(1,3,e)),g),o(2),y(E(3,5,e))}}function je(t,a){if(t&1&&(m(0,"address"),s(1,Ne,2,1),s(2,Re,2,1),s(3,ke,2,2),s(4,Fe,2,1),s(5,Oe,2,1),s(6,Be,2,2),s(7,we,3,3,"a",1),s(8,Ue,4,7,"a",1),f(9,"bkdPersonEmail"),c()),t&2){p();let e=C(0);o(),d(e.CompanyName?1:-1),o(),d(e.CompanyNameAddition?2:-1),o(),d(e.Lastname||e.Firstname?3:-1),o(),d(e.AddressLine1?4:-1),o(),d(e.AddressLine2?5:-1),o(),d(e.PostalCode&&e.Location?6:-1),o(),d(e.PhoneBusiness?7:-1),o(),d(E(9,8,e)?8:-1)}}function ze(t,a){if(t&1&&(m(0,"div",0),r(1),f(2,"translate"),f(3,"addSpace"),l(4,"br"),r(5),f(6,"date"),f(7,"date"),c()),t&2){p();let e=C(1);o(),P(" ",E(2,4,"shared.profile.apprenticeship-period"),"",N(3,6,":",":")),o(4),P(" ",N(6,9,e.ContractDateFrom,"dd.MM.yyyy"),"\u2013",N(7,12,e.ContractDateTo,"dd.MM.yyyy")," ")}}function Ge(t,a){if(t&1&&(r(0),l(1,"br")),t&2){p(2);let e=C(2);P(" ",e.Lastname||""," ",e.Firstname||"")}}function Ye(t,a){if(t&1&&(m(0,"a",1),r(1),l(2,"br"),c()),t&2){p(2);let e=C(2);v("href",S("tel:",e.PhoneBusiness),g),o(),y(e.PhoneBusiness)}}function $e(t,a){if(t&1&&(m(0,"a",1),r(1),l(2,"br"),c()),t&2){p(2);let e=C(2);v("href",S("tel:",e.PhoneMobile),g),o(),y(e.PhoneMobile)}}function Xe(t,a){if(t&1&&(m(0,"a",1),f(1,"bkdPersonEmail"),r(2),f(3,"bkdPersonEmail"),c()),t&2){p(2);let e=C(2);v("href",S("mailto:",E(1,3,e)),g),o(2),y(E(3,5,e))}}function Je(t,a){if(t&1&&(m(0,"div",0),r(1),f(2,"translate"),f(3,"addSpace"),m(4,"address"),s(5,Ge,2,2),s(6,Ye,3,3,"a",1),s(7,$e,3,3,"a",1),s(8,Xe,4,7,"a",1),f(9,"bkdPersonEmail"),c()()),t&2){p();let e=C(2);o(),P(" ",E(2,6,"shared.profile.job-trainer"),"",N(3,8,":",":")," "),o(4),d(e.Lastname||e.Firstname?5:-1),o(),d(e.PhoneBusiness?6:-1),o(),d(e.PhoneMobile?7:-1),o(),d(E(9,11,e)?8:-1)}}var ft=(()=>{class t{constructor(){this.apprenticeship=R.required()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-apprenticeship"]],inputs:{apprenticeship:[1,"apprenticeship"]},decls:6,vars:6,consts:[[1,"subentry"],[3,"href"]],template:function(i,n){if(i&1&&(oe(0)(1)(2),s(3,je,10,10,"address"),s(4,ze,8,15,"div",0),s(5,Je,10,13,"div",0)),i&2){let b=B(n.apprenticeship().apprenticeshipManager);o();let M=B(n.apprenticeship().apprenticeshipContract);o();let $=B(n.apprenticeship().jobTrainer);o(),d(b?3:-1),o(),d(M.ContractDateFrom?4:-1),o(),d($?5:-1)}},dependencies:[ae,de,he,Y],styles:[".subentry[_ngcontent-%COMP%]{padding-bottom:1rem}"],changeDetection:0})}}return t})();function He(t,a){if(t&1&&(r(0),l(1,"br")),t&2){let e=p();_(" ",e.person.AddressLine1)}}function Ze(t,a){if(t&1&&(r(0),l(1,"br")),t&2){let e=p();_(" ",e.person.AddressLine2)}}function qe(t,a){if(t&1&&(r(0),l(1,"br")),t&2){let e=p();P(" ",e.person.Zip," ",e.person.Location)}}function Ve(t,a){if(t&1&&(m(0,"a",0),r(1),l(2,"br"),c()),t&2){let e=p();v("href",S("tel:",e.person.PhonePrivate),g),o(),y(e.person.PhonePrivate)}}function Ke(t,a){if(t&1&&(m(0,"a",0),r(1),l(2,"br"),c()),t&2){let e=p();v("href",S("tel:",e.person.PhoneMobile),g),o(),y(e.person.PhoneMobile)}}function Qe(t,a){if(t&1&&(m(0,"a",0),f(1,"bkdPersonEmail"),r(2),f(3,"bkdPersonEmail"),c()),t&2){let e=p();v("href",S("mailto:",E(1,3,e.person)),g),o(2),y(E(3,5,e.person))}}var xt=(()=>{class t{constructor(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-legal-representative"]],inputs:{person:"person"},decls:10,vars:10,consts:[[3,"href"]],template:function(i,n){i&1&&(m(0,"address"),r(1),l(2,"br"),s(3,He,2,1),s(4,Ze,2,1),s(5,qe,2,2),s(6,Ve,3,3,"a",0),s(7,Ke,3,3,"a",0),s(8,Qe,4,7,"a",0),f(9,"bkdPersonEmail"),c()),i&2&&(o(),P(" ",n.person.LastName," ",n.person.FirstName),o(2),d(n.person.AddressLine1?3:-1),o(),d(n.person.AddressLine2?4:-1),o(),d(n.person.Zip&&n.person.Zip?5:-1),o(),d(n.person.PhonePrivate?6:-1),o(),d(n.person.PhoneMobile?7:-1),o(),d(E(9,8,n.person)?8:-1))},dependencies:[Y],encapsulation:2,changeDetection:0})}}return t})();var Ce=j({Email:x(u),Email2:x(u),PhoneBusiness:x(u),CompanyName:k(u),CompanyNameAddition:k(u),Firstname:x(u),Lastname:x(u),AddressLine1:k(u),AddressLine2:k(u),PostalCode:x(u),Location:x(u),Id:U});var xe=(()=>{class t extends z{constructor(){let e=h(w),i=h(T);super(e,i,Ce,"ApprenticeshipManagers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var ge=j({Email:x(u),Email2:x(u),PhoneBusiness:x(u),PhoneMobile:x(u),Firstname:x(u),Lastname:x(u),Id:U});var ve=(()=>{class t extends z{constructor(){let e=h(w),i=h(T);super(e,i,ge,"JobTrainers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function K(t,a){let e=+Z(t)-+Z(a);return e<0?-1:e>0?1:e}function _e(t,a,e){let[i,n]=G(e?.in,t,a);return i.getFullYear()-n.getFullYear()}function Se(t,a,e){let[i,n]=G(e?.in,t,a),b=K(i,n),M=Math.abs(_e(i,n));i.setFullYear(1584),n.setFullYear(1584);let $=K(i,n)===-b,Q=b*(M-+$);return Q===0?0:Q}var et=18;function Ee(t){return Se(new Date,t.Birthdate||new Date)>=et}var Pe="dossier-myself",be="dossier-student",ye="dossier-legal-reps",Ae="dossier-apprenticeships",De="dossier-stay-permit",di=(()=>{class t{constructor(){this.studentService=h(ue),this.personsService=h(ce),this.apprenticeshipManagersService=h(xe),this.jobTrainersService=h(ve),this.dropDownItemsService=h(le),this.loadingService=h(fe),this.IGNORE_404_CONTEXT=new H().set(V,{disableErrorHandlingForStatus:[404]}),this.loadingStudent$=this.loadingService.loading(be),this.loadingMyself$=this.loadingService.loading(Pe),this.loadingLegalRepresentatives$=this.loadingService.loading(ye),this.loadingApprenticeships$=this.loadingService.loading(Ae),this.loadingStayPermit$=this.loadingService.loading(De)}getStudent(e){return this.loadingService.load(this.personsService.get(e,{context:this.IGNORE_404_CONTEXT}).pipe(L(i=>this.createStudentFromPerson(i)),q()),be)}createStudentFromPerson(e){return{Id:e.Id,AddressLine1:e.AddressLine1,AddressLine2:e.AddressLine2,Birthdate:e.Birthdate,DisplayEmail:e.DisplayEmail,FirstName:e.FirstName??"",FullName:e.FullName??"",Gender:e.Gender??"X",LastName:e.LastName??"",Location:e.Location,PhoneMobile:e.PhoneMobile,PhonePrivate:e.PhonePrivate,PostalCode:e.Zip}}getMyself(){return this.loadingService.load(this.personsService.getMyself({context:new H().set(V,{disableErrorHandlingForStatus:[403]})}),Pe)}getLegalRepresentatives(e){return this.loadingService.load(this.loadLegalRepresentatives(e).pipe(X(i=>this.loadLegalRepresentativePersons(i).pipe(L(n=>i.map(b=>this.findPerson(b.RepresentativeId,n)).filter(me))))),ye)}getApprenticeships(e){return this.loadingService.load(this.loadApprenticeshipContracts(e).pipe(X(i=>O([this.loadApprenticeshipManagers(i),this.loadJobTrainers(i)]).pipe(L(([n,b])=>i.map(M=>this.createApprenticeshipCompany(M,n,b)))))),Ae)}getStayPermitValue(e){return this.loadingService.load(this.dropDownItemsService.getStayPermits().pipe(L(i=>i.find(n=>n.Key===e)?.Value||null)),De)}loadLegalRepresentatives(e){return this.studentService.getLegalRepresentatives(e.Id).pipe(L(i=>{let n=Ee(e);return i.filter(b=>!n||b.RepresentativeAfterMajority)}))}loadLegalRepresentativePersons(e){return e.length===0?F([]):this.personsService.getListForIds(e.map(i=>i.RepresentativeId))}loadApprenticeshipContracts(e){return this.studentService.getCurrentApprenticeshipContracts(e,{context:this.IGNORE_404_CONTEXT}).pipe(q([]))}loadJobTrainers(e){let i=e.map(n=>n.JobTrainer).filter(n=>typeof n=="number");return i.length===0?F([]):O(i.map(n=>this.jobTrainersService.get(n)))}loadApprenticeshipManagers(e){let i=e.map(n=>n.ApprenticeshipManagerId);return i.length===0?F([]):O(i.map(n=>this.apprenticeshipManagersService.get(n)))}createApprenticeshipCompany(e,i,n){return{apprenticeshipContract:e,jobTrainer:this.findPerson(e.JobTrainer,n),apprenticeshipManager:this.findPerson(e.ApprenticeshipManagerId,i)}}findPerson(e,i){return e&&i.find(n=>n.Id===e)||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=I({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var xi=(()=>{class t{constructor(){this.settings=h(T),this.storageService=h(pe),this.avatarStyles={}}ngOnChanges(e){e.studentId&&(this.avatarStyles=this.buildAvatarStyles(this.studentId))}buildAvatarStyles(e){return{"background-image":[this.buildAvatarUrl(e),this.fallbackAvatarUrl].map(i=>`url(${i})`).join(", ")}}buildAvatarUrl(e){let i=this.storageService.getAccessToken()||"";return`${this.settings.apiUrl}/Files/personPictures/${e}?token=${i}`}get fallbackAvatarUrl(){return`${this.settings.scriptsAndAssetsPath}/assets/images/avatar-placeholder.png`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=A({type:t,selectors:[["bkd-avatar"]],inputs:{studentId:"studentId",link:"link",linkParams:"linkParams"},features:[W],decls:1,vars:5,consts:[[1,"avatar",3,"routerLink","queryParams","ngStyle"]],template:function(i,n){i&1&&ie(0,"a",0),i&2&&(ne("disabled",!n.link),te("routerLink",n.link)("queryParams",n.linkParams)("ngStyle",n.avatarStyles))},dependencies:[se,re],styles:["[_nghost-%COMP%]{display:flex}.small[_nghost-%COMP%]{width:40px;min-width:40px;height:50px}.medium[_nghost-%COMP%]{width:58px;min-width:58px;height:75px}.large[_nghost-%COMP%]{width:100px;min-width:100px;height:130px}.avatar[_ngcontent-%COMP%]{flex:1;border:1px solid rgba(0,0,0,.25);background-repeat:no-repeat;background-size:cover;background-position:center}a.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:default}"]})}}return t})();export{di as a,ot as b,ft as c,xt as d,xi as e};
