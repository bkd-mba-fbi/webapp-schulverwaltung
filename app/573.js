"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[573],{8573:(K,E,r)=>{r.r(E),r.d(E,{EventsModule:()=>Ue});var U=r(9121),p=r(5357),k=r(634),T=r(1135),O=r(9841),m=r(4004),$=r(8029),I=r(6478),y=r(5255),t=r(5e3),_=r(3900),x=r(9718),c=r(9928),f=r(5030),V=r(8210);const tt=c.dt({TestId:c.pk,GradeId:c.pk,GradeValue:(0,f.Wx)(c.pk),GradeDesignation:c.Z_,Points:(0,f.Wx)(c.pk),StudentId:c.pk,Id:c.Z_}),et=c.dt({Id:c.pk,CourseId:c.pk,Date:f.L9,Designation:c.Z_,Weight:c.pk,WeightPercent:c.pk,IsPointGrading:c.O7,MaxPoints:(0,f.Wx)(c.pk),MaxPointsAdjusted:(0,f.Wx)(c.pk),IsPublished:c.O7,IsOwner:c.O7,Owner:(0,f.Wx)(c.Z_),Creation:c.Z_,GradingScaleId:c.pk,GradingScale:c.Z_,Results:(0,f.Wx)(c.IX(tt))});var nt=r(803);const z=c.dt({Id:c.pk}),N=c.r$({HRef:(0,f.Wx)(c.Z_)}),st=c.r$({HasEvaluationStarted:c.O7,EvaluationUntil:(0,f.Wx)(f.L9),HasReviewOfEvaluationStarted:c.O7,HasTestGrading:c.O7,Id:c.pk}),ot=c.jV([z,N,st]),it=c.r$({Id:c.pk,StudentCount:c.pk}),rt=c.jV([z,N,it]),F=c.dt({HRef:c.Z_,Id:c.pk,Number:c.Z_,Designation:c.Z_,DateFrom:(0,f.Wx)(f.L9),DateTo:(0,f.Wx)(f.L9),Tests:(0,f.Wx)(c.IX(et)),EvaluationStatusRef:ot,AttendanceRef:rt,ParticipatingStudents:(0,f.Wx)(c.IX(nt.Z)),Classes:(0,f.Wx)(c.IX(V.y))});var Q=r(2786),at=r(2671),ct=r(520);let M=(()=>{class n extends at.v{constructor(e,s){super(e,s,F,"Courses")}getExpandedCourses(){return this.http.get(`${this.baseUrl}/?expand=EvaluationStatusRef,AttendanceRef,Classes&filter.StatusId=;${this.settings.eventlist.statusfilter}`,{headers:{"X-Role-Restriction":"TeacherRole"}}).pipe((0,_.w)((0,Q.Y0)(F)))}getExpandedCourse(e){return this.http.get(`${this.baseUrl}/${e}?expand=ParticipatingStudents,EvaluationStatusRef,Tests,Gradings,FinalGrades`).pipe((0,_.w)((0,Q.Jx)(F)))}add(e,s,i,a,d,u,g){return this.http.put(`${this.baseUrl}/${e}/Tests/New`,{Tests:[{Date:s,Designation:i,Weight:a,IsPointGrading:d,MaxPoints:u,MaxPointsAdjusted:g}]}).pipe((0,x.h)(void 0))}update(e,s,i,a,d,u,g,v){return this.http.put(`${this.baseUrl}/${e}/Tests/Update`,{Tests:[{Id:s,Designation:i,Date:a,Weight:d,IsPointGrading:u,MaxPoints:g,MaxPointsAdjusted:v}]}).pipe((0,x.h)(void 0))}delete(e,s){return this.http.put(`${this.baseUrl}/${e}/Tests/Delete`,{TestIds:[s]}).pipe((0,x.h)(void 0))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(ct.eN),t.LFG($.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var dt=r(7283),j=r(2024),lt=r(1303),Z=r(8995),A=(()=>{return(n=A||(A={})).Rating="rating",n.RatingUntil="rating-until",n.IntermediateRating="intermediate-rating",n.Tests="add-tests",A;var n})();let Y=(()=>{class n{constructor(e,s,i,a,d,u){this.coursesRestService=e,this.studyClassRestService=s,this.loadingService=i,this.storage=a,this.translate=d,this.settings=u,this.loading$=this.loadingService.loading$,this.search$=new T.X(""),this.courses$=this.coursesRestService.getExpandedCourses(),this.formativeAssessments$=this.studyClassRestService.getActiveFormativeAssessments(),this.studyClasses$=this.studyClassRestService.getActive(),this.events$=this.loadEvents(),this.filteredEvents$=(0,O.a)([this.events$,this.search$]).pipe((0,m.U)((0,I.h)(y.P)))}loadEvents(){return this.loadingService.load(this.hasClassTeacherRole()?(0,O.a)([this.courses$,this.formativeAssessments$,this.studyClasses$]).pipe((0,m.U)((0,I.h)(this.createAndSortEvents.bind(this)))):this.courses$.pipe((0,m.U)(e=>this.createAndSortEvents(e))))}createAndSortEvents(e,s=[],i=[]){const a=i.filter(d=>!s.map(u=>u.Id).includes(d.Id));return[...this.createFromCourses(e),...this.createFromAssessments(s),...this.createFromStudyClasses(a)].sort((d,u)=>d.Designation.localeCompare(u.Designation))}createFromStudyClasses(e){return e.map(s=>({id:s.Id,Designation:s.Number,detailLink:this.buildLink(s.Id,"eventdetail"),studentCount:s.StudentCount,state:null}))}createFromAssessments(e){return this.createFromStudyClasses(e).map(i=>Object.assign(Object.assign({},i),{state:A.Rating,evaluationText:this.translate.instant("events.state.rating"),evaluationLink:this.buildLink(i.id,"evaluation")}))}createFromCourses(e){return e.map(s=>{const i=this.getState(s);return{id:s.Id,Designation:this.getDesignation(s),detailLink:this.buildLink(s.Id,"eventdetail"),studentCount:s.AttendanceRef.StudentCount||0,dateFrom:s.DateFrom,dateTo:s.DateTo,state:i,evaluationText:this.getEvaluationText(i,s.EvaluationStatusRef.EvaluationUntil),evaluationLink:this.getEvaluationLink(s,i)}})}getDesignation(e){const s=e.Classes?e.Classes.map(i=>i.Number).join(", "):null;return s?e.Designation+", "+s:e.Designation}getState(e){const s=e.EvaluationStatusRef;if(!0===s.HasTestGrading)return A.Tests;if(!0===s.HasEvaluationStarted){if(null==s.EvaluationUntil)return A.IntermediateRating;if(s.EvaluationUntil>=new Date)return A.RatingUntil}return null}getEvaluationText(e,s){return null===e?"":this.translate.instant(`events.state.${e}`)+(e===A.RatingUntil?` ${s?(0,k.Z)(s,"dd.MM.yyyy"):""}`:"")}getEvaluationLink(e,s){return null===s||s===A.Tests?null:this.buildLink(e.Id,"evaluation")}buildLink(e,s){return`${this.settings.eventlist[s]}=${e}`}hasClassTeacherRole(){const e=this.storage.getPayload();return!!e&&e.roles.indexOf("ClassTeacherRole")>=0}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(M),t.LFG(dt.R),t.LFG(j.b),t.LFG(lt.V),t.LFG(Z.sK),t.LFG($.L))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),ut=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events"]],features:[t._Bn([Y])],decls:1,vars:0,template:function(e,s){1&e&&t._UZ(0,"router-outlet")},directives:[p.lC],styles:[""]}),n})(),S=(()=>{class n{constructor(e,s){this.coursesRestService=e,this.loadingService=s,this.loading$=this.loadingService.loading$,this.search$=new T.X("")}getCourse(e){return this.loadingService.load(this.coursesRestService.getExpandedCourse(e))}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(M),t.LFG(j.b))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac}),n})(),gt=(()=>{class n{constructor(e){this.state=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests"]],features:[t._Bn([S])],decls:1,vars:0,template:function(e,s){1&e&&t._UZ(0,"router-outlet")},directives:[p.lC],styles:[""]}),n})();var R=r(7579),pt=r(4782),mt=r(6451),b=r(1884),L=r(1104),l=r(9808),_t=r(6401);const ft=function(n){return{count:n}};function vt(n,o){if(1&n&&(t.TgZ(0,"div",9),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,1===e.course.ParticipatingStudents.length?"courses.registration":"courses.registrations",t.VKq(4,ft,e.course.ParticipatingStudents.length))," ")}}const ht=function(){return["/events"]};let xt=(()=>{class n{constructor(e){this.reportsService=e}loadReportUrl(){return this.reportsService.getEventReportUrl(this.course.Id)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(_t.F))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-header"]],inputs:{course:"course"},decls:16,vars:5,consts:[[1,"d-flex","align-items-center","justify-content-between","header"],["type","button",1,"back","btn","btn-link","py-0","px-0",3,"routerLink"],[1,"d-flex"],[1,"material-icons","btn"],[1,"text-justify"],["class","font-color-light-gray",4,"ngIf"],["routerLink","add",1,"edit","btn","btn-primary","ml-2"],[1,"material-icons"],[1,"edit","btn","btn-primary","ml-2",3,"href"],[1,"font-color-light-gray"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"button",1),t.TgZ(2,"div",2),t.TgZ(3,"i",3),t._uU(4,"navigate_before"),t.qZA(),t.TgZ(5,"div",4),t.TgZ(6,"div"),t._uU(7),t.qZA(),t.YNc(8,vt,3,6,"div",5),t.qZA(),t.qZA(),t.qZA(),t.TgZ(9,"div",2),t.TgZ(10,"a",6),t.TgZ(11,"i",7),t._uU(12,"add"),t.qZA(),t.qZA(),t.TgZ(13,"a",8),t.TgZ(14,"i",7),t._uU(15,"description"),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("routerLink",t.DdM(4,ht)),t.xp6(6),t.Oqu(s.course.Designation),t.xp6(1),t.Q6J("ngIf",s.course.ParticipatingStudents),t.xp6(5),t.Q6J("href",s.loadReportUrl(),t.LSH))},directives:[p.rH,l.O5,p.yS],pipes:[Z.X$],styles:[".back[_ngcontent-%COMP%]{color:#33333d;text-decoration:none}.font-color-light-gray[_ngcontent-%COMP%]{color:#adb5bd}.header[_ngcontent-%COMP%]{padding-bottom:1.5rem;border-bottom:1px solid #e9ecef}@media (max-width: 750px){.header[_ngcontent-%COMP%]{padding-right:1.5rem}}"]}),n})();var Zt=r(9092);function Ct(n,o){return o.map(e=>{var s,i;if(void 0===e.Results||0===(null===(s=e.Results)||void 0===s?void 0:s.length))return{kind:"no-result",TestId:e.Id};const a=null===(i=e.Results)||void 0===i?void 0:i.find(d=>d.StudentId===n.Id);return void 0!==a?{kind:"grade",result:a,test:e}:{kind:"no-result",TestId:e.Id}})}function H(n){return"grade"===n.kind}var Ot=r(4379);let Lt=(()=>{class n{constructor(e){this.sortService=e,this.filter$=new T.X("all-tests"),this.expandedHeader$=new T.X(!1),this.tests$=this.filter$.pipe((0,m.U)(s=>{var i;return null===(i=this.course.Tests)||void 0===i?void 0:i.filter(a=>"all-tests"===s||a.IsOwner)})),this.sorting$=this.sortService.sorting$,this.studentGrades$=(0,O.a)([this.tests$,this.sorting$]).pipe((0,m.U)((0,I.h)(this.toStudentGrades.bind(this))))}toStudentGrades(e=[],s){var i;return function At(n,o){return null==n?void 0:n.map(e=>({student:e,grades:Ct(e,o)}))}(null!==(i=this.course.ParticipatingStudents)&&void 0!==i?i:[],e).sort((({key:n,ascending:o})=>(e,s)=>{const i=o?1:-1;return"FullName"===n?i*e.student.FullName.localeCompare(s.student.FullName):i*((n,o,e)=>{var s,i,a,d,u,g;const v=o.grades.filter(H).find(J=>J.test.Id===n.Id),C=e.grades.filter(H).find(J=>J.test.Id===n.Id);return(null!==(a=null===(i=null===(s=null==C?void 0:C.result)||void 0===s?void 0:s.GradeValue)||void 0===i?void 0:i.valueOf())&&void 0!==a?a:0)-(null!==(g=null===(u=null===(d=null==v?void 0:v.result)||void 0===d?void 0:d.GradeValue)||void 0===u?void 0:u.valueOf())&&void 0!==g?g:0)})(n,e,s)})(s))}setSorting(e){this.sortService.setSorting(e)}getSortingChar$(e){return this.sortService.getSortingChar$(e)}sortBy(e){this.sortService.toggleSorting(e)}toggleHeader(e){this.expandedHeader$.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(Ot.K))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),It=(()=>{class n{constructor(e){this.translate=e}transform(e){return`${e.Weight} (${e.WeightPercent}%)${this.getPoints(e)}`}getPoints(e){var s;return e.IsPointGrading?`, ${null!==(s=e.MaxPointsAdjusted)&&void 0!==s?s:e.MaxPoints} ${this.translate.instant("tests.points")}`:""}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Z.sK,16))},n.\u0275pipe=t.Yjl({name:"testSummaryShort",type:n,pure:!0}),n})();function Pt(n,o){1&n&&(t.TgZ(0,"i",13),t._uU(1,"edit"),t.qZA())}const qt=function(n){return["edit",n]};function Et(n,o){if(1&n&&(t.TgZ(0,"div",8),t.TgZ(1,"div",9),t.TgZ(2,"div"),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"a",10),t.YNc(6,Pt,2,0,"i",11),t.qZA(),t.qZA(),t.TgZ(7,"div"),t._uU(8),t.ALo(9,"testSummaryShort"),t.qZA(),t.TgZ(10,"div",12),t._uU(11),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(t.xi3(4,5,e.test.Date,"dd.MM.yyyy")),t.xp6(2),t.Q6J("routerLink",t.VKq(10,qt,e.test.Id)),t.xp6(1),t.Q6J("ngIf",e.test.IsOwner&&!1===e.test.IsPublished),t.xp6(2),t.hij(" ",t.lcZ(9,8,e.test)," "),t.xp6(3),t.Oqu(e.test.Owner)}}function $t(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",14),t.TgZ(1,"a",15),t.ALo(2,"translate"),t.TgZ(3,"i",16),t._uU(4,"lock"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"i",17),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleHeader()}),t._uU(9),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("title",t.lcZ(2,3,"tests.edit")),t.xp6(5),t.Oqu(t.lcZ(7,5,"tests.published")),t.xp6(3),t.Oqu(e.expanded?"expand_more":"expand_less")}}function Mt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",14),t.TgZ(1,"a",18),t.ALo(2,"translate"),t.TgZ(3,"i",16),t._uU(4,"lock_open"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.qZA(),t.TgZ(8,"i",19),t.NdJ("click",function(){return t.CHM(e),t.oxw().toggleHeader()}),t._uU(9),t.qZA(),t.qZA()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("title",t.lcZ(2,3,"tests.publish")),t.xp6(5),t.Oqu(t.lcZ(7,5,"tests.not-published")),t.xp6(3),t.Oqu(e.expanded?"expand_more":"expand_less")}}let St=(()=>{class n{constructor(){this.toggle=new t.vpe}toggleHeader(){this.toggle.emit(!this.expanded)}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-test-table-header"]],inputs:{test:"test",expanded:"expanded"},outputs:{toggle:"toggle"},decls:11,vars:6,consts:[[1,"d-flex","flex-column","h-100","justify-content-between"],["role","button",1,"test-designation","d-flex","flex-row","my-3","align-items-end","justify-content-between",3,"click"],[3,"ngClass"],[1,"material-icons","align-self-start"],[1,"d-flex","flex-column"],["class","d-flex flex-column mb-3",4,"ngIf"],["class","d-flex align-items-center justify-content-between test-status",4,"ngIf","ngIfElse"],["notPublished",""],[1,"d-flex","flex-column","mb-3"],[1,"d-flex","flex-row","justify-content-between"],[1,"btn","btn-link","p-0","edit",3,"routerLink"],["class","material-icons",4,"ngIf"],[1,"test-owner"],[1,"material-icons"],[1,"d-flex","align-items-center","justify-content-between","test-status"],[1,"d-flex","btn","btn-link","pl-0","edit",3,"title"],[1,"material-icons","mr-1"],["role","button",1,"material-icons","expand-mobile",3,"click"],[1,"d-flex","btn","btn-link","pl-0",3,"title"],[1,"material-icons","expand-mobile",3,"click"]],template:function(e,s){if(1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"div",1),t.NdJ("click",function(){return s.toggleHeader()}),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t.TgZ(4,"i",3),t._uU(5),t.qZA(),t.qZA(),t.TgZ(6,"div",4),t.YNc(7,Et,12,12,"div",5),t.YNc(8,$t,10,7,"div",6),t.YNc(9,Mt,10,7,"ng-template",null,7,t.W1O),t.qZA(),t.qZA()),2&e){const i=t.MAs(10);t.xp6(2),t.Q6J("ngClass",s.expanded?"expanded":"collapsed"),t.xp6(1),t.hij(" ",s.test.Designation," "),t.xp6(2),t.Oqu(s.expanded?"expand_more":"expand_less"),t.xp6(2),t.Q6J("ngIf",s.expanded),t.xp6(1),t.Q6J("ngIf",s.test.IsPublished)("ngIfElse",i)}},directives:[l.mk,l.O5,p.yS],pipes:[l.uU,It,Z.X$],styles:[".test-owner[_ngcontent-%COMP%], .collapsed[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.test-designation[_ngcontent-%COMP%]{display:none!important}.test-status[_ngcontent-%COMP%]{order:-1;padding-bottom:1.5rem}.edit[_ngcontent-%COMP%]{color:#33333d80}@media (min-width: 750px){.test-designation[_ngcontent-%COMP%]{display:inherit!important}.test-status[_ngcontent-%COMP%]{order:initial}.expand-mobile[_ngcontent-%COMP%]{display:none!important}}"]}),n})();function wt(n,o){if(1&n&&(t.TgZ(0,"div",3),t._uU(1),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",e.grade.result.Points," ")}}function Ut(n,o){if(1&n&&(t.TgZ(0,"div",1),t.YNc(1,wt,2,1,"div",2),t.TgZ(2,"div"),t._uU(3),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.grade.test.IsPointGrading),t.xp6(2),t.hij(" ",e.grade.result.GradeValue," ")}}let kt=(()=>{class n{constructor(){}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-grade"]],inputs:{grade:"grade"},decls:1,vars:1,consts:[["class","d-flex flex-row w-100",4,"ngIf"],[1,"d-flex","flex-row","w-100"],["class","w-25",4,"ngIf"],[1,"w-25"]],template:function(e,s){1&e&&t.YNc(0,Ut,4,2,"div",0),2&e&&t.Q6J("ngIf","grade"===s.grade.kind)},directives:[l.O5],styles:[""]}),n})();function Ft(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"th",22),t.TgZ(1,"erz-test-table-header",23),t.NdJ("toggle",function(i){return t.CHM(e),t.oxw(2).state.toggleHeader(i)}),t.qZA(),t.qZA()}if(2&n){const e=o.$implicit,s=t.oxw().erzLet,i=t.oxw();t.Q6J("ngClass",e.Id===i.selectedTest.Id?"selected":""),t.xp6(1),t.Q6J("test",e)("expanded",s.expanded)}}function Gt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"th",24),t.TgZ(1,"erz-test-table-header",23),t.NdJ("toggle",function(i){return t.CHM(e),t.oxw(2).state.toggleHeader(i)}),t.qZA(),t.qZA()}if(2&n){const e=o.$implicit,s=t.oxw().erzLet,i=t.oxw();t.Q6J("ngClass",e.Id===i.selectedTest.Id?"selected":""),t.xp6(1),t.Q6J("test",e)("expanded",s.expanded)}}function Jt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",28),t.TgZ(1,"span",27),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit;return t.oxw(2).state.sortBy(i)}),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.qZA()}2&n&&(t.xp6(2),t.Oqu(t.lcZ(3,1,"tests.points")))}function zt(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"th",25),t.TgZ(1,"div",11),t.YNc(2,Jt,4,3,"div",26),t.TgZ(3,"div",12),t.TgZ(4,"span",27),t.NdJ("click",function(){const a=t.CHM(e).$implicit;return t.oxw(2).state.sortBy(a)}),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.qZA(),t.TgZ(7,"div",13),t._uU(8),t.ALo(9,"async"),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=o.$implicit,s=t.oxw(2);t.Q6J("ngClass",e.Id===s.selectedTest.Id?"selected":""),t.xp6(2),t.Q6J("ngIf",e.IsPointGrading),t.xp6(3),t.Oqu(t.lcZ(6,4,"tests.grade")),t.xp6(3),t.hij(" ",t.lcZ(9,6,s.state.getSortingChar$(e))," ")}}function Nt(n,o){if(1&n&&(t.TgZ(0,"td",34),t._UZ(1,"erz-grade",35),t.qZA()),2&n){const e=o.$implicit,s=t.oxw(3);t.Q6J("ngClass",(null==e.result?null:e.result.TestId)===s.selectedTest.Id||e.TestId===s.selectedTest.Id?"selected":""),t.xp6(1),t.Q6J("grade",e)}}function Qt(n,o){if(1&n&&(t.TgZ(0,"tr"),t.TgZ(1,"td",29),t.TgZ(2,"a",30),t._uU(3),t.qZA(),t.TgZ(4,"a",31),t._uU(5," Mittelwert: 5.15 "),t.qZA(),t.qZA(),t._UZ(6,"td",32),t._UZ(7,"td",33),t.YNc(8,Nt,2,2,"td",21),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.Q6J("routerLink","#"),t.xp6(1),t.hij(" ",e.student.FullName," "),t.xp6(5),t.Q6J("ngForOf",e.grades)}}function jt(n,o){1&n&&(t.TgZ(0,"span",38),t._uU(1,"20.16"),t.qZA())}function Yt(n,o){if(1&n&&(t.TgZ(0,"td",34),t.TgZ(1,"div",36),t.YNc(2,jt,2,0,"span",37),t.TgZ(3,"span"),t._uU(4,"4.733"),t.qZA(),t.qZA(),t.qZA()),2&n){const e=o.$implicit,s=t.oxw(2);t.Q6J("ngClass",e.Id===s.selectedTest.Id||e.Id===s.selectedTest.Id?"selected":""),t.xp6(2),t.Q6J("ngIf",e.IsPointGrading)}}const D=function(n,o){return{"btn-primary":n,"btn-outline-primary":o}};function Rt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1),t.TgZ(2,"table",2),t.TgZ(3,"thead",3),t.TgZ(4,"tr",4),t.TgZ(5,"th",5),t.TgZ(6,"button",6),t.NdJ("click",function(){return t.CHM(e),t.oxw().changeFilter("all-tests")}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){return t.CHM(e),t.oxw().changeFilter("my-tests")}),t._uU(10),t.ALo(11,"translate"),t.qZA(),t.qZA(),t.YNc(12,Ft,2,3,"th",8),t.YNc(13,Gt,2,3,"th",9),t.qZA(),t.TgZ(14,"tr"),t.TgZ(15,"th",10),t.NdJ("click",function(){return t.CHM(e),t.oxw().state.sortBy("FullName")}),t.TgZ(16,"div",11),t.TgZ(17,"div",12),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"div",13),t._uU(21),t.ALo(22,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(23,"th",14),t._uU(24),t.ALo(25,"translate"),t.qZA(),t.TgZ(26,"th",15),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.YNc(29,zt,10,8,"th",16),t.qZA(),t.qZA(),t.TgZ(30,"tbody"),t.YNc(31,Qt,9,3,"tr",17),t.TgZ(32,"tr"),t.TgZ(33,"td",18),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.TgZ(36,"td",19),t._uU(37,"4.75"),t.qZA(),t.TgZ(38,"td",20),t._uU(39,"4.805"),t.qZA(),t.YNc(40,Yt,5,2,"td",21),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.BQk()}if(2&n){const e=o.erzLet,s=t.oxw();t.xp6(6),t.Q6J("ngClass",t.WLB(28,D,"all-tests"===e.filter,"all-tests"!==e.filter)),t.xp6(1),t.hij(" ",t.lcZ(8,14,"tests.all-tests")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(31,D,"my-tests"===e.filter,"my-tests"!==e.filter)),t.xp6(1),t.hij(" ",t.lcZ(11,16,"tests.owned-tests")," "),t.xp6(2),t.Q6J("ngForOf",e.tests),t.xp6(1),t.Q6J("ngForOf",e.tests),t.xp6(5),t.hij(" ",t.lcZ(19,18,"tests.student.name")," "),t.xp6(3),t.hij(" ",t.lcZ(22,20,s.state.getSortingChar$("FullName"))," "),t.xp6(3),t.hij(" ",t.lcZ(25,22,"tests.grade")," "),t.xp6(3),t.hij(" ",t.lcZ(28,24,"tests.average")," "),t.xp6(2),t.Q6J("ngForOf",e.tests),t.xp6(2),t.Q6J("ngForOf",e.studentGrades),t.xp6(3),t.Oqu(t.lcZ(35,26,"tests.average")),t.xp6(6),t.Q6J("ngForOf",e.tests)}}const Ht=function(n,o,e,s){return{tests:n,studentGrades:o,filter:e,expanded:s}};let Dt=(()=>{class n{constructor(e){this.state=e}ngOnInit(){this.state.course=this.course,this.state.setSorting({key:"FullName",ascending:!0})}changeFilter(e){this.state.filter$.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Lt))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-test-edit-grades"]],inputs:{course:"course",selectedTest:"selectedTest"},decls:5,vars:14,consts:[[4,"erzLet"],[1,"table-responsive-wrapper"],[1,"table","table-hover","h-100"],[1,"h-100"],[1,"h-100","header-collapsible"],["colspan","3",1,"desktop","pt-3","sticky"],["type","button",1,"btn","desktop",3,"ngClass","click"],["type","button",1,"btn","ml-2","desktop",3,"ngClass","click"],["container","body","class","grade h-100 test-info-desktop",3,"ngClass",4,"ngFor","ngForOf"],["container","body","class","grade h-100 header-mobile test-info-mobile","colspan","3",3,"ngClass",4,"ngFor","ngForOf"],[1,"primary-column-width","sticky",3,"click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction","ml-1"],[1,"secondary-column-width","sticky","sticky-col-2","desktop"],[1,"secondary-column-width","border-right","sticky","sticky-col-3","desktop"],["container","body","class","grade h-100",3,"ngClass",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf"],[1,"sticky"],[1,"desktop","sticky","sticky","sticky-col-2"],[1,"desktop","border-right","sticky","sticky-col-3"],["class","grade",3,"ngClass",4,"ngFor","ngForOf"],["container","body",1,"grade","h-100","test-info-desktop",3,"ngClass"],[3,"test","expanded","toggle"],["container","body","colspan","3",1,"grade","h-100","header-mobile","test-info-mobile",3,"ngClass"],["container","body",1,"grade","h-100",3,"ngClass"],["class","w-25 column-title",4,"ngIf"],[3,"click"],[1,"w-25","column-title"],[1,"primary-column-width","sticky"],[3,"routerLink"],["href","",1,"mobile"],[1,"grade","sticky","sticky-col-2"],[1,"grade","border-right","sticky","sticky-col-3"],[1,"grade",3,"ngClass"],[3,"grade"],[1,"d-flex","flex-row","w-100"],["class","w-25",4,"ngIf"],[1,"w-25"]],template:function(e,s){1&e&&(t.YNc(0,Rt,41,34,"ng-container",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async")),2&e&&t.Q6J("erzLet",t.l5B(9,Ht,t.lcZ(1,1,s.state.tests$),t.lcZ(2,3,s.state.studentGrades$),t.lcZ(3,5,s.state.filter$),t.lcZ(4,7,s.state.expandedHeader$)))},directives:[L.e,l.mk,l.sg,St,l.O5,p.yS,kt],pipes:[l.Ov,Z.X$],styles:[".filter-hover[_ngcontent-%COMP%]:hover{background-color:#8a8a8a}table[_ngcontent-%COMP%]   th.grade.selected[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade.selected[_ngcontent-%COMP%]{display:table-cell!important}table[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade[_ngcontent-%COMP%], .desktop[_ngcontent-%COMP%]{display:none!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;vertical-align:top}.header-collapsible[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:0 1.5rem}.mobile[_ngcontent-%COMP%]{display:block!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-desktop[_ngcontent-%COMP%]{display:none!important}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1.5rem}@media (min-width: 576px){.table-responsive-wrapper[_ngcontent-%COMP%]{display:block;overflow-x:auto}table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-mobile[_ngcontent-%COMP%]{display:none!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-desktop[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade[_ngcontent-%COMP%], .desktop[_ngcontent-%COMP%]{display:table-cell!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;padding-top:.375rem;padding-bottom:.375rem;border-top:initial;min-width:100px;max-width:100px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%]{min-width:300px;max-width:300px}.mobile[_ngcontent-%COMP%]{display:none!important}.primary-column-width[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:200px;max-width:200px}.secondary-column-width[_ngcontent-%COMP%]{min-width:100px;max-width:100px}table[_ngcontent-%COMP%]   .sticky[_ngcontent-%COMP%]{position:sticky;left:0;background-color:#fff}table[_ngcontent-%COMP%]   .sticky.sticky-col-2[_ngcontent-%COMP%]{left:200px}table[_ngcontent-%COMP%]   .sticky.sticky-col-3[_ngcontent-%COMP%]{left:300px}}"]}),n})();var G=r(2925);function Wt(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"erz-select",6),t.NdJ("valueChange",function(i){return t.CHM(e),t.oxw(3).testSelected(i)}),t.qZA(),t._UZ(2,"erz-test-edit-grades",7),t.BQk()}if(2&n){const e=t.oxw(2).erzLet;t.xp6(1),t.Q6J("options",e.testOptions)("value",e.selectedTestId)("allowEmpty",!1),t.xp6(1),t.Q6J("course",e.course)("selectedTest",e.selectedTest)}}function Bt(n,o){if(1&n&&(t.ynx(0),t._UZ(1,"erz-tests-header",5),t.YNc(2,Wt,3,5,"ng-container",4),t.BQk()),2&n){const e=t.oxw().erzLet;t.oxw();const s=t.MAs(8);t.xp6(1),t.Q6J("course",e.course),t.xp6(1),t.Q6J("ngIf",e.tests.length>0)("ngIfElse",s)}}function Xt(n,o){if(1&n&&(t.ynx(0),t.YNc(1,Bt,3,3,"ng-container",4),t.ALo(2,"async"),t.BQk()),2&n){const e=t.oxw(),s=t.MAs(10);t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(2,2,e.state.loading$))("ngIfElse",s)}}function Kt(n,o){1&n&&(t.TgZ(0,"p",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"tests.no-tests")))}function Vt(n,o){1&n&&t._UZ(0,"erz-spinner")}const te=function(n,o,e,s,i){return{course:n,tests:o,testOptions:e,selectedTestId:s,selectedTest:i}};let ee=(()=>{class n{constructor(e,s){this.state=e,this.route=s,this.selectTest$=new R.x,this.courseId$=this.route.paramMap.pipe((0,m.U)(i=>Number(i.get("id"))),(0,b.x)()),this.course$=this.courseId$.pipe((0,_.w)(i=>this.state.getCourse(i)),(0,pt.d)(1)),this.tests$=this.course$.pipe((0,m.U)(i=>{var a;return null!==(a=i.Tests)&&void 0!==a?a:[]}),(0,b.x)()),this.testOptions$=this.tests$.pipe((0,m.U)(i=>i.map(a=>({Key:a.Id,Value:a.Designation}))),(0,b.x)()),this.selectedTestId$=(0,mt.T)(this.selectTest$,this.tests$.pipe((0,m.U)(i=>{var a;return null===(a=i[0])||void 0===a?void 0:a.Id}))).pipe((0,b.x)()),this.selectedTest$=this.selectedTestId$.pipe((0,_.w)(i=>this.tests$.pipe((0,m.U)(a=>a.find(d=>d.Id===i)))),(0,b.x)())}testSelected(e){this.selectTest$.next(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S),t.Y36(p.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-list"]],decls:11,vars:17,consts:[[1,"erz-container","erz-container-padding-y","erz-container-padding-x-responsive"],[4,"erzLet"],["noTests",""],["loading",""],[4,"ngIf","ngIfElse"],[3,"course"],[1,"tests-dropdown",3,"options","value","allowEmpty","valueChange"],[3,"course","selectedTest"],[1,"mt-3","px-3"]],template:function(e,s){1&e&&(t.TgZ(0,"div",0),t.YNc(1,Xt,3,4,"ng-container",1),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async"),t.ALo(6,"async"),t.YNc(7,Kt,3,3,"ng-template",null,2,t.W1O),t.YNc(9,Vt,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&e&&(t.xp6(1),t.Q6J("erzLet",t.qbA(11,te,t.lcZ(2,1,s.course$),t.lcZ(3,3,s.tests$),t.lcZ(4,5,s.testOptions$),t.lcZ(5,7,s.selectedTestId$),t.lcZ(6,9,s.selectedTest$))))},directives:[L.e,l.O5,xt,Zt.H,Dt,G.O],pipes:[l.Ov,Z.X$],styles:[".tests-dropdown[_ngcontent-%COMP%]{display:block;padding:1.5rem}@media (min-width: 576px){.tests-dropdown[_ngcontent-%COMP%]{display:none}}"]}),n})();var ne=r(368);function se(n,o){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t.ALo(3,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.AsE("",t.xi3(2,2,e.dateFrom,"dd.MM.yyyy"),"\u2013",t.xi3(3,5,e.dateTo,"dd.MM.yyyy"),"")}}const oe=function(n){return[n,"tests"]};function ie(n,o){if(1&n&&(t.TgZ(0,"a",18),t.TgZ(1,"i",19),t._uU(2,"arrow_right_alt"),t.qZA(),t.TgZ(3,"span",20),t._uU(4),t.qZA(),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(2,oe,e.id)),t.xp6(4),t.Oqu(e.evaluationText)}}function re(n,o){if(1&n&&(t.TgZ(0,"a",21),t.TgZ(1,"i",19),t._uU(2,"arrow_right_alt"),t.qZA(),t.TgZ(3,"span",20),t._uU(4),t.qZA(),t.qZA()),2&n){const e=t.oxw().$implicit;t.Q6J("href",e.evaluationLink,t.LSH),t.xp6(4),t.hij("",e.evaluationText," ")}}function ae(n,o){if(1&n&&(t.TgZ(0,"div",12),t.TgZ(1,"div",7),t.TgZ(2,"a",13),t._uU(3),t.qZA(),t.qZA(),t.TgZ(4,"div",8),t.YNc(5,se,4,8,"span",14),t.qZA(),t.TgZ(6,"div",9),t._uU(7),t.TgZ(8,"span",15),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.qZA(),t.TgZ(11,"div",10),t.YNc(12,ie,5,4,"a",16),t.YNc(13,re,5,2,"a",17),t.qZA(),t.qZA()),2&n){const e=o.$implicit;t.xp6(2),t.Q6J("href",e.detailLink,t.LSH),t.xp6(1),t.Oqu(e.Designation),t.xp6(2),t.Q6J("ngIf",e.dateFrom&&e.dateTo),t.xp6(2),t.hij(" ",e.studentCount," "),t.xp6(2),t.Oqu(t.lcZ(10,7,1===e.studentCount?"events.registration":"events.registrations")),t.xp6(3),t.Q6J("ngIf","add-tests"===e.state),t.xp6(1),t.Q6J("ngIf",e.evaluationText&&e.evaluationLink)}}function ce(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",6),t.TgZ(2,"div",7),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",8),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",9),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.TgZ(11,"div",10),t._uU(12),t.ALo(13,"translate"),t.qZA(),t.qZA(),t.YNc(14,ae,14,9,"div",11),t.BQk()),2&n){const e=t.oxw(2).erzLet;t.xp6(3),t.Oqu(t.lcZ(4,5,"events.designation")),t.xp6(3),t.Oqu(t.lcZ(7,7,"events.date")),t.xp6(3),t.hij(" ",t.lcZ(10,9,"events.registrations")," "),t.xp6(3),t.Oqu(t.lcZ(13,11,"events.rating")),t.xp6(2),t.Q6J("ngForOf",e.events)}}function de(n,o){1&n&&(t.TgZ(0,"p",22),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"events.no-events")))}function le(n,o){if(1&n&&(t.ynx(0),t.YNc(1,ce,15,13,"ng-container",3),t.YNc(2,de,3,3,"ng-template",null,5,t.W1O),t.BQk()),2&n){const e=t.MAs(3),s=t.oxw().erzLet;t.xp6(1),t.Q6J("ngIf",(null==s.events?null:s.events.length)>0)("ngIfElse",e)}}function ue(n,o){1&n&&t._UZ(0,"erz-spinner")}function ge(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"erz-resettable-input",2),t.NdJ("valueChange",function(i){return t.CHM(e),t.oxw().state.search$.next(i)}),t.ALo(2,"async"),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.YNc(5,le,4,2,"ng-container",3),t.ALo(6,"async"),t.YNc(7,ue,1,0,"ng-template",null,4,t.W1O),t.qZA()}if(2&n){const e=o.erzLet,s=t.MAs(8),i=t.oxw();t.xp6(1),t.Q6J("value",t.lcZ(2,6,i.state.search$))("placeholder",t.lcZ(3,8,"events.search-by"))("label",t.lcZ(4,10,"events.search"))("disabled",!e.events),t.xp6(4),t.Q6J("ngIf",!1===t.lcZ(6,12,i.state.loading$))("ngIfElse",s)}}const pe=function(n){return{events:n}};let me=(()=>{class n{constructor(e){this.state=e}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(Y))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events-list"]],decls:2,vars:5,consts:[["class","erz-container erz-container-padding-y erz-container-padding-x-responsive",4,"erzLet"],[1,"erz-container","erz-container-padding-y","erz-container-padding-x-responsive"],[1,"d-flex","search",3,"value","placeholder","label","disabled","valueChange"],[4,"ngIf","ngIfElse"],["loading",""],["noEvents",""],[1,"event-header"],[1,"designation"],[1,"date"],[1,"registrations"],[1,"rating"],["class","event-entry",4,"ngFor","ngForOf"],[1,"event-entry"],[3,"href"],[4,"ngIf"],[1,"registrations-label"],["class","d-flex",3,"routerLink",4,"ngIf"],["class","d-flex",3,"href",4,"ngIf"],[1,"d-flex",3,"routerLink"],[1,"material-icons"],[1,"pl-1"],[1,"d-flex",3,"href"],[1,"mt-3"]],template:function(e,s){1&e&&(t.YNc(0,ge,9,14,"div",0),t.ALo(1,"async")),2&e&&t.Q6J("erzLet",t.VKq(3,pe,t.lcZ(1,1,s.state.filteredEvents$)))},directives:[L.e,ne.w,l.O5,l.sg,p.yS,G.O],pipes:[l.Ov,Z.X$,l.uU],styles:['.search[_ngcontent-%COMP%]{max-width:500px}.event-header[_ngcontent-%COMP%]{display:grid;padding:1.5rem;border-bottom:2px solid #dee2e6;grid-template-areas:"designation date registrations rating";grid-template-columns:4fr 2fr 1fr 2fr}.event-entry[_ngcontent-%COMP%]{display:grid;border-bottom:1px solid #dee2e6;padding:1.5rem;grid-template-areas:"designation date registrations rating";grid-template-columns:4fr 2fr 1fr 2fr}.designation[_ngcontent-%COMP%]{grid-area:designation}.registrations-label[_ngcontent-%COMP%]{display:none}@media (max-width: 767.98px){.search[_ngcontent-%COMP%]{padding:0 1.5rem}.event-header[_ngcontent-%COMP%]{display:none}.registrations-label[_ngcontent-%COMP%]{display:inline}.event-entry[_ngcontent-%COMP%]{grid-template-areas:"designation" "date" "registrations" "rating";grid-template-columns:1fr}}']}),n})();var W=r(8746),B=r(2290),h=r(3075),w=r(1504),P=r(9646),_e=r(2722),fe=r(6124),q=r(2103);function ve(n,o){if(1&n&&(t.TgZ(0,"div",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function he(n,o){if(1&n&&(t.TgZ(0,"div",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function xe(n,o){if(1&n&&(t.TgZ(0,"div",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function Ze(n,o){if(1&n&&(t.TgZ(0,"div",36),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=o.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function Te(n,o){if(1&n&&(t.ynx(0),t.TgZ(1,"div",37),t.TgZ(2,"div",38),t.TgZ(3,"div",17),t.TgZ(4,"label",39),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"div",40),t._UZ(8,"input",41),t.ALo(9,"async"),t.YNc(10,Ze,3,4,"div",7),t.ALo(11,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(12,"div",38),t.TgZ(13,"div",17),t.TgZ(14,"label",42),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",40),t._UZ(18,"input",43),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(19,"div",44),t.pZz(),t.TgZ(20,"math"),t.TgZ(21,"mi"),t._uU(22),t.ALo(23,"translate"),t.qZA(),t.TgZ(24,"mo"),t._uU(25,"="),t.qZA(),t.TgZ(26,"mfrac"),t.TgZ(27,"mrow"),t.TgZ(28,"mi"),t._uU(29),t.ALo(30,"translate"),t.qZA(),t.TgZ(31,"mo"),t._uU(32,"\xd7"),t.qZA(),t.TgZ(33,"mn"),t._uU(34,"5"),t.qZA(),t.qZA(),t.TgZ(35,"mi"),t._uU(36),t.ALo(37,"translate"),t.qZA(),t.qZA(),t.TgZ(38,"mo"),t._uU(39,"+"),t.qZA(),t.TgZ(40,"mn"),t._uU(41,"1"),t.qZA(),t.qZA(),t.qZA(),t.BQk()),2&n){const e=t.oxw(3);t.xp6(5),t.Oqu(t.lcZ(6,8,"tests.form.max-points")),t.xp6(3),t.ekj("is-invalid",t.lcZ(9,10,e.maxPointsErrors$).length>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(11,12,e.maxPointsErrors$)),t.xp6(5),t.Oqu(t.lcZ(16,14,"tests.form.max-points-adjusted")),t.xp6(7),t.hij(" ",t.lcZ(23,16,"tests.form.math.grade")," "),t.xp6(7),t.hij(" ",t.lcZ(30,18,"tests.form.math.points")," "),t.xp6(7),t.Oqu(t.lcZ(37,20,"tests.form.math.max-points"))}}function Ae(n,o){1&n&&(t.TgZ(0,"div",45),t.TgZ(1,"span",46),t._uU(2,"Loading..."),t.qZA(),t.qZA())}const Ce=function(n){return["/events",n,"tests"]};function ye(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw(2).onSubmit()}),t.TgZ(1,"div",3),t.TgZ(2,"div",4),t.TgZ(3,"label",5),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",6),t.ALo(7,"async"),t.ALo(8,"translate"),t.YNc(9,ve,3,4,"div",7),t.ALo(10,"async"),t.qZA(),t.TgZ(11,"div",4),t.TgZ(12,"label",8),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div",9),t.TgZ(16,"div",10),t.TgZ(17,"span",11),t.TgZ(18,"i",12),t._uU(19,"calendar_today"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(20,"input",13,14),t.NdJ("click",function(){return t.CHM(e),t.MAs(21).toggle()}),t.ALo(22,"async"),t.ALo(23,"translate"),t.qZA(),t.YNc(24,he,3,4,"div",7),t.ALo(25,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(26,"h6"),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div",15),t.TgZ(30,"div",16),t.TgZ(31,"div",17),t.TgZ(32,"label",18),t._uU(33),t.ALo(34,"translate"),t.qZA(),t.TgZ(35,"div",19),t._UZ(36,"input",20),t.ALo(37,"async"),t.YNc(38,xe,3,4,"div",7),t.ALo(39,"async"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(40,"div",21),t.TgZ(41,"div",17),t.TgZ(42,"label",22),t._uU(43),t.ALo(44,"translate"),t.qZA(),t.TgZ(45,"div",23),t._UZ(46,"input",24),t.ALo(47,"percent"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(48,"h6"),t._uU(49),t.ALo(50,"translate"),t.qZA(),t.TgZ(51,"div",25),t.TgZ(52,"div",26),t._UZ(53,"input",27),t.TgZ(54,"label",28),t._uU(55),t.ALo(56,"translate"),t.qZA(),t.qZA(),t.TgZ(57,"div",26),t._UZ(58,"input",29),t.TgZ(59,"label",30),t._uU(60),t.ALo(61,"translate"),t.qZA(),t.qZA(),t.YNc(62,Te,42,22,"ng-container",31),t.qZA(),t.TgZ(63,"div",32),t.TgZ(64,"button",33),t._uU(65),t.ALo(66,"translate"),t.qZA(),t.TgZ(67,"button",34),t._uU(68),t.ALo(69,"translate"),t.YNc(70,Ae,3,0,"div",35),t.qZA(),t.qZA(),t.qZA()}if(2&n){const e=t.oxw().erzLet,s=t.oxw();t.Q6J("formGroup",e.formGroup),t.xp6(4),t.Oqu(t.lcZ(5,31,"tests.form.designation")),t.xp6(2),t.ekj("is-invalid",t.lcZ(7,33,s.designationErrors$).length>0),t.Q6J("placeholder",t.lcZ(8,35,"tests.form.designation-placeholder")),t.xp6(3),t.Q6J("ngForOf",t.lcZ(10,37,s.designationErrors$)),t.xp6(4),t.Oqu(t.lcZ(14,39,"tests.form.date")),t.xp6(4),t.Q6J("id",s.componentId),t.xp6(3),t.ekj("is-invalid",t.lcZ(22,41,s.dateErrors$).length>0),t.Q6J("placeholder",t.lcZ(23,43,"shared.date-select.default-placeholder")),t.xp6(4),t.Q6J("ngForOf",t.lcZ(25,45,s.dateErrors$)),t.xp6(3),t.Oqu(t.lcZ(28,47,"tests.form.weight")),t.xp6(6),t.Oqu(t.lcZ(34,49,"tests.form.factor")),t.xp6(3),t.ekj("is-invalid",t.lcZ(37,51,s.weightErrors$).length>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(39,53,s.weightErrors$)),t.xp6(5),t.Oqu(t.lcZ(44,55,"tests.form.percentage")),t.xp6(3),t.Q6J("value",t.lcZ(47,57,e.formGroup.get("weightPercent").value)),t.xp6(3),t.Oqu(t.lcZ(50,59,"tests.form.grading-type")),t.xp6(4),t.Q6J("value",!1),t.xp6(2),t.Oqu(t.lcZ(56,61,"tests.form.grades")),t.xp6(3),t.Q6J("value",!0),t.xp6(2),t.Oqu(t.lcZ(61,63,"tests.form.points")),t.xp6(2),t.Q6J("ngIf",e.formGroup.get("isPointGrading").value),t.xp6(2),t.Q6J("disabled",s.saving)("routerLink",t.VKq(69,Ce,s.courseId)),t.xp6(1),t.hij(" ",t.lcZ(66,65,"tests.form.cancel")," "),t.xp6(2),t.Q6J("disabled",s.saving),t.xp6(1),t.hij(" ",t.lcZ(69,67,"tests.form.save")," "),t.xp6(2),t.Q6J("ngIf",s.saving)}}function be(n,o){if(1&n&&(t.ynx(0),t.YNc(1,ye,71,71,"form",1),t.BQk()),2&n){const e=o.erzLet;t.xp6(1),t.Q6J("ngIf",e.formGroup)}}const Oe=function(n){return{formGroup:n}};let X=(()=>{class n{constructor(e,s){this.fb=e,this.translate=s,this.save=new t.vpe,this.formGroup=this.createFormGroup(),this.submitted$=new T.X(!1),this.destroy$=new R.x,this.designationErrors$=(0,q.Z6)((0,P.of)(this.formGroup),this.submitted$,"designation"),this.dateErrors$=(0,q.Z6)((0,P.of)(this.formGroup),this.submitted$,"date"),this.maxPointsErrors$=(0,q.Z6)((0,P.of)(this.formGroup),this.submitted$,"maxPoints"),this.weightErrors$=(0,q.Z6)((0,P.of)(this.formGroup),this.submitted$,"weight")}ngOnInit(){this.test&&this.setInitialValues(this.test),(0,q.ZX)((0,P.of)(this.formGroup),"isPointGrading").pipe((0,_e.R)(this.destroy$)).subscribe(this.togglePointFieldsDisability.bind(this))}ngOnDestroy(){this.destroy$.next()}onSubmit(){this.submitted$.next(!0),this.formGroup.valid&&this.save.emit(this.formGroup)}createFormGroup(){return this.fb.group({designation:["",h.kI.required],date:[null,h.kI.required],weight:[1,h.kI.required],weightPercent:[1],isPointGrading:[!1],maxPoints:[{value:null,disabled:!0},h.kI.required],maxPointsAdjusted:[{value:null,disabled:!0},null]})}setInitialValues(e){var s,i,a;this.formGroup.patchValue({designation:e.Designation,date:e.Date,weight:e.Weight,weightPercent:e.WeightPercent,isPointGrading:e.IsPointGrading,maxPoints:e.MaxPoints,maxPointsAdjusted:e.MaxPointsAdjusted}),e.Results&&e.Results.length>0&&(null===(s=this.formGroup.get("isPointGrading"))||void 0===s||s.disable(),null===(i=this.formGroup.get("maxPoints"))||void 0===i||i.disable(),null===(a=this.formGroup.get("maxPointsAdjusted"))||void 0===a||a.disable()),this.togglePointFieldsDisability()}togglePointFieldsDisability(){var e;const s=this.formGroup.get("maxPoints"),i=this.formGroup.get("maxPointsAdjusted");(null===(e=this.formGroup.get("isPointGrading"))||void 0===e?void 0:e.value)?(null==s||s.enable(),null==i||i.enable()):(null==s||s.reset({value:null,disabled:!0}),null==i||i.reset({value:null,disabled:!0}))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.qu),t.Y36(Z.sK))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-edit-form"]],inputs:{courseId:"courseId",test:"test",saving:"saving"},outputs:{save:"save"},features:[t._Bn([{provide:w.DO,useClass:w.s5},{provide:w.NG,useClass:fe.n}])],decls:1,vars:3,consts:[[4,"erzLet"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"form-row","my-3"],[1,"form-group","col-md-6"],["for","designation"],["id","designation","name","designation","type","text","formControlName","designation","required","",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngFor","ngForOf"],["for","date"],[1,"input-group"],[1,"input-group-prepend"],[1,"input-group-text",3,"id"],[1,"material-icons"],["id","date","name","date","type","text","ngbDatepicker","","formControlName","date","required","",1,"form-control",3,"placeholder","click"],["dp","ngbDatepicker"],[1,"form-row","mb-3"],[1,"col-md-3"],[1,"form-group","row"],["for","factor",1,"col-6","col-md-auto","col-form-label"],[1,"col-6","col-md-6"],["id","factor","name","factor","type","number","formControlName","weight","step","0.05","min","0","required","",1,"form-control"],[1,"col-md-auto"],["for","percentage",1,"col-6","col-md-auto","col-form-label"],[1,"col-6","col-md-4"],["type","text","readonly","","id","percentage",1,"form-control-plaintext",3,"value"],[1,"form-group","mb-3"],[1,"form-check"],["type","radio","formControlName","isPointGrading","id","type-grades",1,"form-check-input",3,"value"],["for","type-grades",1,"form-check-label"],["type","radio","formControlName","isPointGrading","id","type-points",1,"form-check-input",3,"value"],["for","type-points",1,"form-check-label"],[4,"ngIf"],[1,"d-flex","justify-content-end","mt-4"],["type","button",1,"btn","btn-secondary",3,"disabled","routerLink"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"invalid-feedback"],[1,"form-row","ml-4","mb-3"],[1,"col-sm-6","col-md-4"],["for","max-points",1,"col-4","col-form-label"],[1,"col-6"],["type","number","name","maxPoints","id","max-points","formControlName","maxPoints","step","0.01","min","0","max","10","required","",1,"form-control"],["for","max-points-adjusted",1,"col-4","col-form-label"],["type","number","name","maxPointsAdjusted","id","max-points-adjusted","formControlName","maxPointsAdjusted","step","0.01","min","0","max","10",1,"form-control"],[1,"ml-4","pl-2"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"sr-only"]],template:function(e,s){1&e&&t.YNc(0,be,2,1,"ng-container",0),2&e&&t.Q6J("erzLet",t.VKq(1,Oe,s.formGroup))},directives:[L.e,l.O5,h._Y,h.JL,h.sg,h.Fj,h.JJ,h.u,h.Q7,l.sg,w.J4,h.wV,h.qQ,h._,h.Fd,p.rH],pipes:[Z.X$,l.Ov,l.Zx],styles:[""]}),n})();function Le(n,o){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",4),t.TgZ(2,"h6",5),t._uU(3),t.qZA(),t.TgZ(4,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().erzLet;return t.oxw().delete(i.test)}),t.TgZ(5,"i",7),t._uU(6,"delete"),t.qZA(),t.qZA(),t.qZA(),t.TgZ(7,"erz-tests-edit-form",8),t.NdJ("save",function(i){return t.CHM(e),t.oxw(2).save(i)}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw().erzLet;t.xp6(3),t.Oqu(e.test.Designation),t.xp6(4),t.Q6J("courseId",e.courseId)("test",e.test)("saving",e.saving)}}function Ie(n,o){1&n&&t._UZ(0,"erz-spinner")}function Pe(n,o){if(1&n&&(t.TgZ(0,"div",1),t.YNc(1,Le,8,4,"ng-container",2),t.ALo(2,"async"),t.YNc(3,Ie,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&n){const e=t.MAs(4),s=t.oxw();t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(2,2,s.state.loading$))("ngIfElse",e)}}const qe=function(n,o,e){return{courseId:n,test:o,saving:e}};let Ee=(()=>{class n{constructor(e,s,i,a,d,u){this.state=e,this.courseService=s,this.route=i,this.toastr=a,this.translate=d,this.router=u,this.saving$=new T.X(!1),this.courseId$=this.route.paramMap.pipe((0,m.U)(g=>Number(g.get("id"))),(0,b.x)()),this.testId$=this.route.paramMap.pipe((0,m.U)(g=>Number(g.get("testId"))),(0,b.x)()),this.tests$=this.courseId$.pipe((0,_.w)(g=>this.state.getCourse(g)),(0,m.U)(g=>{var v;return null!==(v=g.Tests)&&void 0!==v?v:[]})),this.test$=(0,O.a)([this.tests$,this.testId$]).pipe((0,m.U)(([g,v])=>g.find(C=>C.Id===v)))}delete(e){e.Results&&e.Results.length>0?alert(this.translate.instant("tests.form.delete-not-allowed")):confirm(this.translate.instant("tests.form.confirm"))&&this.courseService.delete(e.CourseId,e.Id).subscribe(this.onDeleteSuccess.bind(this))}save(e){this.saving$.next(!0);const{designation:s,date:i,weight:a,isPointGrading:d,maxPoints:u,maxPointsAdjusted:g}=e.value;(0,O.a)([this.courseId$,this.testId$]).pipe((0,_.w)(([v,C])=>this.courseService.update(v,C,s,i,a,d,u,g)),(0,W.x)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastr.success(this.translate.instant("tests.form.save-success")),this.navigateBack()}onDeleteSuccess(){this.toastr.success(this.translate.instant("tests.form.delete-success")),this.navigateBack()}navigateBack(){this.courseId$.subscribe(e=>this.router.navigate(["events",e,"tests"]))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(S),t.Y36(M),t.Y36(p.gz),t.Y36(B._W),t.Y36(Z.sK),t.Y36(p.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-edit"]],decls:4,vars:11,consts:[["class","erz-container erz-container-limited erz-container-padding-y",4,"erzLet"],[1,"erz-container","erz-container-limited","erz-container-padding-y"],[4,"ngIf","ngIfElse"],["loading",""],[1,"d-flex","justify-content-between","align-items-center"],[1,"mb-0"],["type","button",1,"btn","btn-primary",3,"click"],[1,"material-icons"],[3,"courseId","test","saving","save"]],template:function(e,s){1&e&&(t.YNc(0,Pe,5,4,"div",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async")),2&e&&t.Q6J("erzLet",t.kEZ(7,qe,t.lcZ(1,1,s.courseId$),t.lcZ(2,3,s.test$),t.lcZ(3,5,s.saving$)))},directives:[L.e,l.O5,X,G.O],pipes:[l.Ov],styles:[""]}),n})();function $e(n,o){if(1&n){const e=t.EpF();t.TgZ(0,"div",1),t.TgZ(1,"erz-tests-edit-form",2),t.NdJ("save",function(i){return t.CHM(e),t.oxw().save(i)}),t.qZA(),t.qZA()}if(2&n){const e=o.erzLet;t.xp6(1),t.Q6J("courseId",e.courseId)("saving",e.saving)}}const Me=function(n,o){return{courseId:n,saving:o}},Se=[{path:"",component:ut,children:[{path:"",component:me}]},{path:"",component:gt,children:[{path:":id/tests",component:ee},{path:":id/tests/add",component:(()=>{class n{constructor(e,s,i,a,d){this.route=e,this.courseService=s,this.toastr=i,this.translate=a,this.router=d,this.saving$=new T.X(!1),this.courseId$=this.route.paramMap.pipe((0,m.U)(u=>Number(u.get("id"))),(0,b.x)())}save(e){this.saving$.next(!0);const{designation:s,date:i,weight:a,isPointGrading:d,maxPoints:u,maxPointsAdjusted:g}=e.value;this.courseId$.pipe((0,_.w)(v=>this.courseService.add(v,i,s,a,d,u,g)),(0,W.x)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastr.success(this.translate.instant("tests.form.save-success")),this.navigateBack()}navigateBack(){this.courseId$.subscribe(e=>this.router.navigate(["events",e,"tests"]))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(p.gz),t.Y36(M),t.Y36(B._W),t.Y36(Z.sK),t.Y36(p.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-add"]],decls:3,vars:8,consts:[["class","erz-container erz-container-limited erz-container-padding-y",4,"erzLet"],[1,"erz-container","erz-container-limited","erz-container-padding-y"],[3,"courseId","saving","save"]],template:function(e,s){1&e&&(t.YNc(0,$e,2,2,"div",0),t.ALo(1,"async"),t.ALo(2,"async")),2&e&&t.Q6J("erzLet",t.WLB(5,Me,t.lcZ(1,1,s.courseId$),t.lcZ(2,3,s.saving$)))},directives:[L.e,X],pipes:[l.Ov],styles:[""]}),n})()},{path:":id/tests/edit/:testId",component:Ee}]}];let we=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[p.Bz.forChild(Se)],p.Bz]}),n})(),Ue=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[U.m,we]]}),n})()},4379:(K,E,r)=>{r.d(E,{K:()=>I});var U=r(1854),p=r(1135),k=r(1884),T=r(4782),O=r(4004),m=r(5698),$=r(5e3);let I=(()=>{class y{constructor(){this.sortingSubject$=new p.X(null),this.sorting$=this.sortingSubject$.asObservable().pipe((0,k.x)(U.Z),(0,T.d)(1))}getSortingChar$(_){return this.sorting$.pipe((0,O.U)(x=>x&&_===x.key?x.ascending?"\u2193":"\u2191":""))}setSorting(_){this.sortingSubject$.next(_)}toggleSorting(_){this.sorting$.pipe((0,m.q)(1)).subscribe(x=>{this.sortingSubject$.next(x&&x.key===_?{key:_,ascending:!x.ascending}:{key:_,ascending:!0})})}}return y.\u0275fac=function(_){return new(_||y)},y.\u0275prov=$.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"}),y})()}}]);