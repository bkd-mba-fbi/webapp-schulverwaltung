import{a as Cn,b as vn}from"./chunk-673RVEOB.js";import{a as me,b as we}from"./chunk-KDAC4GJ5.js";import{b as bn}from"./chunk-ZROJU7EX.js";import{a as yn}from"./chunk-XYF73IOS.js";import{a as Pn,b as xn}from"./chunk-RQFEXCIP.js";import{a as _n}from"./chunk-GXZYLK4L.js";import{e as fn}from"./chunk-U4HODSW3.js";import{q as gn,v as Ie}from"./chunk-7LCBKZQT.js";import{a as at}from"./chunk-PSXDSPKS.js";import{b as Jt,e as ze}from"./chunk-C7XT5XXE.js";import{a as rn}from"./chunk-YMJC6QZX.js";import"./chunk-Y4QYVF5K.js";import"./chunk-HII3S2DL.js";import{a as In}from"./chunk-DZZC2YX2.js";import{a as Sn}from"./chunk-K3EEKOGY.js";import{a as pt,d as un}from"./chunk-24AFRN2G.js";import{a as cn}from"./chunk-RFO4NYUO.js";import{a as an,b as pn}from"./chunk-5RDJZAUT.js";import"./chunk-DB66EACG.js";import{E as en,F as tn,L as nn,P as on,T as Se,U as sn,W as ct,Y as hn,j as Xt,t as Yt,y as Zt,z as Qe}from"./chunk-ZK2MNT7Z.js";import{d as st,e as ae}from"./chunk-AW7CSGKI.js";import{b as pe}from"./chunk-FTDG26ID.js";import{a as ce,b as Ke,c as xe,g as ln,h as dn,i as mn}from"./chunk-SOHFFTKU.js";import{f as Rt,g as Nt,h as He,i as Gt,j as Ut,k as Ht,m as qt,n as Wt,o as Ee,p as se,u as zt,w as We}from"./chunk-C56YGDXA.js";import{a as Pe}from"./chunk-UX5TA32W.js";import{$ as L,$a as u,$c as Vt,A as ht,Ab as l,B as _t,Bb as m,C as nt,Cb as U,Dd as Qt,E as D,Eb as _e,Fd as Q,G as Ve,Ga as v,Gd as F,Hd as j,Ia as g,Id as Kt,J as Ct,Ja as K,K as vt,Ka as Pt,L as B,La as Re,Lc as Ft,M as it,Mb as Et,N as Ae,O as T,Q as q,Qb as Dt,Rb as N,Sa as c,Sb as ie,Ta as p,Ua as W,Va as Z,Vb as oe,Vc as H,W as R,Wa as ee,Wb as Ce,Ya as M,Yc as jt,Z as y,_a as b,a as ue,ad as ve,b as ge,bc as ot,bd as be,db as z,dc as Ne,dd as At,e as $,ed as ye,f as fe,fb as St,g as Te,ga as bt,gb as xt,ha as P,hb as It,ia as S,ib as te,jb as d,k as J,kb as w,la as yt,lb as x,m as f,mb as wt,n as O,nb as Mt,ob as kt,oc as Ge,pc as Bt,r as $e,ra as Y,rc as Ue,rd as re,sb as he,t as ft,tb as E,td as rt,ua as s,ub as Ot,v as X,va as _,vb as ne,w as Le,wb as Tt,xb as $t,yb as Lt,yd as qe,zd as De}from"./chunk-XTHSYQMN.js";function wn(n,i){let r=st(n),e=st(i);return+r==+e}function Mn(n,i,r){let e=i.map(o=>({eventId:o,group:n})),t=r.map(o=>e.find(a=>a.eventId===o.eventId)||o);return[...new Set([...t,...e])].filter(o=>o.group!==null)}var Je=(()=>{let i=class i extends nn{};i.\u0275fac=(()=>{let e;return function(o){return(e||(e=yt(i)))(o||i)}})(),i.\u0275prov=R({token:i,factory:i.\u0275fac});let n=i;return n})();function kn(n,i){return[...n].sort(ei(i))}function ei(n){return(i,r)=>{switch(n.primarySortKey){case"name":{let e=i.name.localeCompare(r.name);return n.ascending?e*-1:e}case"group":{let e=(i.detail.Value||"").localeCompare(r.detail.Value||"");return n.ascending?e*-1:e}}}}function On(n,i){return n.map(r=>ti(r,i))}function ti(n,i){return{id:n.IdPerson,name:i.find(r=>r.StudentRef.Id===n.IdPerson)?.StudentFullName||"",group:n.Value,detail:n}}function Tn(n,i){return n.filter(r=>r.VssId===i.subscriptionDetailGroupId)}function lt(n,i){return n.find(r=>r.VssId===i.subscriptionDetailGroupId)}function ni(n,i){if(n&1){let r=M();c(0,"div",5)(1,"input",6),b("change",function(){let t=P(r).$implicit,o=u();return S(o.onSelectionChange(t))}),p(),c(2,"label",7),d(3),p()()}if(n&2){let r=i.$implicit,e=i.index,t=u();s(),z("id","group-",e,""),g("checked",r.id===t.selected.id)("value",r.id),s(),z("for","group-",e,""),s(),x(" ",r.label," ")}}var Be=function(n){return n.Select="select",n.Assign="assign",n}(Be||{}),$n=(()=>{let i=class i{constructor(e,t){this.activeModal=e,this.translate=t,this.groupOptions=[]}ngOnInit(){this.title=`presence-control.groups.${this.dialogMode}.title`;let e=this.createEmtpyOption();this.groupOptions=this.createGroupOptions(this.subscriptionDetailsDefinitions),this.groupOptions.unshift(e),this.selected=this.groupOptions.find(t=>t.id===this.group)||e}createEmtpyOption(){let e=this.dialogMode===Be.Select?"presence-control.groups.all":"presence-control.groups.none";return{id:null,label:this.translate.instant(e)}}createGroupOptions(e){return e.DropdownItems?e.DropdownItems.map(t=>({id:t.Key,label:`${this.translate.instant("presence-control.groups.group")} ${t.Value}`})):[]}getSelectedGroup(){return this.selected}onSelectionChange(e){this.selected=e}};i.\u0275fac=function(t){return new(t||i)(_(se),_(Q))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-group-dialog"]],inputs:{dialogMode:"dialogMode",subscriptionDetailsDefinitions:"subscriptionDetailsDefinitions",group:"group"},standalone:!0,features:[E],decls:13,vars:10,consts:[[1,"modal-body"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"form-check"],["type","radio","name","groups",1,"form-check-input",3,"change","id","checked","value"],[1,"form-check-label",3,"for"]],template:function(t,o){t&1&&(c(0,"div",0)(1,"p"),d(2),l(3,"translate"),p(),c(4,"form"),v(5,ni,4,7,"div",1),p()(),c(6,"div",2)(7,"button",3),b("click",function(){return o.activeModal.dismiss()}),d(8),l(9,"translate"),p(),c(10,"button",4),b("click",function(){return o.activeModal.close(o.getSelectedGroup())}),d(11),l(12,"translate"),p()()),t&2&&(s(2),x(" ",m(3,4,o.title)," "),s(3),g("ngForOf",o.groupOptions),s(3),x(" ",m(9,6,"presence-control.groups.cancel")," "),s(3),x(" ",m(12,8,"presence-control.groups.save")," "))},dependencies:[re,ye,ve,be,N,j,F]});let n=i;return n})();function Ln(n,i,r,e){return n.map(t=>{let o=i.find(a=>ii(a.presence,t));if(o){let a;return!o.newPresenceTypeId&&t.Comment?a=r.find(h=>h.IsComment)||null:a=r.find(h=>h.Id===o.newPresenceTypeId)||null,ge(ue({},t),{TypeRef:oi(a),Date:null,Type:a?a.Designation:null,ConfirmationStateId:Qe(a,e)})}return t})}function ii(n,i){return n.LessonRef.Id===i.LessonRef.Id&&n.StudentRef.Id===i.StudentRef.Id}function oi(n){return{Id:n?n.Id:null,HRef:null}}function Ye(n){return i=>i.reduce((r,e)=>r+(e.presenceCategory===n?1:0),0)}function En(){return n=>n.reduce((i,r)=>i+(r.precedingAbsences&&r.precedingAbsences.length>0?1:0),0)}var Dn=(()=>{let i=class i extends Ke{constructor(e,t){super(e,t,pt,"LessonTeachers")}loadOtherTeachersLessonAbsences(e,t,o){let a=`${this.baseUrl}/except/${e}/LessonAbsences?expand=LessonRef`;return t&&t.length>0&&(a=a.concat("&filter.StudentRef=;"+t.join(";"))),this.http.get(a,{params:o}).pipe(T(Qt(pt)))}};i.\u0275fac=function(t){return new(t||i)(y(Ne),y(H))},i.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var Ze=(()=>{let i=class i extends Ke{constructor(e,t){super(e,t,gn,"SubscriptionDetails")}getListForEvent(e){return this.getList({params:{IdEvent:String(e)}})}update(e,t){let o={IdPerson:t.IdPerson,EventId:t.EventId,Value:e};return this.http.put(`${this.baseUrl}/${t.Id}`,o).pipe(f(()=>{}))}};i.\u0275fac=function(t){return new(t||i)(y(Ne),y(H))},i.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();var Fn="presence-control-group",de=(()=>{let i=class i{constructor(e,t,o,a,h){this.userSettings=e,this.eventService=t,this.subscriptionDetailsService=o,this.loadingService=a,this.settings=h,this.selectGroup$=new $,this.selectedLesson$=new Te,this.lessonPresences$=new Te,this.reloadSubscriptionDetails$=new $,this.defaultGroup=null,this.savedGroup$=this.selectedLesson$.pipe(T(C=>this.userSettings.getPresenceControlGroupView().pipe(f(k=>this.findGroupByLesson(k,C))))),this.group$=X(this.selectGroup$,this.savedGroup$).pipe(Ae(this.defaultGroup),B(1)),this.loading$=this.loadingService.loading(Fn),this.subscriptionDetailsDefinitions$=this.selectedLesson$.pipe(f(C=>C?.getEventIds()||[]),T(C=>$e(C.map(k=>this.eventService.getSubscriptionDetailsDefinitions(k)))),B(1)),this.groupsAvailability$=this.subscriptionDetailsDefinitions$.pipe(f(C=>C.every(k=>lt(k,this.settings))),B(1)),this.subscriptionDetails$=O([this.selectedLesson$,this.groupsAvailability$,this.reloadSubscriptionDetails$.pipe(f(()=>!1),Ae(!0))]).pipe(T(([C,k,V])=>C&&k?this.loadSubscriptionDetailsForLesson(C,V):J([])),f(C=>Tn(C,this.settings)),B(1)),this.subscriptionDetailPersonIds$=O([this.group$,this.subscriptionDetails$]).pipe(f(([C,k])=>k.filter(V=>V.Value===C).map(V=>V.IdPerson)),Ae([]))}selectGroup(e){this.selectGroup$.next(e)}setSelectedLesson(e){this.selectedLesson$.next(e)}setLessonPresences(e){this.lessonPresences$.next(e)}getSubscriptionDetailsDefinitions(){return this.subscriptionDetailsDefinitions$.pipe(f(rt),f(e=>lt(e,this.settings)))}getSubscriptionDetailsForStudents(){return O([this.subscriptionDetails$,this.lessonPresences$]).pipe(f(ae(On)))}reloadSubscriptionDetails(){this.reloadSubscriptionDetails$.next(void 0)}loadSubscriptionDetailsForLesson(e,t=!0){return this.loadingService.load($e(De(e.getEventIds()).map(o=>this.subscriptionDetailsService.getListForEvent(o))),t?void 0:Fn).pipe(f(rt))}findGroupByLesson(e,t){return e.find(a=>a.eventId===t?.getEventIds()[0])?.group||this.defaultGroup}};i.\u0275fac=function(t){return new(t||i)(y(we),y(yn),y(Ze),y(pe),y(H))},i.\u0275prov=R({token:i,factory:i.\u0275fac});let n=i;return n})();var An=Object.values(me),G=(()=>{let i=class i{constructor(e,t,o,a,h,C,k,V,Me,ke){this.userSettings=e,this.lessonPresencesService=t,this.lessonTeacherService=o,this.presenceTypesService=a,this.groupService=h,this.dropDownItemsService=C,this.loadingService=k,this.storageService=V,this.settings=Me,this.location=ke,this.selectedDateSubject$=new fe(new Date),this.selectedDate$=this.selectedDateSubject$.asObservable().pipe(f(Xt),Ve(qe)),this.viewModeSubject$=new $,this.viewMode$=X(this.viewModeSubject$,this.userSettings.getPresenceControlViewMode().pipe(D(1))),this.lessons$=this.selectedDate$.pipe(T(I=>this.loadLessonsByDate(I)),B(1)),this.selectLessonId$=new $,this.selectLesson$=this.selectLessonId$.pipe(T(I=>this.getLessonById(I))),this.selectedLesson$=O([ln(this.selectLesson$.pipe(Ve((I,Oe)=>qe(I,Oe))),dn(this.settings.lessonPresencesRefreshTime)),this.lessons$]).pipe(f(([I,Oe])=>Oe.find(Yn=>Yn.id===I.id)?I:null),B(1)),this.studyClassCount$=this.selectedLesson$.pipe(f(I=>I?.lessons.length||0)),this.updateLessonPresences$=new $,this.reloadLessonPresences$=new $,this.lessonPresences$=X(mn(this.selectedLesson$,this.reloadLessonPresences$).pipe(T(I=>I?this.loadLessonPresencesByLesson(I):J([]))),this.updateLessonPresences$).pipe(B(1)),this.presenceTypes$=this.loadPresenceTypes().pipe(B(1)),this.reloadStudentIdsWithUnconfirmedAbsences$=new $,this.studentIdsWithUnconfirmedAbsences$=X(this.selectedDate$,this.selectedLesson$.pipe(it(1)),this.reloadStudentIdsWithUnconfirmedAbsences$).pipe(T(()=>this.loadStudentIdsWithUnconfirmedAbsences()),B(1)),this.loading$=this.loadingService.loading$,this.absenceConfirmationStates$=this.dropDownItemsService.getAbsenceConfirmationStates().pipe(B(1)),this.studentIds$=this.lessonPresences$.pipe(f(I=>De(I.map(Oe=>Oe.StudentRef.Id))),B(1)),this.otherTeachersAbsences$=this.studentIds$.pipe(Ve(qe),T(I=>I.length>0?this.lessonTeacherService.loadOtherTeachersLessonAbsences(this.getMyself(),I):J([])),B(1)),this.groupsAvailability$=this.groupService.groupsAvailability$,this.presenceControlEntries$=O([this.selectedLesson$,this.lessonPresences$,this.presenceTypes$,this.absenceConfirmationStates$,this.otherTeachersAbsences$]).pipe(f(ae(en))),this.presenceControlEntriesByGroup$=O([this.groupService.group$,this.presenceControlEntries$,this.groupService.subscriptionDetailPersonIds$]).pipe(f(ae(bn)),B(1)),this.presentCount$=this.presenceControlEntriesByGroup$.pipe(f(Ye("present"))),this.absentCount$=this.presenceControlEntriesByGroup$.pipe(f(Ye("absent"))),this.unapprovedCount$=this.presenceControlEntriesByGroup$.pipe(f(Ye("unapproved"))),this.absentPrecedingCount$=this.presenceControlEntriesByGroup$.pipe(f(En())),this.queryParamsString$=O([this.selectedDate$,this.selectedLesson$,this.viewMode$]).pipe(f(ae(this.buildQueryParams.bind(this))),f(pn)),this.destroy$=new $,this.queryParamsString$.pipe(q(this.destroy$)).subscribe(I=>{this.location.replaceState("/presence-control",I),this.confirmBackLinkParams={returnparams:I}}),this.viewMode$.pipe(it(1),T(I=>this.userSettings.savePresenceControlViewMode(I)),q(this.destroy$)).subscribe(),this.selectedLesson$.pipe(q(this.destroy$)).subscribe(I=>{this.groupService.setSelectedLesson(I)}),this.lessonPresences$.pipe(q(this.destroy$)).subscribe(I=>this.groupService.setLessonPresences(I))}ngOnDestroy(){this.destroy$.next()}setDate(e){this.selectedDateSubject$.next(e)}setLessonId(e){this.selectLessonId$.next(e)}setViewMode(e){this.viewModeSubject$.next(e)}updateLessonPresencesTypes(e){O([this.lessonPresences$.pipe(D(1)),this.presenceTypes$.pipe(D(1))]).pipe(f(([t,o])=>Ln(t,e,o,this.settings))).subscribe(t=>this.updateLessonPresences$.next(t))}getNextPresenceType(e){return this.presenceTypes$.pipe(D(1),f(t=>e.getNextPresenceType(t)))}hasUnconfirmedAbsences(e){return this.studentIdsWithUnconfirmedAbsences$.pipe(f(t=>t.includes(e.lessonPresence.StudentRef.Id)))}updateAfterConfirm(){this.reloadLessonPresences$.next(),this.reloadStudentIdsWithUnconfirmedAbsences$.next()}loadLessonPresencesByLesson(e){return this.loadingService.load(this.lessonPresencesService.getListByLessons(e.lessons))}loadLessonsByDate(e){return this.loadingService.load(this.lessonPresencesService.getLessonsByDate(e)).pipe(f(Cn))}loadPresenceTypes(){return this.loadingService.load(this.presenceTypesService.presenceTypes$)}loadStudentIdsWithUnconfirmedAbsences(){return ft(0,this.settings.unconfirmedAbsencesRefreshTime||-1).pipe(T(()=>this.lessonPresencesService.getListOfUnconfirmed()),f(e=>De(e.map(t=>t.StudentRef.Id))))}buildQueryParams(e,t,o){let a={date:Yt(e,"yyyy-MM-dd"),viewMode:o};return t&&(a.lesson=String(t.id)),a}getLessonById(e){let t=String(e);return this.lessons$.pipe(f(o=>t&&o.find(a=>a.id===t)||vn(o)),Le(Boolean))}getMyself(){let e=this.storageService.getPayload();return Number(e?.holder_id||e?.id_person)}};i.\u0275fac=function(t){return new(t||i)(y(we),y(ze),y(Dn),y(Se),y(de),y(rn),y(pe),y(Kt),y(H),y(Et))},i.\u0275prov=R({token:i,factory:i.\u0275fac});let n=i;return n})();var pi=(n,i,r,e)=>({sortCriteria:n,sortedEntries:i,selection:r,group:e}),li=()=>["/presence-control"];function di(n,i){if(n&1){let r=M();c(0,"div",14),b("click",function(){let t=P(r).$implicit,o=u(2);return S(o.toggleSort(t))}),d(1),l(2,"translate"),c(3,"span",15),d(4),p()()}if(n&2){let r=i.$implicit,e=u().bkdLet,t=u();g("className",r),s(),x(" ",m(2,3,"presence-control.groups.list.header."+r)," "),s(3),w(t.getSortDirectionCharacter(e.sortCriteria,r))}}function mi(n,i){n&1&&W(0,"bkd-spinner",23)}function ui(n,i){if(n&1){let r=M();Z(0),c(1,"div",17)(2,"div",18)(3,"input",19,1),l(5,"async"),b("change",function(){let t=P(r).$implicit,o=u(3);return S(o.selectionService.toggle(t))}),p()(),c(6,"div",20),d(7),p(),c(8,"div",21)(9,"span"),d(10),p(),v(11,mi,1,0,"bkd-spinner",22),l(12,"async"),p()(),ee()}if(n&2){let r=i.$implicit,e=u(3);s(3),g("checked",m(5,4,e.selectionService.isSelected$(r))),s(4),x(" ",r.name," "),s(3),w(r.group?r.group:""),s(),g("ngIf",m(12,6,e.groupService.loading$))}}function gi(n,i){if(n&1&&(Z(0),v(1,ui,13,8,"ng-container",16),ee()),n&2){let r=u().bkdLet;s(),g("ngForOf",r.sortedEntries)}}function fi(n,i){n&1&&W(0,"bkd-spinner")}function hi(n,i){if(n&1){let r=M();c(0,"div"),W(1,"bkd-backlink",3),l(2,"async"),c(3,"h1"),d(4),l(5,"translate"),p(),c(6,"div",4)(7,"div",5)(8,"span",6),d(9),l(10,"translate"),p(),c(11,"button",7),b("click",function(){P(r);let t=u();return S(t.selectGroup())}),d(12),l(13,"translate"),l(14,"translate"),p()(),c(15,"a",8),b("click",function(){P(r);let t=u();return S(t.assignGroup())}),c(16,"i",9),d(17,"edit"),p()()(),c(18,"div",10)(19,"div",11),v(20,di,5,5,"div",12),p(),v(21,gi,2,1,"ng-container",13),l(22,"async"),v(23,fi,1,0,"ng-template",null,0,_e),p()()}if(n&2){let r=i.bkdLet,e=te(24),t=u();s(),g("link",Ot(22,li))("params",m(2,10,t.backlinkQueryParams$)),s(3),w(m(5,12,"presence-control.groups.title")),s(5),w(m(10,14,"presence-control.groups.show")),s(3),x(" ",r.group?m(13,16,"presence-control.groups.group")+" "+r.group:m(14,18,"presence-control.groups.all")," "),s(3),K("disabled",r.selection.length===0),s(5),g("ngForOf",t.primarySortKeys),s(),g("ngIf",m(22,20,t.state.loading$)===!1)("ngIfElse",e)}}var Gn=(()=>{let i=class i{constructor(e,t,o,a,h,C,k,V,Me){this.route=e,this.state=t,this.selectionService=o,this.groupService=a,this.userSettings=h,this.subscriptionDetailService=C,this.toastService=k,this.translate=V,this.modalService=Me,this.primarySortKeys=["name","group"],this.backlinkQueryParams$=this.route.queryParams.pipe(f(({returnparams:ke})=>ke),f(an)),this.eventIds$=this.state.selectedLesson$.pipe(f(ke=>ke?.getEventIds()||[])),this.sortCriteriaSubject$=new fe({primarySortKey:"name",ascending:!1}),this.sortCriteria$=this.sortCriteriaSubject$.asObservable(),this.sortedEntries$=O([this.groupService.getSubscriptionDetailsForStudents(),this.sortCriteria$]).pipe(f(ae(kn))),this.selected=[]}ngOnInit(){this.selectionService.selection$.subscribe(e=>this.selected=e)}selectGroup(){this.openGroupModal(Be.Select,this.selectCallback.bind(this))}assignGroup(){this.openGroupModal(Be.Assign,this.assignCallback.bind(this))}openGroupModal(e,t){O([this.groupService.getSubscriptionDetailsDefinitions(),this.groupService.group$]).pipe(D(1)).subscribe(([o,a])=>{let h=this.modalService.open($n);h.componentInstance.dialogMode=e,h.componentInstance.subscriptionDetailsDefinitions=o,h.componentInstance.group=a,h.result.then(C=>{t(C)},()=>{})})}selectCallback(e){O([this.eventIds$,this.userSettings.getPresenceControlGroupView()]).pipe(D(1),T(([t,o])=>this.userSettings.savePresenceControlGroupView(Mn(e.id,t,o))),f(()=>e.id)).subscribe(t=>this.groupService.selectGroup(t))}assignCallback(e){$e(this.selected.map(t=>this.subscriptionDetailService.update(e.id,t.detail))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.groupService.reloadSubscriptionDetails(),this.selectionService.clear(),this.toastService.success(this.translate.instant("presence-control.groups.notifications.save-success"))}getSortDirectionCharacter(e,t){return e.primarySortKey!==t?"":e.ascending?"\u2193":"\u2191"}toggleSort(e){this.sortCriteriaSubject$.pipe(D(1)).subscribe(t=>{t.primarySortKey===e?this.sortCriteriaSubject$.next({primarySortKey:e,ascending:!t.ascending}):this.sortCriteriaSubject$.next({primarySortKey:e,ascending:e==="name"})})}};i.\u0275fac=function(t){return new(t||i)(_(Ge),_(G),_(Je),_(de),_(we),_(Ze),_(Pe),_(Q),_(Ie))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-group"]],standalone:!0,features:[he([Je]),E],decls:5,vars:14,consts:[["loading",""],["checkbox",""],[4,"bkdLet"],[3,"link","params"],[1,"group-header","mb-2","d-flex","justify-content-between"],[1,"d-flex","align-items-baseline"],[1,"ps-3"],["type","button",1,"show","btn","btn-link",3,"click"],["aria-label","edit",1,"btn","btn-primary","btn-icon","me-2",3,"click"],[1,"material-icons"],[1,"group-list"],[1,"group-list-header"],[3,"className","click",4,"ngFor","ngForOf"],[4,"ngIf","ngIfElse"],[3,"click","className"],[1,"sort-direction"],[4,"ngFor","ngForOf"],[1,"group-list-entry"],[1,"checkbox"],["type","checkbox",1,"form-check-input",3,"change","checked"],[1,"name","pe-2"],[1,"group","d-flex","justify-content-between"],["class","inline small",4,"ngIf"],[1,"inline","small"]],template:function(t,o){t&1&&(v(0,hi,25,23,"div",2),l(1,"async"),l(2,"async"),l(3,"async"),l(4,"async")),t&2&&g("bkdLet",Lt(9,pi,m(1,1,o.sortCriteria$),m(2,3,o.sortedEntries$),m(3,5,o.selectionService.selection$),m(4,7,o.groupService.group$)))},dependencies:[ce,hn,N,ie,xe,oe,j,F],styles:['[_nghost-%COMP%]{display:block}.group-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{color:#000;font-weight:300;text-decoration:underline;padding-left:.5rem}.group-header[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{text-decoration-color:#ea161f}.group-list-header[_ngcontent-%COMP%]{cursor:pointer;padding:1rem;display:grid;grid-template-areas:"name group";grid-template-columns:3fr 2fr;border-top:1px solid #dee2e6;border-bottom:2px solid #dee2e6}.group-list-entry[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #dee2e6;display:grid;grid-template-areas:"checkbox name group";grid-template-columns:min-content 3fr 2fr}.checkbox[_ngcontent-%COMP%]{grid-area:checkbox;margin:0;padding:.3rem 1rem 0 0}.checkbox[_ngcontent-%COMP%]   input.form-check-input[_ngcontent-%COMP%]{position:static!important;margin:0!important;display:block}.name[_ngcontent-%COMP%]{grid-area:name;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.group[_ngcontent-%COMP%]{grid-area:group}@media (max-width: 750px){.group-list[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.group-list-header[_ngcontent-%COMP%]{grid-template-columns:3fr 1fr}.group-list-entry[_ngcontent-%COMP%]{grid-template-columns:min-content 3fr 1fr}}'],changeDetection:0});let n=i;return n})();function _i(n,i){if(n&1){let r=M();c(0,"div",3)(1,"input",4),b("change",function(){let t=P(r).$implicit;return S(t.selected=!t.selected)}),p(),c(2,"label",5)(3,"i"),d(4),p(),c(5,"div",6),d(6),l(7,"date"),l(8,"date"),p()()()}if(n&2){let r=i.$implicit,e=i.index,t=u();s(),z("id","lesson-presence-",e,""),g("checked",r.selected),s(),K("fw-bold",t.isCurrentLesson(r)),z("for","lesson-presence-",e,""),s(),Re("",r.entry.presenceCategory," material-icons pe-2"),s(),w(r.entry.presenceCategoryIcon),s(2),Mt(" ",U(7,14,r.entry.lessonPresence.LessonDateTimeFrom,"HH:mm"),"\u2013",U(8,17,r.entry.lessonPresence.LessonDateTimeTo,"HH:mm")," ",r.entry.lessonPresence.EventDesignation," ")}}function Ci(n,i){if(n&1){let r=M();c(0,"div",7)(1,"button",8),b("click",function(){P(r);let t=u();return S(t.activeModal.close())}),d(2),l(3,"translate"),p(),c(4,"button",9),b("click",function(){let t=P(r).bkdLet,o=u();return S(o.activeModal.close(t))}),d(5),l(6,"translate"),p()()}if(n&2){let r=i.bkdLet;s(2),x(" ",m(3,3,"presence-control.block-lesson.cancel")," "),s(2),g("disabled",r.length===0),s(),x(" ",m(6,5,"presence-control.block-lesson.save")," ")}}var Un=(()=>{let i=class i{constructor(e){this.activeModal=e,this.blockLessonOptions=[]}ngOnInit(){this.blockLessonOptions=this.buildLessonPresenceOptions()}getSelectedEntries(){return this.blockLessonOptions.filter(({selected:e})=>e).map(({entry:e})=>e)}isCurrentLesson(e){return wn(e.entry.lessonPresence.LessonDateTimeFrom,this.entry.lessonPresence.LessonDateTimeFrom)}buildLessonPresenceOptions(){return this.blockPresenceControlEntries.map(e=>({entry:e,selected:this.entry.confirmationState===e.confirmationState}))}};i.\u0275fac=function(t){return new(t||i)(_(se))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-block-lesson-component"]],inputs:{entry:"entry",blockPresenceControlEntries:"blockPresenceControlEntries"},standalone:!0,features:[E],decls:7,vars:5,consts:[[1,"modal-body"],["class","form-check",4,"ngFor","ngForOf"],["class","modal-footer",4,"bkdLet"],[1,"form-check"],["type","checkbox",1,"form-check-input",3,"change","id","checked"],[1,"form-check-label","d-flex",3,"for"],[1,"d-block","text-truncate"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click","disabled"]],template:function(t,o){t&1&&(c(0,"div",0)(1,"p"),d(2),l(3,"translate"),p(),c(4,"form"),v(5,_i,9,20,"div",1),p()(),v(6,Ci,7,7,"div",2)),t&2&&(s(2),x(" ",m(3,3,"presence-control.block-lesson.text")," "),s(3),g("ngForOf",o.blockLessonOptions),s(),g("bkdLet",o.getSelectedEntries()))},dependencies:[re,ye,ve,be,N,ce,Ce,j,F],styles:[".checkbox[_ngcontent-%COMP%]   input.form-check-input[_ngcontent-%COMP%]{position:static!important;margin:0!important;display:block}.absent[_ngcontent-%COMP%]{color:#ea161f}.present[_ngcontent-%COMP%]{color:#3d8608}.unapproved[_ngcontent-%COMP%]{color:#ffa814}"]});let n=i;return n})();var vi=30;function gt(n){return`blockLesson${n.lessonPresence.Id}`}var et=(()=>{let i=class i{constructor(e,t,o,a){this.state=e,this.lessonPresencesService=t,this.loadingService=o,this.settings=a}getBlockLessonPresenceControlEntries(e){return O([this.state.lessons$.pipe(D(1)),this.loadChangeableLessonPresences(e),this.state.presenceTypes$.pipe(D(1)),this.state.absenceConfirmationStates$.pipe(D(1)),this.state.otherTeachersAbsences$.pipe(D(1))]).pipe(f(([t,o,a,h,C])=>this.filterBlockLessonPresences(e,o).map(k=>tn(t.find(V=>V.id===k.LessonRef.Id.toString()),k,a,h,C))))}filterBlockLessonPresences(e,t){return[...t].sort((o,a)=>o.LessonDateTimeFrom>a.LessonDateTimeFrom?1:-1).reduce((o,a)=>{let h=o[o.length-1];return this.isWithinBlockTime(a,h)?(o.push(a),o):o.find(C=>C.Id===e.lessonPresence.Id)?o:[a]},[])}isWithinBlockTime(e,t){return t?e.LessonDateTimeFrom.getTime()-t.LessonDateTimeTo.getTime()<=vi*60*1e3:!0}loadChangeableLessonPresences(e){return O([this.loadLessonPresences(e),this.state.presenceTypes$.pipe(D(1))]).pipe(f(([t,o])=>t.filter(a=>Zt(a,o.find(h=>h.Id===a.TypeRef.Id)||null,this.settings))))}loadLessonPresences(e){return this.loadingService.load(this.lessonPresencesService.getListByDateStudentClass(e.lessonPresence.LessonDateTimeFrom,e.lessonPresence.StudentRef.Id,e.lessonPresence.StudyClassRef.Id??void 0).pipe(f(t=>t.filter(o=>o.TeacherInformation===e.lessonPresence.TeacherInformation))),gt(e))}};i.\u0275fac=function(t){return new(t||i)(y(G),y(ze),y(pe),y(H))},i.\u0275prov=R({token:i,factory:i.\u0275fac});let n=i;return n})();function yi(n,i){if(n&1&&(c(0,"div"),d(1),l(2,"date"),l(3,"date"),l(4,"addSpace"),p()),n&2){let r=i.$implicit;s(),kt(" ",U(2,5,r.LessonRef.From,"HH:mm"),"\u2013",U(3,8,r.LessonRef.To,"HH:mm")," ",r.LessonRef.EventDesignation,"",U(4,11,":",":")," ",r.Type," ")}}var Hn=(()=>{let i=class i{constructor(e){this.activeModal=e}};i.\u0275fac=function(t){return new(t||i)(_(se))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-preceding-absence"]],inputs:{precedingAbsences:"precedingAbsences"},standalone:!0,features:[E],decls:9,vars:7,consts:[[1,"modal-body"],[4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"]],template:function(t,o){t&1&&(c(0,"div",0)(1,"p"),d(2),l(3,"translate"),p(),v(4,yi,5,14,"div",1),p(),c(5,"div",2)(6,"button",3),b("click",function(){return o.activeModal.dismiss()}),d(7),l(8,"translate"),p()()),t&2&&(s(2),x(" ",m(3,3,"presence-control.preceding-absence.text")," "),s(2),g("ngForOf",o.precedingAbsences),s(3),x(" ",m(8,5,"presence-control.preceding-absence.cancel")," "))},dependencies:[N,Ce,j,F,un]});let n=i;return n})();var Pi=n=>["student",n,"absences"],Si=n=>["/presence-control/student",n,"absences"];function xi(n,i){if(n&1&&(W(0,"bkd-avatar",9),l(1,"async")),n&2){let r=u();g("studentId",m(1,3,r.studentId$))("link",ne(5,Si,r.entry.lessonPresence.StudentRef.Id.toString()))("linkParams",r.profileReturnParams)}}function Ii(n,i){if(n&1&&(c(0,"span"),d(1),p()),n&2){let r=u(2);s(),w(r.entry.presenceType==null?null:r.entry.presenceType.Designation)}}function wi(n,i){if(n&1){let r=M();c(0,"button",10),b("click",function(){P(r);let t=u();return S(t.updatePresenceType(t.entry))}),v(1,Ii,2,1,"span",11),p()}if(n&2){let r=u();s(),g("ngIf",!(r.entry.presenceType!=null&&r.entry.presenceType.IsIncident))}}function Mi(n,i){n&1&&W(0,"bkd-spinner",16)}function ki(n,i){if(n&1){let r=M();c(0,"button",12),b("click",function(){P(r);let t=u();return S(t.updatePresenceType(t.entry))}),c(1,"div",13)(2,"i",14),d(3),p(),v(4,Mi,1,0,"bkd-spinner",15),p()()}if(n&2){let r=i.bkdLet,e=u();g("disabled",r),s(2),K("invisible",r),s(),w(e.entry.presenceCategoryIcon),s(),g("ngIf",r)}}function Oi(n,i){if(n&1){let r=M();c(0,"button",17),b("click",function(){P(r);let t=u();return S(t.showPrecedingAbsences(t.entry))}),c(1,"i",18),d(2,"info"),p()()}}function Ti(n,i){if(n&1&&(c(0,"span",19),d(1),p()),n&2){let r=u();s(),x(" ",r.entry.lessonPresence.StudyClassNumber," ")}}function $i(n,i){if(n&1){let r=M();c(0,"a",20),b("click",function(){P(r);let t=u();return S(t.updateIncident(t.entry))}),c(1,"i",14),d(2,"edit"),p(),c(3,"span"),d(4),l(5,"translate"),p()()}if(n&2){let r=u();s(4),w(m(5,1,(r.entry.presenceType==null?null:r.entry.presenceType.IsIncident)&&(r.entry.presenceType==null?null:r.entry.presenceType.Designation)||"presence-control.entry.incident"))}}var qn=(()=>{let i=class i{get classNames(){return[this.entry.presenceCategory,this.viewMode].join(" ")}constructor(e,t,o,a){this.toastService=e,this.translate=t,this.modalService=o,this.loadingService=a,this.hasUnconfirmedAbsences=!1,this.showClassName=!1,this.togglePresenceType=new Y,this.changeIncident=new Y,this.entry$=new Te(1),this.studentId$=this.entry$.pipe(f(({lessonPresence:h})=>h.StudentRef.Id)),this.loading$=this.entry$.pipe(T(h=>this.loadingService.loading(gt(h))))}ngOnChanges(e){e.entry&&this.entry$.next(e.entry.currentValue)}get isListViewMode(){return this.viewMode===me.List}updatePresenceType(e){e.canChangePresenceType?this.togglePresenceType.emit(e):this.toastService.warning(this.translate.instant("presence-control.entry.update-warning"))}updateIncident(e){e.canChangeIncident&&this.changeIncident.emit(e)}showPrecedingAbsences(e){let t=this.modalService.open(Hn);t.componentInstance.precedingAbsences=e.precedingAbsences}};i.\u0275fac=function(t){return new(t||i)(_(Pe),_(Q),_(Ie),_(pe))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-entry"]],hostVars:2,hostBindings:function(t,o){t&2&&Pt(o.classNames)},inputs:{entry:"entry",hasUnconfirmedAbsences:"hasUnconfirmedAbsences",viewMode:"viewMode",showClassName:"showClassName",profileReturnParams:"profileReturnParams"},outputs:{togglePresenceType:"togglePresenceType",changeIncident:"changeIncident"},standalone:!0,features:[bt,E],decls:13,vars:16,consts:[["class","avatar large",3,"studentId","link","linkParams",4,"ngIf"],["type","button","class","presence-category designation btn btn-link",3,"click",4,"ngIf"],["type","button","class","presence-category status btn btn-link",3,"disabled","click",4,"bkdLet"],["type","button","class","previously-absent d-flex btn btn-link",3,"click",4,"ngIf"],[1,"student-info",3,"routerLink","queryParams"],[1,"student-name","text-truncate"],["class","study-class text-truncate",4,"ngIf"],[1,"unconfirmed-absences"],["class","incident btn btn-link",3,"click",4,"ngIf"],[1,"avatar","large",3,"studentId","link","linkParams"],["type","button",1,"presence-category","designation","btn","btn-link",3,"click"],[4,"ngIf"],["type","button",1,"presence-category","status","btn","btn-link",3,"click","disabled"],[1,"position-relative"],[1,"material-icons"],["class","inline small",4,"ngIf"],[1,"inline","small"],["type","button",1,"previously-absent","d-flex","btn","btn-link",3,"click"],[1,"material-icons-outlined"],[1,"study-class","text-truncate"],[1,"incident","btn","btn-link",3,"click"]],template:function(t,o){t&1&&(v(0,xi,2,7,"bkd-avatar",0)(1,wi,2,1,"button",1)(2,ki,5,5,"button",2),l(3,"async"),v(4,Oi,3,0,"button",3),c(5,"a",4)(6,"span",5),d(7),p(),v(8,Ti,2,1,"span",6),c(9,"span",7),d(10),l(11,"translate"),p()(),v(12,$i,6,3,"a",8)),t&2&&(g("ngIf",!o.isListViewMode),s(),g("ngIf",o.entry.showDesignation),s(),g("bkdLet",m(3,10,o.loading$)),s(2),g("ngIf",(o.entry.precedingAbsences==null?null:o.entry.precedingAbsences.length)||!1),s(),g("routerLink",ne(14,Pi,o.entry.lessonPresence.StudentRef.Id))("queryParams",o.profileReturnParams),s(2),w(o.entry.lessonPresence.StudentFullName),s(),g("ngIf",o.isListViewMode&&o.showClassName),s(2),x(" ",o.hasUnconfirmedAbsences?m(11,12,"presence-control.entry.unconfirmed-absences"):""," "),s(2),g("ngIf",o.entry.canChangeIncident))},dependencies:[ie,fn,ce,xe,Ue,oe,j,F],styles:['[_nghost-%COMP%]{padding:2rem 1rem;background-color:#fff;display:grid;grid-template-areas:"avatar status designation previously-absent" "avatar student-info student-info student-info" "avatar incident incident incident";grid-template-columns:min-content min-content 3fr min-content}[_nghost-%COMP%] > *[_ngcontent-%COMP%]{align-self:center}.presence-category[_ngcontent-%COMP%]{text-decoration:none}.presence-category[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{top:.1875rem}.absent[_nghost-%COMP%]   .presence-category[_ngcontent-%COMP%]{color:#ea161f}.present[_nghost-%COMP%]   .presence-category[_ngcontent-%COMP%]{color:#3d8608}.unapproved[_nghost-%COMP%]   .presence-category[_ngcontent-%COMP%]{color:#ffa814}.presence-category[_ngcontent-%COMP%]   bkd-spinner[_ngcontent-%COMP%]{color:#000;position:absolute;top:4px;left:5px}.designation[_ngcontent-%COMP%], .student-info[_ngcontent-%COMP%], a.incident[_ngcontent-%COMP%], .incident[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.avatar[_ngcontent-%COMP%]{grid-area:avatar;margin-right:1.5rem}.status[_ngcontent-%COMP%]{grid-area:status}.status[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{font-size:2rem}.designation[_ngcontent-%COMP%]{grid-area:designation;text-align:left;line-height:2.375rem}.previously-absent[_ngcontent-%COMP%]{grid-area:previously-absent;text-decoration:none;color:#00000080;justify-self:end}.student-info[_ngcontent-%COMP%]{grid-area:student-info;display:flex;flex-direction:column;text-decoration:none}.student-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{text-decoration:underline}.student-info[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child:hover{text-decoration-color:#ea161f}.unconfirmed-absences[_ngcontent-%COMP%]{color:#ea161f;font-size:.875rem;line-height:1}.study-class[_ngcontent-%COMP%]{font-size:.875rem;line-height:1}.incident[_ngcontent-%COMP%]{color:#00000080;padding-right:1.5rem;grid-area:incident;display:flex;text-decoration:none}.incident[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.incident[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{text-decoration-color:#ea161f}.incident[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{margin-right:.3em}.grid[_nghost-%COMP%]   .status[_ngcontent-%COMP%], .grid[_nghost-%COMP%]   .designation[_ngcontent-%COMP%]{align-self:start;margin-left:-1.5rem;margin-top:-.375rem}.grid[_nghost-%COMP%]   .incident[_ngcontent-%COMP%]{align-self:end;margin-left:-1.5rem;margin-bottom:-.375rem}.grid[_nghost-%COMP%]   .previously-absent[_ngcontent-%COMP%]{padding-right:0;align-self:start}.grid[_nghost-%COMP%]   .unconfirmed-absences[_ngcontent-%COMP%]{height:.875rem}.list[_nghost-%COMP%]{grid-template-areas:"student-info status incidentordesignation previously-absent";grid-template-columns:3fr min-content 4fr 3em;padding:.5rem 1rem}.list[_nghost-%COMP%]   .status[_ngcontent-%COMP%]{justify-self:start}.list[_nghost-%COMP%]   .student-name[_ngcontent-%COMP%]{line-height:1;margin-bottom:.5rem}.list[_nghost-%COMP%]   .incident[_ngcontent-%COMP%], .list[_nghost-%COMP%]   .designation[_ngcontent-%COMP%]{grid-area:incidentordesignation}.list[_nghost-%COMP%]   .previously-absent[_ngcontent-%COMP%]{padding-right:0}@media (max-width: 750px){.list[_nghost-%COMP%]{grid-template-areas:"student-info student-info student-info previously-absent" "status incidentordesignation incidentordesignation incidentordesignation";grid-template-columns:min-content 1fr 1fr min-content;row-gap:1rem}.list[_nghost-%COMP%]   .status[_ngcontent-%COMP%]{padding-left:0;padding-right:0}.list[_nghost-%COMP%]   .student-name[_ngcontent-%COMP%]{margin-top:.5rem}.list[_nghost-%COMP%]   .previously-absent[_ngcontent-%COMP%]{align-self:start}}']});let n=i;return n})();var Li=(n,i)=>({"btn-link":n,"btn-danger":i}),Ei=n=>["groups",n],Di=n=>({returnparams:n});function Bi(n,i){if(n&1){let r=M();c(0,"div",22),b("click",function(){P(r);let t=u();return S(t.lessonDropdown==null?null:t.lessonDropdown.toggle())}),d(1),l(2,"date"),c(3,"span",23),d(4),l(5,"date"),p()()}if(n&2){let r=u();s(),x(" ",U(2,2,r.selectedLesson.LessonDateTimeFrom,"HH:mm"),"\u2013"),s(3),w(U(5,5,r.selectedLesson.LessonDateTimeTo,"HH:mm"))}}function Fi(n,i){if(n&1){let r=M();c(0,"div",29),b("click",function(){let t=P(r).$implicit,o=u(2);return S(o.selectLessonChange.emit(t))}),c(1,"div",30)(2,"div"),d(3),l(4,"date"),l(5,"date"),p(),c(6,"div",26),d(7),p(),c(8,"div",26),d(9),p()()()}if(n&2){let r=i.$implicit,e=u(2);K("active",r.id===e.selectedLesson.id),s(3),wt(" ",U(4,6,r.LessonDateTimeFrom,"HH:mm"),"\u2013",U(5,9,r.LessonDateTimeTo,"HH:mm")," "),s(4),w(r.eventDesignations),s(2),w(r.studyClassNumbers)}}function ji(n,i){if(n&1&&(c(0,"div",24)(1,"div",25)(2,"div",26),d(3),p(),c(4,"div",26),d(5),p()(),c(6,"div",27),v(7,Fi,10,12,"div",28),p()()),n&2){let r=u();s(3),w(r.selectedLesson.eventDesignations),s(2),w(r.selectedLesson.studyClassNumbers),s(2),g("ngForOf",r.lessons)}}function Vi(n,i){if(n&1){let r=M();c(0,"bkd-caret",31),b("click",function(){P(r);let t=u();return S(t.lessonDropdown==null?null:t.lessonDropdown.toggle())}),p()}if(n&2){let r=u();g("expanded",(r.lessonDropdown==null?null:r.lessonDropdown.isOpen())||!1)}}function Ai(n,i){if(n&1&&(c(0,"a",32),l(1,"async"),l(2,"async"),l(3,"async"),c(4,"i",33),d(5,"groups"),p()()),n&2){let r=u();g("ngClass",Tt(9,Li,m(1,3,r.isGroupSelected$)===!1,m(2,5,r.isGroupSelected$)))("routerLink",ne(12,Ei,r.selectedLesson.id))("queryParams",ne(14,Di,m(3,7,r.state.queryParamsString$)))}}function Ri(n,i){if(n&1){let r=M();c(0,"button",34),b("click",function(){let t=P(r).$implicit,o=u();return S(o.viewModeChange.emit(t.viewMode))}),c(1,"i",33),d(2),p()()}if(n&2){let r=i.$implicit,e=u();K("btn-outline-secondary",r.viewMode===e.viewMode)("btn-link",r.viewMode!==e.viewMode)("active",r.viewMode===e.viewMode),g("disabled",!e.selectedLesson),s(2),w(r.icon)}}var Ni=Ee.prototype._positionMenu;Ee.prototype._positionMenu=function(...i){let r=Ni.apply(this,i);if(this._anchor.nativeElement.id==="lesson-dropdown"){let e=this._bodyContainer||this._menu.nativeElement,t=e.style.transform?.match(/translate\(([0-9-.]+)px, ([0-9-.]+)px\)/);t&&parseFloat(t[1])<0&&(e.style.transform=`translate(0px, ${t[2]}px)`)}return r};var Wn=(()=>{let i=class i{constructor(e,t,o){this.state=e,this.groupService=t,this.presentCount=null,this.absentCount=null,this.unapprovedCount=null,this.absentPrecedingCount=null,this.search="",this.selectLessonChange=new Y,this.selectDateChange=new Y,this.searchChange=new Y,this.viewModeChange=new Y,this.viewModeOptions=[{viewMode:me.List,icon:"list"},{viewMode:me.Grid,icon:"view_module"}],this.isGroupSelected$=this.groupService.group$.pipe(f(zt)),o.popperOptions=a=>ge(ue({},a),{modifiers:a.modifiers?.map(h=>(h.name==="offset"&&(h.options={offset:({placement:C,reference:k,popper:V})=>C==="bottom-start"?[(window.innerWidth-V.width)/2-k.x,0]:[]}),h))})}};i.\u0275fac=function(t){return new(t||i)(_(G),_(de),_(He))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-header"]],viewQuery:function(t,o){if(t&1&&St(Ee,5),t&2){let a;xt(a=It())&&(o.lessonDropdown=a.first)}},inputs:{selectedLesson:"selectedLesson",lessons:"lessons",presentCount:"presentCount",absentCount:"absentCount",unapprovedCount:"unapprovedCount",absentPrecedingCount:"absentPrecedingCount",viewMode:"viewMode",selectDate:"selectDate",search:"search"},outputs:{selectLessonChange:"selectLessonChange",selectDateChange:"selectDateChange",searchChange:"searchChange",viewModeChange:"viewModeChange"},standalone:!0,features:[he([He,{provide:Rt,useClass:Ut},{provide:Nt,useClass:Sn}]),E],decls:40,vars:20,consts:[["d","ngbDatepicker"],[1,"navigation"],[1,"lesson-date"],["type","button",1,"btn","btn-link",3,"click"],[1,"material-icons"],["positionTarget",".lesson-date-input","ngbDatepicker","","placement","bottom-start",1,"lesson-date-input",3,"ngModelChange","ngModel"],["class","lesson-time",3,"click",4,"ngIf"],["ngbDropdown","","class","lesson-description","container","body","display","dynamic","placement","bottom",4,"ngIf"],["class","dropdown-caret",3,"expanded","click",4,"ngIf"],[1,"states"],[1,"state","present"],[1,"count"],[1,"state","absent"],[1,"state","unapproved"],[1,"state","previously-absent"],[1,"material-icons-outlined"],[1,"search-and-views"],[1,"search",3,"valueChange","value","disabled","placeholder","label"],[1,"group-and-views","d-flex","align-items-center"],["type","button","class","group btn me-2 me-sm-4",3,"ngClass","routerLink","queryParams",4,"ngIf"],[1,"views"],["type","button","class","view btn btn-primary btn-icon",3,"disabled","btn-outline-secondary","btn-link","active","click",4,"ngFor","ngForOf"],[1,"lesson-time",3,"click"],[1,"lesson-time-to"],["ngbDropdown","","container","body","display","dynamic","placement","bottom",1,"lesson-description"],["id","lesson-dropdown","ngbDropdownToggle",""],[1,"text-truncate"],["ngbDropdownMenu","","aria-labelledby","lesson-dropdown"],["ngbDropdownItem","",3,"active","click",4,"ngFor","ngForOf"],["ngbDropdownItem","",3,"click"],[1,"lesson-entry"],[1,"dropdown-caret",3,"click","expanded"],["type","button",1,"group","btn","me-2","me-sm-4",3,"ngClass","routerLink","queryParams"],[1,"material-icons","align-middle"],["type","button",1,"view","btn","btn-primary","btn-icon",3,"click","disabled"]],template:function(t,o){if(t&1){let a=M();c(0,"div",1)(1,"div",2)(2,"button",3),b("click",function(){P(a);let C=te(6);return S(C.toggle())}),c(3,"i",4),d(4,"calendar_today"),p()(),c(5,"input",5,0),b("ngModelChange",function(C){return P(a),S(o.selectDateChange.emit(C))}),p()(),v(7,Bi,6,8,"div",6)(8,ji,8,3,"div",7)(9,Vi,1,1,"bkd-caret",8),p(),c(10,"div",9)(11,"div",10)(12,"i",4),d(13,"check_circle"),p(),c(14,"span",11),d(15),p()(),c(16,"div",12)(17,"i",4),d(18,"cancel"),p(),c(19,"span",11),d(20),p()(),c(21,"div",13)(22,"i",4),d(23,"help"),p(),c(24,"span",11),d(25),p()(),c(26,"div",14)(27,"i",15),d(28,"info"),p(),c(29,"span",11),d(30),p()()(),c(31,"div",16)(32,"bkd-resettable-input",17),l(33,"translate"),l(34,"translate"),b("valueChange",function(C){return P(a),S(o.searchChange.emit(C))}),p(),c(35,"div",18),v(36,Ai,6,16,"a",19),l(37,"async"),c(38,"div",20),v(39,Ri,3,8,"button",21),p()()()}t&2&&(s(5),g("ngModel",o.selectDate),s(2),g("ngIf",o.selectedLesson),s(),g("ngIf",o.selectedLesson),s(),g("ngIf",o.lessons.length>0),s(6),w(o.presentCount!==null?o.presentCount:"?"),s(5),w(o.absentCount!==null?o.absentCount:"?"),s(5),w(o.unapprovedCount!==null?o.unapprovedCount:"?"),s(5),w(o.absentPrecedingCount!==null?o.absentPrecedingCount:"?"),s(2),g("value",o.search)("disabled",!o.selectedLesson)("placeholder",m(33,14,"presence-control.header.search-by-name"))("label",m(34,16,"presence-control.header.search")),s(4),g("ngIf",m(37,18,o.selectedLesson&&o.state.groupsAvailability$)),s(3),g("ngForOf",o.viewModeOptions))},dependencies:[Gt,re,jt,Vt,At,ie,Ee,Wt,qt,N,Ht,cn,xn,Dt,Ue,oe,Ce,j,F],styles:['[_nghost-%COMP%]{display:flex;flex-direction:column;padding:.75rem 0}.navigation[_ngcontent-%COMP%]{display:grid;grid-template-areas:". date time dropdown-caret" ". description description dropdown-caret";grid-template-columns:1fr auto auto 1fr;align-items:center}.lesson-date[_ngcontent-%COMP%]{grid-area:date;justify-self:end;display:flex;align-items:center;justify-content:flex-end}.lesson-date[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:0 .5ch 0 0}.lesson-date[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#000;position:relative}.lesson-date-input[_ngcontent-%COMP%]{font-weight:600;background:transparent;border:none;width:11ch}.lesson-time[_ngcontent-%COMP%]{grid-area:time;cursor:pointer}.lesson-description[_ngcontent-%COMP%]{grid-area:description;overflow:hidden;text-align:center;cursor:pointer}.dropdown-toggle[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.dropdown-toggle[_ngcontent-%COMP%]:after{display:none}.dropdown-caret[_ngcontent-%COMP%]{grid-area:dropdown-caret;line-height:100%;text-align:left;color:#000}.dropdown-menu[_ngcontent-%COMP%]{width:50ch;padding:0;box-shadow:2px 2px 3px -1px #0003}@media (max-width: 800px){.dropdown-menu[_ngcontent-%COMP%]{width:100vw}}.dropdown-item[_ngcontent-%COMP%]{padding:1rem;border-bottom:1px solid #dee2e6}.states[_ngcontent-%COMP%]{margin:.75rem 0;display:flex;justify-content:center}.state[_ngcontent-%COMP%]{margin-right:7%;display:flex}.state[_ngcontent-%COMP%]:last-child{margin-right:0}@media (min-width: 1000px){.state[_ngcontent-%COMP%]{margin-right:4rem}}.state.present[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#3d8608}.state.absent[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ea161f}.state.unapproved[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#ffa814}.state.previously-absent[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{color:#00000080}.state[_ngcontent-%COMP%]   .count[_ngcontent-%COMP%]{margin-left:.3em;margin-top:1px}.search-and-views[_ngcontent-%COMP%]{padding-top:.75rem;display:flex;justify-content:space-between;border-top:1px solid #dee2e6}.search[_ngcontent-%COMP%]{flex:auto;max-width:300px;margin-right:1rem}.views[_ngcontent-%COMP%]{display:flex}.view[_ngcontent-%COMP%]{color:#4e4e4ef2;background-color:#fff}.view.active[_ngcontent-%COMP%]{color:#fff;background-color:#4e4e4ef2;border:none}.group[_ngcontent-%COMP%], .view[_ngcontent-%COMP%]{text-decoration:none;padding-left:0;padding-right:0;aspect-ratio:1/1;width:calc(.75rem + 2 * var(--bs-border-width) + 1.625rem);border-radius:50%}.group.btn-link[_ngcontent-%COMP%]{color:#000}@media (max-width: 380px){[_nghost-%COMP%]{padding-left:.5rem;padding-right:.5rem}#search-addon[_ngcontent-%COMP%]{padding-left:.5rem;padding-right:.5rem}}@media (max-width: 365px){.lesson-time[_ngcontent-%COMP%]{line-height:1}.lesson-time-to[_ngcontent-%COMP%]{display:block}.dropdown-caret[_ngcontent-%COMP%]{padding-left:0}}']});let n=i;return n})();function Gi(n,i){if(n&1){let r=M();c(0,"div",5)(1,"input",6),b("change",function(){let t=P(r).$implicit,o=u();return S(o.onSelectionChange(t))}),p(),c(2,"label",7),d(3),p()()}if(n&2){let r=i.$implicit,e=i.index,t=u();s(),z("id","incident-",e,""),g("checked",r.id===t.selected.id)("value",r.id),s(),z("for","incident-",e,""),s(),x(" ",r.label," ")}}var Qn=(()=>{let i=class i{constructor(e,t){this.activeModal=e,this.translate=t,this.incidentOptions=[]}ngOnInit(){let e=this.createIncidentOption();this.incidentOptions=this.incidentTypes.map(t=>this.createIncidentOption(t)),this.incidentOptions.unshift(e),this.selected=this.incidentOptions.find(t=>t.id===this.incident?.Id)||e}createIncidentOption(e){return{id:e?e.Id:null,label:e?e.Designation:this.translate.instant("presence-control.incident.no-incident")}}onSelectionChange(e){this.selected=e}getSelectedIncident(){return this.incidentTypes.find(e=>e.Id===this.selected?.id)||null}};i.\u0275fac=function(t){return new(t||i)(_(se),_(Q))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-incident"]],inputs:{incident:"incident",incidentTypes:"incidentTypes"},standalone:!0,features:[E],decls:13,vars:10,consts:[[1,"modal-body"],["class","form-check",4,"ngFor","ngForOf"],[1,"modal-footer"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","button",1,"btn","btn-primary",3,"click"],[1,"form-check"],["type","radio","name","incident",1,"form-check-input",3,"change","id","checked","value"],[1,"form-check-label",3,"for"]],template:function(t,o){t&1&&(c(0,"div",0)(1,"p"),d(2),l(3,"translate"),p(),c(4,"form"),v(5,Gi,4,7,"div",1),p()(),c(6,"div",2)(7,"button",3),b("click",function(){return o.activeModal.dismiss()}),d(8),l(9,"translate"),p(),c(10,"button",4),b("click",function(){return o.activeModal.close(o.getSelectedIncident())}),d(11),l(12,"translate"),p()()),t&2&&(s(2),x(" ",m(3,4,"presence-control.incident.text")," "),s(3),g("ngForOf",o.incidentOptions),s(3),x(" ",m(9,6,"presence-control.incident.cancel")," "),s(3),x(" ",m(12,8,"presence-control.incident.save")," "))},dependencies:[re,ye,ve,be,N,j,F],styles:["form[_ngcontent-%COMP%] > div[_ngcontent-%COMP%]:first-child{border-bottom:1px solid #dee2e6;padding-bottom:1rem;margin-bottom:1rem}"]});let n=i;return n})();var Ui=20,Hi=100,je=function(n){return n.AddUpdateAction="ADD",n.RemoveUpdateAction="REMOVE",n}(je||{}),tt=(()=>{let i=class i{constructor(e,t,o,a,h){this.toastService=e,this.translate=t,this.restService=o,this.presenceTypesService=a,this.settings=h,this.destroy$=new $,this.action$=new $,this.pendingUpdates$=this.action$.pipe(Ct(this.reduceUpdates.bind(this),[]),vt()),this.revertUpdates$=new $,this.performUpdates$=this.pendingUpdates$.pipe(nt(Hi),Le(We(ct)),_t(this.performUpdates.bind(this))),this.stateUpdates$=X(this.pendingUpdates$,this.revertUpdates$).pipe(nt(Ui),Le(We(ct))),this.performUpdates$.pipe(q(this.destroy$)).subscribe()}ngOnDestroy(){this.destroy$.next()}updatePresenceType(e,t=null){this.dispatchAddUpdate(e.lessonPresence,t)}performUpdates(e){let t=this.groupUpdates(e);return O(Object.keys(t).reduce((o,a)=>{let h=t[a];return Object.keys(h).forEach(C=>{let k=h[C];o.push(this.performUpdateForGroup(k))}),o},[])).pipe(f(()=>t))}performUpdateForGroup(e){return e.forEach(t=>this.dispatchRemoveUpdate(t.presence)),this.performLessonPresencesUpdatesByIds(e[0].presence.LessonRef.Id,e.map(t=>t.presence.StudentRef.Id),e[0].newPresenceTypeId).pipe(ht(t=>this.revertUpdatesAfterError(e,t)))}performLessonPresencesUpdatesByIds(e,t,o=null){return o?(o?this.presenceTypesService.getPresenceType(o):J(null)).pipe(T(h=>this.restService.editLessonPresences([e],t,h?.Id,Qe(h,this.settings)||void 0,{context:new ot().set(at,{disableErrorHandling:!0})}))):this.restService.removeLessonPresences([e],t,{context:new ot().set(at,{disableErrorHandling:!0})})}revertUpdatesAfterError(e,t){return console.error("Bulk-update of lesson presences failed"),console.error(t),this.toastService.error(this.translate.instant("shared.lesson-presences-update.error")),this.revertUpdates$.next(e.map(o=>ge(ue({},o),{newPresenceTypeId:o.presence.TypeRef.Id}))),J(void 0)}groupUpdates(e){return e.reduce((t,o)=>{let a=String(o.newPresenceTypeId&&o.newPresenceTypeId);return t[a]||(t[a]={}),Array.isArray(t[a][o.presence.LessonRef.Id])||(t[a][o.presence.LessonRef.Id]=[]),t[a][o.presence.LessonRef.Id].push(o),t},{})}reduceUpdates(e,t){switch(t.type){case je.AddUpdateAction:{let{presence:o,newPresenceTypeId:a}=t.payload,h=e.findIndex(Kn(o));return h===-1?[...e,{presence:o,newPresenceTypeId:a}]:[...e.slice(0,h),{presence:e[h].presence,newPresenceTypeId:a},...e.slice(h+1)]}case je.RemoveUpdateAction:return e.filter(We(Kn(t.payload)));default:return e}}dispatchAddUpdate(e,t){this.action$.next({type:je.AddUpdateAction,payload:{presence:e,newPresenceTypeId:t}})}dispatchRemoveUpdate(e){this.action$.next({type:je.RemoveUpdateAction,payload:e})}};i.\u0275fac=function(t){return new(t||i)(y(Pe),y(Q),y(sn),y(Se),y(H))},i.\u0275prov=R({token:i,factory:i.\u0275fac,providedIn:"root"});let n=i;return n})();function Kn(n){return i=>i.presence.LessonRef.Id===n.LessonRef.Id&&i.presence.StudentRef.Id===n.StudentRef.Id}var qi=(n,i,r)=>({lesson:n,lessons:i,entries:r}),Wi=n=>({returnparams:n});function Qi(n,i){if(n&1){let r=M();c(0,"bkd-presence-control-entry",7),l(1,"async"),l(2,"async"),l(3,"async"),l(4,"async"),b("togglePresenceType",function(t){P(r);let o=u(5);return S(o.togglePresenceType(t))})("changeIncident",function(t){P(r);let o=u(5);return S(o.changeIncident(t))}),p()}if(n&2){let r,e=i.$implicit,t=u(5);g("entry",e)("hasUnconfirmedAbsences",m(1,5,t.state.hasUnconfirmedAbsences(e)))("viewMode",m(2,7,t.state.viewMode$))("showClassName",((r=m(3,9,t.state.studyClassCount$))!==null&&r!==void 0?r:0)>1)("profileReturnParams",ne(13,Wi,m(4,11,t.state.queryParamsString$)))}}function Ki(n,i){if(n&1&&(Z(0),c(1,"div"),l(2,"async"),v(3,Qi,5,15,"bkd-presence-control-entry",6),p(),ee()),n&2){let r=u(3).bkdLet,e=u();s(),Re("default-entries entries view-mode-",m(2,4,e.state.viewMode$),""),s(2),g("ngForOf",r.entries)}}function zi(n,i){n&1&&(c(0,"p",8),d(1),l(2,"translate"),p()),n&2&&(s(),x(" ",m(2,1,"presence-control.no-lesson-presences")," "))}function Ji(n,i){if(n&1&&(Z(0),v(1,Ki,4,6,"ng-container",4)(2,zi,3,3,"ng-template",null,2,_e),ee()),n&2){let r=te(3),e=u(2).bkdLet;s(),g("ngIf",(e.entries==null?null:e.entries.length)>0)("ngIfElse",r)}}function Xi(n,i){n&1&&(c(0,"p",8),d(1),l(2,"translate"),p()),n&2&&(s(),w(m(2,1,"presence-control.no-lessons")))}function Yi(n,i){if(n&1){let r=M();Z(0),c(1,"bkd-presence-control-header",5),l(2,"async"),l(3,"async"),l(4,"async"),l(5,"async"),l(6,"async"),l(7,"async"),l(8,"async"),b("searchChange",function(t){P(r);let o=u(2);return S(o.search$.next(t))})("viewModeChange",function(t){P(r);let o=u(2);return S(o.state.setViewMode(t))})("selectDateChange",function(t){P(r);let o=u(2);return S(o.state.setDate(t))})("selectLessonChange",function(t){P(r);let o=u(2);return S(o.state.setLessonId(t.id))}),p(),v(9,Ji,4,2,"ng-container",4)(10,Xi,3,3,"ng-template",null,1,_e),ee()}if(n&2){let r=te(11),e=u().bkdLet,t=u();s(),g("selectedLesson",e.lesson)("lessons",e.lessons)("presentCount",m(2,11,t.state.presentCount$))("absentCount",m(3,13,t.state.absentCount$))("unapprovedCount",m(4,15,t.state.unapprovedCount$))("absentPrecedingCount",m(5,17,t.state.absentPrecedingCount$))("viewMode",m(6,19,t.state.viewMode$))("selectDate",m(7,21,t.state.selectedDate$))("search",m(8,23,t.search$)),s(8),g("ngIf",e.lesson)("ngIfElse",r)}}function Zi(n,i){n&1&&W(0,"bkd-spinner")}function eo(n,i){if(n&1&&(Z(0),v(1,Yi,12,25,"ng-container",4),l(2,"async"),v(3,Zi,1,0,"ng-template",null,0,_e),ee()),n&2){let r=te(4),e=u();s(),g("ngIf",m(2,2,e.state.loading$)===!1)("ngIfElse",r)}}var to=["studentFullName"],Jn=(()=>{let i=class i{constructor(e,t,o,a,h,C,k){this.state=e,this.blockLessons=t,this.lessonPresencesUpdateService=o,this.presenceTypesService=a,this.modalService=h,this.scrollPosition=C,this.route=k,this.search$=new fe(""),this.entries$=O([this.state.presenceControlEntriesByGroup$,this.search$]).pipe(f(([V,Me])=>Pn(V,to,Me)),B(1)),this.destroy$=new $}ngOnInit(){this.route.queryParams.pipe(q(this.destroy$)).subscribe(this.restoreStateFromParams.bind(this))}ngAfterViewInit(){this.scrollPosition.restore()}ngOnDestroy(){this.destroy$.next()}doTogglePresenceType(e){e.forEach(t=>this.state.getNextPresenceType(t).subscribe(o=>this.lessonPresencesUpdateService.updatePresenceType(t,o?o.Id:null)))}togglePresenceType(e){this.blockLessons.getBlockLessonPresenceControlEntries(e).pipe(D(1)).subscribe(t=>{if(t.length===1){let o=t[0];this.doTogglePresenceType([o])}else{let o=this.modalService.open(Un);o.componentInstance.entry=e,o.componentInstance.blockPresenceControlEntries=t,o.result.then(a=>{a&&this.doTogglePresenceType(a)},()=>{})}})}updateIncident(e,t){this.lessonPresencesUpdateService.updatePresenceType(e,t)}changeIncident(e){this.presenceTypesService.incidentTypes$.subscribe(t=>{let o=this.modalService.open(Qn);o.componentInstance.incident=t.find(a=>a.Id===e.presenceType?.Id)||null,o.componentInstance.incidentTypes=t,o.result.then(a=>{this.updateIncident(e,a?.Id||null)},()=>{})})}restoreStateFromParams(e){e.date&&this.state.setDate(Ft(e.date));let t=String(e.lesson);t&&this.state.setLessonId(t),e.viewMode&&An.includes(e.viewMode)&&this.state.setViewMode(e.viewMode)}};i.\u0275fac=function(t){return new(t||i)(_(G),_(et),_(tt),_(Se),_(Ie),_(In),_(Ge))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control-list"]],standalone:!0,features:[E],decls:7,vars:14,consts:[["loading",""],["noLessons",""],["noLessonPresences",""],[4,"bkdLet"],[4,"ngIf","ngIfElse"],[3,"searchChange","viewModeChange","selectDateChange","selectLessonChange","selectedLesson","lessons","presentCount","absentCount","unapprovedCount","absentPrecedingCount","viewMode","selectDate","search"],[3,"entry","hasUnconfirmedAbsences","viewMode","showClassName","profileReturnParams","togglePresenceType","changeIncident",4,"ngFor","ngForOf"],[3,"togglePresenceType","changeIncident","entry","hasUnconfirmedAbsences","viewMode","showClassName","profileReturnParams"],[1,"mt-3"]],template:function(t,o){t&1&&(c(0,"h1"),d(1),l(2,"translate"),p(),v(3,eo,5,4,"ng-container",3),l(4,"async"),l(5,"async"),l(6,"async")),t&2&&(s(),w(m(2,2,"presence-control.title")),s(2),g("bkdLet",$t(10,qi,m(4,4,o.state.selectedLesson$),m(5,6,o.state.lessons$),m(6,8,o.entries$))))},dependencies:[ce,ie,Wn,N,qn,xe,oe,j,F],styles:["bkd-presence-control-entry[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6}.entries.view-mode-grid[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%}@media (min-width: 400px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:100%;border-right:1px solid #dee2e6}}@media (min-width: 800px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:50%;border-right:1px solid #dee2e6}}@media (min-width: 1200px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:33.3333333333%;border-right:1px solid #dee2e6}}@media (min-width: 1600px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:25%;border-right:1px solid #dee2e6}}@media (min-width: 2000px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:20%;border-right:1px solid #dee2e6}}@media (min-width: 2400px){.entries.view-mode-grid[_ngcontent-%COMP%] > *[_ngcontent-%COMP%]{width:16.6666666667%;border-right:1px solid #dee2e6}}[_nghost-%COMP%]{display:block;overflow:hidden;width:100%}.entries.view-mode-grid[_ngcontent-%COMP%]{width:calc(100% + 1px)}"],changeDetection:0});let n=i;return n})();var Xn=(()=>{let i=class i{constructor(e,t){this.state=e,this.lessonPresencesUpdateService=t,this.destroy$=new $}ngOnInit(){this.lessonPresencesUpdateService.stateUpdates$.pipe(q(this.destroy$)).subscribe(e=>this.state.updateLessonPresencesTypes(e))}ngOnDestroy(){this.destroy$.next()}};i.\u0275fac=function(t){return new(t||i)(_(G),_(tt))},i.\u0275cmp=L({type:i,selectors:[["bkd-presence-control"]],standalone:!0,features:[he([G,et,de,on,{provide:Jt,useExisting:G}]),E],decls:1,vars:0,template:function(t,o){t&1&&W(0,"router-outlet")},dependencies:[Bt],changeDetection:0});let n=i;return n})();var Qs=[{path:"",component:Xn,children:[{path:"",component:Jn,data:{restoreScrollPositionFrom:["/presence-control/student/:id/addresses","/presence-control/student/:id/absences","/presence-control/student/:id/grades"]}},_n,{path:"groups/:id",component:Gn}]}];export{Qs as PRESENCE_CONTROL_ROUTES};
