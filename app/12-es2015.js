(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{CZtb:function(e,t,n){"use strict";n.r(t),n.d(t,"MyAbsencesModule",function(){return Dt});var c=n("PCNd"),s=n("tyNb"),i=n("jtHE"),r=n("itXk"),a=n("eIep"),o=n("UXun"),b=n("pLZG"),l=n("lJxs"),d=n("IzEk"),u=n("JX91"),f=n("oB13"),p=n("x+ZX"),g=n("Xr/R"),m=n("fbMX"),h=n("mmcK"),y=n("IClS"),v=n("K+0v"),S=n("eB9A"),I=n("fXoL");let z=(()=>{class e{constructor(e,t,n){var c;this.settings=e,this.storageService=t,this.studentsService=n,this.studentId$=new i.a(1),this.lessonAbsences$=this.studentId$.pipe(Object(a.a)(this.loadLessonAbsences.bind(this)),Object(o.a)(1)),this.lessonIncidents$=this.studentId$.pipe(Object(a.a)(this.loadLessonIncidents.bind(this)),Object(o.a)(1)),this.lessonPresences$=this.getLessonPresences(),this.checkableAbsences$=this.getAbsences(this.settings.checkableAbsenceStateId),this.openAbsences$=this.getAbsences(this.settings.unconfirmedAbsenceStateId),this.excusedAbsences$=this.getAbsences(this.settings.excusedAbsenceStateId),this.unexcusedAbsences$=this.getAbsences(this.settings.unexcusedAbsenceStateId),this.incidents$=this.getAbsences(null),this.openLessonAbsences$=Object(r.a)([this.openAbsences$.pipe(Object(b.a)(v.e)),this.lessonAbsences$]).pipe(Object(l.a)(Object(S.a)(this.getOpenLessonAbsences.bind(this))),Object(o.a)(1)),this.counts$=this.getCounts();const s=(null===(c=this.storageService.getPayload())||void 0===c?void 0:c.id_person)||null;s&&this.studentId$.next(s)}reset(){this.studentId$.pipe(Object(d.a)(1)).subscribe(e=>this.studentId$.next(e))}getLessonPresences(){return this.getCached(Object(r.a)([this.studentId$,this.lessonAbsences$,this.lessonIncidents$]).pipe(Object(a.a)(([e,t,n])=>this.loadTimetableEntries(e,t,n).pipe(Object(l.a)(e=>this.buildLessonPresences(t,n,e)))),Object(l.a)(y.c)))}getAbsences(e){return this.getCached(this.lessonPresences$.pipe(Object(l.a)(t=>(null==t?void 0:t.filter(t=>t.ConfirmationStateId===e))||null)))}getOpenLessonAbsences(e,t){const n=e.map(e=>e.LessonRef.Id);return t.filter(e=>n.includes(e.LessonRef.Id))}getCounts(){return Object(r.a)([this.getCount(this.checkableAbsences$),this.getCount(this.openAbsences$),this.getCount(this.excusedAbsences$),this.getCount(this.unexcusedAbsences$),this.getCount(this.incidents$)]).pipe(Object(l.a)(([e,t,n,c,s])=>({checkableAbsences:e,openAbsences:t,excusedAbsences:n,unexcusedAbsences:c,incidents:s,halfDays:null})))}getCached(e){return e.pipe(Object(u.a)(null),Object(f.a)(()=>new i.a(1)),Object(p.a)())}getCount(e){return e.pipe(Object(l.a)(e=>{var t;return null!==(t=null==e?void 0:e.length)&&void 0!==t?t:null}))}loadLessonAbsences(e){return this.studentsService.getLessonAbsences(e)}loadLessonIncidents(e){return this.studentsService.getLessonIncidents(e)}loadTimetableEntries(e,t,n){return this.studentsService.getTimetableEntries(e,{"filter.Id":`;${[...t,...n].map(e=>e.LessonRef.Id).join(";")}`,fields:"Id,From,To,EventNumber,EventDesignation,EventManagerInformation"})}buildLessonPresences(e,t,n){return[...e,...t].map(e=>this.buildLessonPresence(e,n)).filter(v.e)}buildLessonPresence(e,t){const n=t.find(t=>t.Id===e.LessonRef.Id);return n?{Id:"",LessonRef:{Id:e.LessonRef.Id,HRef:e.LessonRef.HRef?e.LessonRef.HRef:null},StudentRef:e.StudentRef,EventRef:{Id:0,HRef:null},TypeRef:e.TypeRef,RegistrationRef:{Id:0,HRef:null},StudyClassRef:{Id:0,HRef:null},ConfirmationStateId:"ConfirmationStateId"in e?e.ConfirmationStateId:null,EventDesignation:n.EventDesignation,HasStudyCourseConfirmationCode:!1,LessonDateTimeFrom:n.From,LessonDateTimeTo:n.To,Comment:null,Date:n.From,Type:e.Type,StudentFullName:e.StudentFullName,StudyClassNumber:"",TeacherInformation:n.EventManagerInformation}:null}}return e.\u0275fac=function(t){return new(t||e)(I.Zb(g.a),I.Zb(m.a),I.Zb(h.a))},e.\u0275prov=I.Ib({token:e,factory:e.\u0275fac}),e})(),O=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences"]],features:[I.yb([z])],decls:1,vars:0,template:function(e,t){1&e&&I.Nb(0,"router-outlet")},directives:[s.k],styles:[""],changeDetection:0}),e})();var R=n("XNiG"),C=n("LRne"),$=n("5QKP"),k=n("Ug8t"),D=n("8teX"),T=n("BeL+"),P=n("tPH9"),j=n("ylTp"),F=n("9f76"),M=n("/1FC"),L=j.a?j.a.isConcatSpreadable:void 0,A=function(e){return Object(M.a)(e)||Object(F.a)(e)||!!(L&&e&&e[L])},x=function e(t,n,c,s,i){var r=-1,a=t.length;for(c||(c=A),i||(i=[]);++r<a;){var o=t[r];n>0&&c(o)?n>1?e(o,n-1,c,s,i):Object(P.a)(i,o):s||(i[i.length]=o)}return i},w=function(e){return null!=e&&e.length?x(e,1):[]},B=n("EOpz"),E=n("1kSV"),_=n("sYmb");const N=["link"],G=function(){return["/my-absences/report"]};let H=(()=>{class e{constructor(){}onClick(){this.link.nativeElement.click()}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-report-link"]],viewQuery:function(e,t){if(1&e&&I.Jc(N,1),2&e){let e;I.tc(e=I.ec())&&(t.link=e.first)}},hostBindings:function(e,t){1&e&&I.dc("click",function(e){return t.onClick(e)})},decls:8,vars:5,consts:[[1,"m-0"],[1,"btn","btn-link","p-0",3,"routerLink"],["link",""],[1,"d-flex","align-items-center"],[1,"material-icons"]],template:function(e,t){1&e&&(I.Sb(0,"h5",0),I.Dc(1),I.gc(2,"translate"),I.Rb(),I.Sb(3,"a",1,2),I.Sb(5,"div",3),I.Sb(6,"i",4),I.Dc(7,"keyboard_arrow_right"),I.Rb(),I.Rb(),I.Rb()),2&e&&(I.zb(1),I.Fc(" ",I.hc(2,2,"my-absences.report.title"),"\n"),I.zb(2),I.lc("routerLink",I.oc(4,G)))},directives:[s.i],pipes:[_.c],styles:["[_nghost-%COMP%]{display:flex;align-items:center;justify-content:space-between;padding:1.5rem;cursor:pointer}.btn[_ngcontent-%COMP%]{color:#33333d;text-decoration:none}"],changeDetection:0}),e})();var Q=n("4vw6"),U=n("ofXK"),Z=n("ZLMY");function X(e,t){1&e&&I.Nb(0,"erz-my-absences-report-link")}function q(e,t){}function K(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc(2).erzLet;I.zb(1),I.Fc("(",e.absenceCounts.checkableAbsences,")")}}function J(e,t){if(1&e){const e=I.Tb();I.Sb(0,"erz-student-profile-entry-header",12),I.dc("click",function(){return I.vc(e),I.fc(),I.uc(2).toggle("checkable-absences")}),I.Dc(1),I.gc(2,"translate"),I.Bc(3,K,2,1,"ng-container",13),I.Rb()}if(2&e){const e=t.opened,n=I.fc().erzLet;I.lc("opened",e),I.zb(1),I.Fc(" ",I.hc(2,3,"shared.profile.checkable-absences")," "),I.zb(2),I.lc("ngIf",null!=n.absenceCounts.checkableAbsences)}}function Y(e,t){if(1&e&&I.Nb(0,"erz-student-profile-absences",14),2&e){const e=I.fc(2);I.lc("absences$",e.myAbsencesService.checkableAbsences$)}}function V(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc(2).erzLet;I.zb(1),I.Fc("(",e.absenceCounts.openAbsences,")")}}function W(e,t){if(1&e){const e=I.Tb();I.Sb(0,"erz-student-profile-entry-header",12),I.dc("click",function(){return I.vc(e),I.fc(),I.uc(2).toggle("open-absences")}),I.Dc(1),I.gc(2,"translate"),I.Bc(3,V,2,1,"ng-container",13),I.Rb()}if(2&e){const e=t.opened,n=I.fc().erzLet;I.lc("opened",e),I.zb(1),I.Fc(" ",I.hc(2,3,"shared.profile.open-absences")," "),I.zb(2),I.lc("ngIf",null!=n.absenceCounts.openAbsences)}}function ee(e,t){if(1&e&&(I.Nb(0,"erz-student-profile-absences",15),I.gc(1,"translate"),I.gc(2,"async"),I.gc(3,"async")),2&e){const e=I.fc(2);I.lc("absences$",e.myAbsencesService.openAbsences$)("selectionService",e.absencesSelectionService)("defaultAbsenceSelectionMessage",I.hc(1,5,"my-absences.show.default-absence-selection-message"))("reportUrl",I.hc(2,7,e.reportUrl$))("reportAvailable",I.hc(3,9,e.reportAvailable$))}}function te(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc(2).erzLet;I.zb(1),I.Fc("(",e.absenceCounts.excusedAbsences,")")}}function ne(e,t){if(1&e){const e=I.Tb();I.Sb(0,"erz-student-profile-entry-header",12),I.dc("click",function(){return I.vc(e),I.fc(),I.uc(2).toggle("excused-absences")}),I.Dc(1),I.gc(2,"translate"),I.Bc(3,te,2,1,"ng-container",13),I.Rb()}if(2&e){const e=t.opened,n=I.fc().erzLet;I.lc("opened",e),I.zb(1),I.Fc(" ",I.hc(2,3,"shared.profile.excused-absences")," "),I.zb(2),I.lc("ngIf",null!=n.absenceCounts.excusedAbsences)}}function ce(e,t){if(1&e&&I.Nb(0,"erz-student-profile-absences",14),2&e){const e=I.fc(2);I.lc("absences$",e.myAbsencesService.excusedAbsences$)}}function se(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc(2).erzLet;I.zb(1),I.Fc("(",e.absenceCounts.unexcusedAbsences,")")}}function ie(e,t){if(1&e){const e=I.Tb();I.Sb(0,"erz-student-profile-entry-header",12),I.dc("click",function(){return I.vc(e),I.fc(),I.uc(2).toggle("unexcused-absences")}),I.Dc(1),I.gc(2,"translate"),I.Bc(3,se,2,1,"ng-container",13),I.Rb()}if(2&e){const e=t.opened,n=I.fc().erzLet;I.lc("opened",e),I.zb(1),I.Fc(" ",I.hc(2,3,"shared.profile.unexcused-absences")," "),I.zb(2),I.lc("ngIf",null!=n.absenceCounts.unexcusedAbsences)}}function re(e,t){if(1&e&&I.Nb(0,"erz-student-profile-absences",16),2&e){const e=I.fc(2);I.lc("absences$",e.myAbsencesService.unexcusedAbsences$)("displayPresenceType",!1)}}function ae(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc(2).erzLet;I.zb(1),I.Fc("(",e.absenceCounts.incidents,")")}}function oe(e,t){if(1&e){const e=I.Tb();I.Sb(0,"erz-student-profile-entry-header",12),I.dc("click",function(){return I.vc(e),I.fc(),I.uc(2).toggle("incidents")}),I.Dc(1),I.gc(2,"translate"),I.Bc(3,ae,2,1,"ng-container",13),I.Rb()}if(2&e){const e=t.opened,n=I.fc().erzLet;I.lc("opened",e),I.zb(1),I.Fc(" ",I.hc(2,3,"shared.profile.incidents")," "),I.zb(2),I.lc("ngIf",null!=n.absenceCounts.incidents)}}function be(e,t){if(1&e&&I.Nb(0,"erz-student-profile-absences",14),2&e){const e=I.fc(2);I.lc("absences$",e.myAbsencesService.incidents$)}}function le(e,t){1&e&&(I.Sb(0,"div",1),I.Sb(1,"ngb-accordion",2,3),I.Sb(3,"ngb-panel",4),I.Bc(4,X,1,0,"ng-template",5),I.Bc(5,q,0,0,"ng-template",6),I.Rb(),I.Sb(6,"ngb-panel",7),I.Bc(7,J,4,5,"ng-template",5),I.Bc(8,Y,1,1,"ng-template",6),I.Rb(),I.Sb(9,"ngb-panel",8),I.Bc(10,W,4,5,"ng-template",5),I.Bc(11,ee,4,11,"ng-template",6),I.Rb(),I.Sb(12,"ngb-panel",9),I.Bc(13,ne,4,5,"ng-template",5),I.Bc(14,ce,1,1,"ng-template",6),I.Rb(),I.Sb(15,"ngb-panel",10),I.Bc(16,ie,4,5,"ng-template",5),I.Bc(17,re,1,2,"ng-template",6),I.Rb(),I.Sb(18,"ngb-panel",11),I.Bc(19,oe,4,5,"ng-template",5),I.Bc(20,be,1,1,"ng-template",6),I.Rb(),I.Rb(),I.Rb())}const de=function(e){return{absenceCounts:e}};let ue=(()=>{class e{constructor(e,t,n){this.reportsService=e,this.myAbsencesService=t,this.absencesSelectionService=n,this.reportUrl$=this.loadReportUrl(),this.reportAvailable$=this.reportsService.studentConfirmationAvailability$,this.destroy$=new R.a}ngOnInit(){this.myAbsencesService.openLessonAbsences$.pipe(Object(d.a)(1),Object(b.a)(Object(v.d)(D.b))).subscribe(e=>this.reportsService.setStudentConfirmationAvailabilityRecordIds(e.map(e=>`${e.LessonRef.Id}_${e.RegistrationId}`)))}ngOnDestroy(){this.destroy$.next()}loadReportUrl(){return Object(r.a)([this.absencesSelectionService.selectedWithoutPresenceType$,this.absencesSelectionService.selectedIds$]).pipe(Object(a.a)(([e,t])=>0===e.length&&t.length>0?this.getReportRecordIds(Object(T.a)(w(t.map(e=>e.lessonIds)))):Object(C.a)(null)),Object(l.a)(e=>e?this.reportsService.getStudentConfirmationUrl(e):null))}getReportRecordIds(e){return this.myAbsencesService.openLessonAbsences$.pipe(Object(l.a)(t=>t.filter(t=>e.includes(t.LessonRef.Id)).map(e=>`${e.LessonRef.Id}_${e.RegistrationId}`)))}}return e.\u0275fac=function(t){return new(t||e)(I.Mb(k.a),I.Mb(z),I.Mb($.a))},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-show"]],decls:2,vars:5,consts:[["class","erz-container erz-container-padding-y erz-container-padding-x-responsive",4,"erzLet"],[1,"erz-container","erz-container-padding-y","erz-container-padding-x-responsive"],["ngb-accordion",""],["acc","ngbAccordion"],["id","report-absence"],["ngbPanelHeader",""],["ngbPanelContent",""],["id","checkable-absences"],["id","open-absences"],["id","excused-absences"],["id","unexcused-absences"],["id","incidents"],[3,"opened","click"],[4,"ngIf"],[3,"absences$"],[3,"absences$","selectionService","defaultAbsenceSelectionMessage","reportUrl","reportAvailable"],[3,"absences$","displayPresenceType"]],template:function(e,t){1&e&&(I.Bc(0,le,21,0,"div",0),I.gc(1,"async")),2&e&&I.lc("erzLet",I.pc(3,de,I.hc(1,1,t.myAbsencesService.counts$)))},directives:[B.a,E.a,E.m,E.o,E.n,H,Q.a,U.m,Z.a],pipes:[U.b,_.c],styles:[""],changeDetection:0}),e})();var fe=n("3Pt+"),pe=n("2Vo4"),ge=n("wO+i"),me=n("nYR2"),he=n("LpL1"),ye=n("KJh6"),ve=n("A6ef"),Se=n("5eHb");let Ie=(()=>{class e{constructor(e,t,n,c,s,i,a,o){this.fb=e,this.router=t,this.toastr=n,this.translate=c,this.presenceTypesService=s,this.updateService=i,this.storageService=a,this.settings=o,this.formGroup=this.createFormGroup(),this.saving$=new pe.a(!1),this.submitted$=new pe.a(!1),this.absenceTypes$=Object(r.a)([this.getConfirmationTypes(),this.getHalfDayType()]).pipe(Object(l.a)(([e,t])=>t?[...e,t]:e)),this.absenceTypeIdErrors$=Object(ve.c)(Object(C.a)(this.formGroup),this.submitted$,"absenceTypeId"),this.confirmationStateId=null,this.destroy$=new R.a}ngOnInit(){this.selectedLessonIds$.pipe(Object(d.a)(1),Object(b.a)(D.b)).subscribe(()=>this.navigateBack())}ngOnDestroy(){this.destroy$.next()}onSubmit(){if(this.submitted$.next(!0),this.formGroup.valid){const{absenceTypeId:e}=this.formGroup.value;this.save(e)}}cancel(){this.navigateBack()}getSelectedCount(){return this.selectedLessonIds$.pipe(Object(ge.a)("length"))}getConfirmationTypes(){return this.presenceTypesService.confirmationTypes$.pipe(Object(l.a)(e=>e.filter(e=>e.IsAbsence&&e.Id!==this.settings.halfDayPresenceTypeId)))}getHalfDayType(){return Object(C.a)(null)}createFormGroup(){return this.fb.group({absenceTypeId:[null,fe.q.required]})}save(e){this.saving$.next(!0),this.selectedLessonIds$.pipe(Object(d.a)(1),Object(a.a)(t=>{var n;return this.updateService.editLessonPresences(t,[Number(null===(n=this.storageService.getPayload())||void 0===n?void 0:n.id_person)],e)}),Object(me.a)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastr.success(this.translate.instant("my-absences.confirm.save-success")),this.navigateBack()}}return e.\u0275fac=function(t){return new(t||e)(I.Mb(fe.c),I.Mb(s.g),I.Mb(Se.b),I.Mb(_.d),I.Mb(ye.a),I.Mb(he.a),I.Mb(m.a),I.Mb(g.b))},e.\u0275cmp=I.Gb({type:e,selectors:[["ng-component"]],decls:0,vars:0,template:function(e,t){},encapsulation:2}),e})();var ze=n("6UOe");const Oe=function(e){return{count:e}};function Re(e,t){if(1&e&&(I.Sb(0,"div",10),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e){const e=t.erzLet;I.zb(1),I.Fc(" ",I.ic(2,1,1===e?"my-absences.confirm.lesson-selected":"my-absences.confirm.lessons-selected",I.pc(4,Oe,e))," ")}}function Ce(e,t){if(1&e&&(I.Sb(0,"div",16),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e){const e=t.$implicit;I.zb(1),I.Fc(" ",I.ic(2,1,"global.validation-errors."+e.error,e.params)," ")}}function $e(e,t){if(1&e&&(I.Qb(0),I.Bc(1,Ce,3,4,"div",15),I.gc(2,"async"),I.Pb()),2&e){const e=I.fc(2);I.zb(1),I.lc("ngForOf",I.hc(2,1,e.absenceTypeIdErrors$))}}const ke=function(e){return{"border-top pt-3":e}};function De(e,t){if(1&e&&(I.Sb(0,"div",11),I.Nb(1,"input",12),I.gc(2,"async"),I.Sb(3,"label",13),I.Dc(4),I.Rb(),I.Bc(5,$e,3,3,"ng-container",14),I.gc(6,"async"),I.Rb()),2&e){const e=t.$implicit,n=t.index,c=I.fc();let s=null;I.lc("ngClass",I.pc(12,ke,e.IsHalfDay)),I.zb(1),I.Eb("is-invalid",I.hc(2,8,c.absenceTypeIdErrors$).length>0),I.lc("id","absence-type-"+n)("value",e.Id),I.zb(2),I.lc("for","absence-type-"+n),I.zb(1),I.Fc(" ",e.Designation," "),I.zb(1),I.lc("ngIf",(null==(s=I.hc(6,10,c.absenceTypes$))?null:s.length)-1===n)}}function Te(e,t){1&e&&(I.Sb(0,"div",17),I.Sb(1,"span",18),I.Dc(2,"Loading..."),I.Rb(),I.Rb())}let Pe=(()=>{class e extends Ie{constructor(e,t,n,c,s,i,r,a,o,b){super(e,t,n,c,s,i,r,a),this.myAbsencesService=o,this.selectionService=b,this.selectedLessonIds$=this.selectionService.selectedIds$.pipe(Object(l.a)(e=>Object(T.a)(w(e.map(e=>e.lessonIds))))),this.confirmationStateId=this.settings.unconfirmedAbsencesRefreshTime}onSaveSuccess(){this.selectionService.clear(),this.myAbsencesService.reset(),super.onSaveSuccess()}navigateBack(){this.router.navigate(["/my-absences"])}}return e.\u0275fac=function(t){return new(t||e)(I.Mb(fe.c),I.Mb(s.g),I.Mb(Se.b),I.Mb(_.d),I.Mb(ye.a),I.Mb(he.a),I.Mb(m.a),I.Mb(g.a),I.Mb(z),I.Mb($.a))},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-confirm"]],features:[I.wb],decls:25,vars:32,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y"],["class","mb-3 pb-3 border-bottom",4,"erzLet"],[3,"formGroup","ngSubmit"],[1,"form-group","mb-3","border-bottom"],["class","form-check my-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"remark"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"mb-3","pb-3","border-bottom"],[1,"form-check","my-3",3,"ngClass"],["type","radio","formControlName","absenceTypeId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"],[4,"ngIf"],["class","invalid-feedback mt-4",4,"ngFor","ngForOf"],[1,"invalid-feedback","mt-4"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"sr-only"]],template:function(e,t){1&e&&(I.Sb(0,"div",0),I.Bc(1,Re,3,6,"div",1),I.gc(2,"async"),I.Sb(3,"form",2),I.dc("ngSubmit",function(){return t.onSubmit()}),I.Sb(4,"div",3),I.Sb(5,"label"),I.Dc(6),I.gc(7,"translate"),I.gc(8,"addSpace"),I.Rb(),I.Bc(9,De,7,14,"div",4),I.gc(10,"async"),I.Rb(),I.Sb(11,"div",5),I.Dc(12),I.gc(13,"translate"),I.Rb(),I.Sb(14,"div",6),I.Sb(15,"button",7),I.dc("click",function(){return t.cancel()}),I.gc(16,"async"),I.Dc(17),I.gc(18,"translate"),I.Rb(),I.Sb(19,"button",8),I.gc(20,"async"),I.Dc(21),I.gc(22,"translate"),I.Bc(23,Te,3,0,"div",9),I.gc(24,"async"),I.Rb(),I.Rb(),I.Rb(),I.Rb()),2&e&&(I.zb(1),I.lc("erzLet",I.hc(2,11,t.getSelectedCount())),I.zb(2),I.lc("formGroup",t.formGroup),I.zb(3),I.Gc("",I.hc(7,13,"my-absences.confirm.choose-presence-type"),"",I.ic(8,15,":",":"),""),I.zb(3),I.lc("ngForOf",I.hc(10,18,t.absenceTypes$)),I.zb(3),I.Fc(" ",I.hc(13,20,"my-absences.confirm.remark")," "),I.zb(3),I.lc("disabled",I.hc(16,22,t.saving$)),I.zb(2),I.Fc(" ",I.hc(18,24,"my-absences.confirm.cancel")," "),I.zb(2),I.lc("disabled",I.hc(20,26,t.saving$)),I.zb(2),I.Fc(" ",I.hc(22,28,"my-absences.confirm.save")," "),I.zb(2),I.lc("ngIf",I.hc(24,30,t.saving$)))},directives:[B.a,fe.r,fe.j,fe.e,U.l,U.m,U.k,fe.n,fe.b,fe.i,fe.d],pipes:[U.b,_.c,ze.a],styles:[""],changeDetection:0}),e})();var je=n("tk/3"),Fe=n("sWYD"),Me=n("Xep9"),Le=n("9/EM"),Ae=n("fhBx"),xe=n("CqUA");let we=(()=>{class e extends Ae.b{constructor(e,t,n,c,s){super(e,t,n,"/my-absences/report"),this.studentsService=c,this.storageService=s}getInitialFilter(){return{dateFrom:null,dateTo:null}}isValidFilter(e){return Boolean(e.dateFrom||e.dateTo)}loadEntries(e,t,n){const c=this.buildRequestParamsFromFilter(e).set("sort","From.asc").set("fields","Id,From,To,EventNumber,EventDesignation,EventManagerInformation");return this.loadingService.load(this.loadTimetableEntries(c).pipe(Object(a.a)(e=>Object(r.a)([Object(C.a)(e),this.loadLessonAbsences(e),this.loadLessonDispensations(e)])),Object(l.a)(([e,t,n])=>this.buildLessonPresences(e,t,n)),Object(l.a)(e=>({offset:0,total:e.length,entries:e}))),Ae.a)}buildParamsFromFilter(e){const{dateFrom:t,dateTo:n}=e,c={};return t&&(c.dateFrom=Object(Fe.a)(t,"yyyy-MM-dd")),n&&(c.dateTo=Object(Fe.a)(n,"yyyy-MM-dd")),c}buildRequestParamsFromFilter(e){let t=new je.f;return e.dateFrom&&(t=t.set("filter.From",`>${Object(Fe.a)(Object(Me.a)(e.dateFrom,1),"yyyy-MM-dd")}`)),e.dateTo&&(t=t.set("filter.To",`<${Object(Fe.a)(Object(Le.a)(e.dateTo,1),"yyyy-MM-dd")}`)),t}get studentId(){var e;const t=null===(e=this.storageService.getPayload())||void 0===e?void 0:e.id_person;if(null==t)throw new Error("No student id available");return t}loadTimetableEntries(e){return this.studentsService.getTimetableEntries(this.studentId,e)}loadLessonAbsences(e){return e.length>0?this.studentsService.getLessonAbsences(this.studentId,{"filter.Id":`;${e.map(e=>e.Id).join(";")}`}):Object(C.a)([])}loadLessonDispensations(e){return e.length>0?this.studentsService.getLessonDispensations(this.studentId,{"filter.Id":`;${e.map(e=>e.Id).join(";")}`}):Object(C.a)([])}buildLessonPresences(e,t,n){return e.map(e=>this.buildLessonPresence(e,t,n))}buildLessonPresence(e,t,n){var c,s,i;const r=t.find(t=>t.LessonRef.Id===e.Id),a=n.find(t=>t.LessonRef.Id===e.Id),o=this.buildLessonPresenceTypeRef(r,a);return{Id:"",LessonRef:{Id:e.Id,HRef:null},StudentRef:(null===(c=r||a)||void 0===c?void 0:c.StudentRef)||{Id:this.studentId,HRef:null},EventRef:{Id:0,HRef:null},TypeRef:o,RegistrationRef:{Id:0,HRef:null},StudyClassRef:{Id:0,HRef:null},ConfirmationStateId:(null==r?void 0:r.ConfirmationStateId)||a&&this.settings.excusedAbsenceStateId||null,EventDesignation:e.EventDesignation||"",HasStudyCourseConfirmationCode:!1,LessonDateTimeFrom:e.From||new Date,LessonDateTimeTo:e.To||new Date,Comment:null,Date:e.From||new Date,Type:(null===(s=r||a)||void 0===s?void 0:s.Type)||null,StudentFullName:(null===(i=r||a)||void 0===i?void 0:i.StudentFullName)||"",StudyClassNumber:"",TeacherInformation:e.EventManagerInformation}}buildLessonPresenceTypeRef(e,t){return e?Object.assign({},e.TypeRef):t?Object.assign({},t.TypeRef):{Id:null,HRef:null}}}return e.\u0275fac=function(t){return new(t||e)(I.Zb(U.i),I.Zb(xe.a),I.Zb(g.a),I.Zb(h.a),I.Zb(m.a))},e.\u0275prov=I.Ib({token:e,factory:e.\u0275fac}),e})();var Be=n("ulei");let Ee=(()=>{class e extends Be.a{constructor(){super(...arguments),this.selectedIds$=this.selection$.pipe(Object(l.a)(y.a))}}return e.\u0275fac=function(t){return _e(t||e)},e.\u0275prov=I.Ib({token:e,factory:e.\u0275fac}),e})();const _e=I.Ub(Ee);let Ne=(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-report"]],features:[I.yb([we,Ee])],decls:1,vars:0,template:function(e,t){1&e&&I.Nb(0,"router-outlet")},directives:[s.k],styles:[""],changeDetection:0}),e})();var Ge=n("1G5W"),He=n("KCaQ"),Qe=n("vlqf"),Ue=n("RYjX"),Ze=n("yl8S"),Xe=n("M34a"),qe=n("YDIV"),Ke=n("DKSB");const Je=function(){return["/my-absences"]};let Ye=(()=>{class e{constructor(){this.filter={dateFrom:null,dateTo:null},this.filterChange=new I.n,this.minDate={year:(new Date).getFullYear(),month:(new Date).getMonth()+1,day:(new Date).getDate()}}ngOnInit(){}updateDateFrom(e){this.filter.dateFrom=e,e&&(this.filter.dateTo=e)}show(){this.filterChange.emit({dateFrom:Ve(this.filter.dateFrom),dateTo:Ve(this.filter.dateTo)})}}return e.\u0275fac=function(t){return new(t||e)},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-report-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},features:[I.yb([{provide:E.c,useClass:E.d},{provide:E.e,useClass:qe.a}])],decls:22,vars:18,consts:[[1,"backlink"],[1,"btn","btn-link","py-2","text-body",3,"routerLink"],[1,"material-icons","d-block"],[1,"filters"],[1,"form-group"],[3,"minDate","value","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,t){1&e&&(I.Sb(0,"div",0),I.Sb(1,"a",1),I.Sb(2,"i",2),I.Dc(3,"navigate_before"),I.Rb(),I.Rb(),I.Sb(4,"div"),I.Dc(5),I.gc(6,"translate"),I.Rb(),I.Rb(),I.Sb(7,"div",3),I.Sb(8,"div",4),I.Sb(9,"label"),I.Dc(10),I.gc(11,"translate"),I.Rb(),I.Sb(12,"erz-date-select",5),I.dc("valueChange",function(e){return t.updateDateFrom(e)}),I.Rb(),I.Rb(),I.Sb(13,"div",4),I.Sb(14,"label"),I.Dc(15),I.gc(16,"translate"),I.Rb(),I.Sb(17,"erz-date-select",5),I.dc("valueChange",function(e){return t.filter.dateTo=e}),I.Rb(),I.Rb(),I.Sb(18,"div",6),I.Sb(19,"button",7),I.dc("click",function(){return t.show()}),I.Dc(20),I.gc(21,"translate"),I.Rb(),I.Rb(),I.Rb()),2&e&&(I.zb(1),I.lc("routerLink",I.oc(17,Je)),I.zb(4),I.Ec(I.hc(6,9,"my-absences.report.title")),I.zb(5),I.Ec(I.hc(11,11,"my-absences.report.header.date-from")),I.zb(2),I.lc("minDate",t.minDate)("value",t.filter.dateFrom),I.zb(3),I.Ec(I.hc(16,13,"my-absences.report.header.date-to")),I.zb(2),I.lc("minDate",t.minDate)("value",t.filter.dateTo),I.zb(3),I.Fc(" ",I.hc(21,15,"my-absences.report.header.show")," "))},directives:[s.i,Ke.a],pipes:[_.c],styles:["[_nghost-%COMP%]{display:block;padding:1.5rem;border-bottom:1px solid #dee2e6}.backlink[_ngcontent-%COMP%]{display:flex;align-items:center;margin-bottom:1.5rem}.backlink[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{margin-left:-1.5rem}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),e})();function Ve(e){return e?Object(Xe.a)(e):null}var We=n("4Kj8"),et=n("73sZ");function tt(e,t){if(1&e){const e=I.Tb();I.Sb(0,"div",12),I.Sb(1,"input",13,29),I.dc("change",function(){I.vc(e);const t=I.fc(2).$implicit;return I.fc(6).selectionService.toggle(t)}),I.gc(3,"async"),I.Rb(),I.Rb()}if(2&e){const e=I.fc(2).$implicit,t=I.fc(6);I.zb(1),I.lc("checked",I.hc(3,1,t.selectionService.isSelected$(e)))}}function nt(e,t){if(1&e&&(I.Sb(0,"div"),I.Sb(1,"i",17),I.Dc(2),I.Rb(),I.Rb()),2&e){const e=I.fc().erzLet;I.Cb("checkbox presence-category ",e.category,""),I.zb(2),I.Ec(e.icon)}}function ct(e,t){if(1&e&&(I.Qb(0),I.Bc(1,tt,4,3,"div",27),I.Bc(2,nt,3,4,"ng-template",null,28,I.Cc),I.Pb()),2&e){const e=t.erzLet,n=I.uc(3);I.zb(1),I.lc("ngIf",!e)("ngIfElse",n)}}function st(e,t){if(1&e&&(I.Qb(0),I.Dc(1),I.Pb()),2&e){const e=I.fc().$implicit;I.zb(1),I.Fc(", ",e.StudyClassNumber,"")}}function it(e,t){if(1&e&&(I.Sb(0,"div",31),I.Dc(1),I.Rb()),2&e){const e=I.fc().erzLet;I.zb(1),I.Fc(" ",e," ")}}function rt(e,t){if(1&e&&(I.Qb(0),I.Bc(1,it,2,1,"div",30),I.Pb()),2&e){const e=t.erzLet;I.zb(1),I.lc("ngIf",e)}}function at(e,t){if(1&e){const e=I.Tb();I.Sb(0,"div",19,20),I.dc("click",function(t){I.vc(e);const n=I.uc(1);return I.fc(6).onRowClick(t,n)}),I.Bc(2,ct,4,2,"ng-container",0),I.gc(3,"async"),I.Sb(4,"div",21),I.Dc(5),I.Bc(6,st,2,1,"ng-container",8),I.Rb(),I.Sb(7,"div",22),I.Dc(8),I.gc(9,"date"),I.gc(10,"date"),I.Rb(),I.Sb(11,"div",23),I.Dc(12),I.Rb(),I.Bc(13,rt,2,1,"ng-container",0),I.gc(14,"async"),I.Sb(15,"div",24),I.Dc(16),I.gc(17,"date"),I.Rb(),I.Sb(18,"div",25),I.Dc(19),I.gc(20,"erzDaysDifference"),I.Rb(),I.Sb(21,"div",26),I.Dc(22),I.gc(23,"date"),I.gc(24,"erzDaysDifference"),I.Rb(),I.Rb()}if(2&e){const e=t.$implicit,n=I.fc(6);I.zb(2),I.lc("erzLet",I.hc(3,11,n.getPresenceCategory(e))),I.zb(3),I.Fc(" ",e.EventDesignation,""),I.zb(1),I.lc("ngIf",e.StudyClassNumber),I.zb(2),I.Gc(" ",I.ic(9,13,e.LessonDateTimeFrom,"HH:mm"),"\u2013",I.ic(10,16,e.LessonDateTimeTo,"HH:mm")," "),I.zb(4),I.Fc(" ",e.TeacherInformation," "),I.zb(1),I.lc("erzLet",I.hc(14,19,n.getPresenceTypeDesignation(e))),I.zb(3),I.Fc(" ",I.ic(17,21,e.LessonDateTimeFrom,"dd.MM.yyyy")," "),I.zb(3),I.Fc(" ",I.hc(20,24,e.LessonDateTimeFrom)," "),I.zb(3),I.Gc(" ",I.ic(23,26,e.LessonDateTimeFrom,"dd.MM.yyyy"),", ",I.hc(24,29,e.LessonDateTimeFrom)," ")}}function ot(e,t){if(1&e){const e=I.Tb();I.Sb(0,"div"),I.Sb(1,"div",10,11),I.dc("click",function(t){I.vc(e);const n=I.uc(2);return I.fc(5).onRowClick(t,n)}),I.Sb(3,"div",12),I.Sb(4,"input",13),I.dc("change",function(t){return I.vc(e),I.fc(5).toggleAll(t.target.checked)}),I.gc(5,"async"),I.Rb(),I.Rb(),I.Sb(6,"div",14),I.Dc(7),I.gc(8,"translate"),I.Rb(),I.Sb(9,"div",15),I.Sb(10,"a",16),I.gc(11,"async"),I.Sb(12,"i",17),I.Dc(13,"edit"),I.Rb(),I.Rb(),I.Rb(),I.Rb(),I.Bc(14,at,25,31,"div",18),I.Rb()}if(2&e){const e=I.fc(4).erzLet,t=I.fc();I.zb(4),I.lc("checked",I.hc(5,5,t.allSelected$)),I.zb(3),I.Fc(" ",I.hc(8,7,"my-absences.report.list.all")," "),I.zb(3),I.Eb("disabled",0===I.hc(11,9,t.selectionService.selection$).length),I.zb(4),I.lc("ngForOf",e.entries)}}function bt(e,t){1&e&&I.Nb(0,"erz-spinner",32)}function lt(e,t){if(1&e&&(I.Sb(0,"div",7),I.Bc(1,ot,15,11,"div",8),I.Bc(2,bt,1,0,"erz-spinner",9),I.Rb()),2&e){const e=I.fc(3).erzLet;I.zb(1),I.lc("ngIf",e.entries&&e.entries.length>0),I.zb(1),I.lc("ngIf",e.loadingPage)}}function dt(e,t){1&e&&(I.Sb(0,"p",33),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e&&(I.zb(1),I.Fc(" ",I.hc(2,1,"my-absences.report.no-entries")," "))}function ut(e,t){if(1&e&&(I.Qb(0),I.Bc(1,lt,3,2,"div",5),I.Bc(2,dt,3,3,"ng-template",null,6,I.Cc),I.Pb()),2&e){const e=I.uc(3),t=I.fc(2).erzLet;I.zb(1),I.lc("ngIf",t.entries&&t.entries.length>0||t.loadingPage)("ngIfElse",e)}}function ft(e,t){1&e&&I.Nb(0,"erz-spinner")}function pt(e,t){if(1&e&&(I.Qb(0),I.Bc(1,ut,4,2,"ng-container",2),I.gc(2,"async"),I.Bc(3,ft,1,0,"ng-template",null,4,I.Cc),I.Pb()),2&e){const e=I.uc(4),t=I.fc(2);I.zb(1),I.lc("ngIf",!I.hc(2,2,t.state.loading$))("ngIfElse",e)}}function gt(e,t){1&e&&(I.Sb(0,"p",33),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e&&(I.zb(1),I.Ec(I.hc(2,1,"my-absences.report.no-filter")))}function mt(e,t){if(1&e){const e=I.Tb();I.Qb(0),I.Sb(1,"erz-my-absences-report-header",1),I.dc("filterChange",function(t){return I.vc(e),I.fc().state.setFilter(t)}),I.gc(2,"async"),I.Rb(),I.Bc(3,pt,5,4,"ng-container",2),I.gc(4,"async"),I.Bc(5,gt,3,3,"ng-template",null,3,I.Cc),I.Pb()}if(2&e){const e=I.uc(6),t=I.fc();I.zb(1),I.lc("filter",I.hc(2,3,t.filterFromParams$)),I.zb(2),I.lc("ngIf",I.hc(4,5,t.state.isFilterValid$))("ngIfElse",e)}}const ht=function(e,t,n){return{selection:e,entries:t,loadingPage:n}};function yt(e){return{dateFrom:e.dateFrom?Object(He.c)(e.dateFrom):null,dateTo:e.dateTo?Object(He.c)(e.dateTo):null}}const vt=function(e){return{count:e}};function St(e,t){if(1&e&&(I.Sb(0,"div",10),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e){const e=t.erzLet;I.zb(1),I.Fc(" ",I.ic(2,1,1===e?"my-absences.confirm.lesson-selected":"my-absences.confirm.lessons-selected",I.pc(4,vt,e))," ")}}function It(e,t){if(1&e&&(I.Sb(0,"div",16),I.Dc(1),I.gc(2,"translate"),I.Rb()),2&e){const e=t.$implicit;I.zb(1),I.Fc(" ",I.ic(2,1,"global.validation-errors."+e.error,e.params)," ")}}function zt(e,t){if(1&e&&(I.Qb(0),I.Bc(1,It,3,4,"div",15),I.gc(2,"async"),I.Pb()),2&e){const e=I.fc(2);I.zb(1),I.lc("ngForOf",I.hc(2,1,e.absenceTypeIdErrors$))}}const Ot=function(e){return{"border-top pt-3":e}};function Rt(e,t){if(1&e&&(I.Sb(0,"div",11),I.Nb(1,"input",12),I.gc(2,"async"),I.Sb(3,"label",13),I.Dc(4),I.Rb(),I.Bc(5,zt,3,3,"ng-container",14),I.gc(6,"async"),I.Rb()),2&e){const e=t.$implicit,n=t.index,c=I.fc();let s=null;I.lc("ngClass",I.pc(12,Ot,e.IsHalfDay)),I.zb(1),I.Eb("is-invalid",I.hc(2,8,c.absenceTypeIdErrors$).length>0),I.lc("id","absence-type-"+n)("value",e.Id),I.zb(2),I.lc("for","absence-type-"+n),I.zb(1),I.Fc(" ",e.Designation," "),I.zb(1),I.lc("ngIf",(null==(s=I.hc(6,10,c.absenceTypes$))?null:s.length)-1===n)}}function Ct(e,t){1&e&&(I.Sb(0,"div",17),I.Sb(1,"span",18),I.Dc(2,"Loading..."),I.Rb(),I.Rb())}const $t=[{path:"",component:O,children:[{path:"",component:ue},{path:"confirm",component:Pe},{path:"report",component:Ne,children:[{path:"",component:(()=>{class e{constructor(e,t,n,c,s,i){this.state=e,this.selectionService=t,this.route=n,this.scrollPosition=c,this.presenceTypesService=s,this.settings=i,this.filterFromParams$=this.route.queryParams.pipe(Object(l.a)(yt)),this.allSelected$=Object(r.a)([this.selectionService.selection$,this.state.entries$.pipe(Object(a.a)(e=>Object(r.a)(e.map(e=>this.getPresenceType(e)))))]).pipe(Object(l.a)(([e,t])=>e.length>0&&e.length===t.filter(Object(v.d)(Qe.c)).length)),this.destroy$=new R.a}ngOnInit(){this.filterFromParams$.pipe(Object(d.a)(1)).subscribe(e=>this.state.setFilter(e)),this.state.validFilter$.pipe(Object(Ge.a)(this.destroy$)).subscribe(()=>this.selectionService.clear())}ngAfterViewInit(){this.scrollPosition.restore()}ngOnDestroy(){this.destroy$.next()}getPresenceCategory(e){return this.getPresenceType(e).pipe(Object(l.a)(t=>Object(Qe.c)(t)?e.ConfirmationStateId===this.settings.checkableAbsenceStateId?{category:Ue.a.Unapproved,icon:Object(Ue.c)(Ue.a.Unapproved)}:{category:Ue.a.Absent,icon:Object(Ue.c)(Ue.a.Absent)}:null))}getPresenceTypeDesignation(e){return this.presenceTypesService.displayedTypes$.pipe(Object(l.a)(t=>{var n;return e.TypeRef.Id&&(null===(n=t.find(t=>t.Id===e.TypeRef.Id))||void 0===n?void 0:n.Designation)||null}))}toggleAll(e){Object(r.a)([this.state.entries$.pipe(Object(d.a)(1)),this.presenceTypesService.presenceTypes$.pipe(Object(d.a)(1))]).subscribe(([t,n])=>{const c=n.filter(e=>Object(Qe.c)(e)).map(e=>e.Id);this.selectionService.clear(e?t.filter(e=>null==e.TypeRef.Id||!c.includes(e.TypeRef.Id)):null)})}onRowClick(e,t){const n=t.querySelector('input[type="checkbox"]');n&&e.target!==n&&!Boolean(e.target.closest(".buttons"))&&n.click()}getPresenceType(e){return this.presenceTypesService.presenceTypes$.pipe(Object(l.a)(t=>e.TypeRef.Id&&t.find(t=>t.Id===e.TypeRef.Id)||null))}}return e.\u0275fac=function(t){return new(t||e)(I.Mb(we),I.Mb(Ee),I.Mb(s.a),I.Mb(Ze.a),I.Mb(ye.a),I.Mb(g.a))},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-report-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],[4,"ngIf"],["class","inline",4,"ngIf"],[1,"entries-all",3,"click"],["all",""],[1,"checkbox"],["type","checkbox",1,"form-check-input",3,"checked","change"],[1,"all"],[1,"buttons"],["routerLink","confirm",1,"edit","btn","btn-primary","mr-2"],[1,"material-icons"],["class","entry",3,"click",4,"ngFor","ngForOf"],[1,"entry",3,"click"],["row",""],[1,"lesson-class"],[1,"time","pr-2"],[1,"teacher"],[1,"date"],[1,"days-ago"],[1,"date-days-ago"],["class","checkbox",4,"ngIf","ngIfElse"],["categoryIcon",""],["checkbox",""],["class","presence-type",4,"ngIf"],[1,"presence-type"],[1,"inline"],[1,"mt-3","px-3"]],template:function(e,t){1&e&&(I.Bc(0,mt,7,7,"ng-container",0),I.gc(1,"async"),I.gc(2,"async"),I.gc(3,"async")),2&e&&I.lc("erzLet",I.rc(7,ht,I.hc(1,1,t.selectionService.selection$),I.hc(2,3,t.state.entries$),I.hc(3,5,t.state.loadingPage$)))},directives:[B.a,Ye,U.m,s.i,U.l,We.a],pipes:[U.b,_.c,U.e,et.a],styles:['.entries-all[_ngcontent-%COMP%]{padding:0 0 .75rem 1.5rem;grid-template-areas:"checkbox all buttons";grid-template-columns:-webkit-min-content 1fr -webkit-min-content;grid-template-columns:min-content 1fr min-content}.entries-all[_ngcontent-%COMP%], .entry[_ngcontent-%COMP%]{border-bottom:1px solid #e9ecef;display:grid}.entry[_ngcontent-%COMP%]{padding:1.5rem;grid-template-areas:"checkbox lesson-class time teacher" "checkbox presence-type date days-ago";grid-template-columns:-webkit-min-content 2fr 1fr 2fr;grid-template-columns:min-content 2fr 1fr 2fr}.entry[_ngcontent-%COMP%]:first-child{padding-top:0}.entries-all[_ngcontent-%COMP%] + .entry[_ngcontent-%COMP%]{padding-top:1.5rem}.presence-category.absent[_ngcontent-%COMP%]{color:#dc3545}.presence-category.unapproved[_ngcontent-%COMP%]{color:#ffa814}.checkbox[_ngcontent-%COMP%]{grid-area:checkbox;margin:0;padding:.6rem .75rem 0 0}.presence-category[_ngcontent-%COMP%]   .material-icons[_ngcontent-%COMP%]{display:block;font-size:16px}.entries-all[_ngcontent-%COMP%]   .checkbox[_ngcontent-%COMP%]{padding-top:.2rem}.checkbox[_ngcontent-%COMP%]   input.form-check-input[_ngcontent-%COMP%]{position:static!important;margin:0!important;display:block}.all[_ngcontent-%COMP%]{grid-area:all}.buttons[_ngcontent-%COMP%]{grid-area:buttons;display:flex}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{line-height:1;font-size:2.2rem}.lesson-class[_ngcontent-%COMP%]{grid-area:lesson-class;overflow:hidden;white-space:nowrap;text-overflow:ellipsis}.time[_ngcontent-%COMP%]{grid-area:time}.teacher[_ngcontent-%COMP%]{grid-area:teacher}.presence-type[_ngcontent-%COMP%]{color:#adb5bd;grid-area:presence-type}.date[_ngcontent-%COMP%]{grid-area:date}.days-ago[_ngcontent-%COMP%]{color:#adb5bd;grid-area:days-ago}.date-days-ago[_ngcontent-%COMP%]{grid-area:date-days-ago;display:none}@media (max-width:750px){.entry[_ngcontent-%COMP%]{grid-template-areas:"checkbox lesson-class" "checkbox teacher" "checkbox date-days-ago" "checkbox time" "checkbox presence-type";grid-template-columns:-webkit-min-content 1fr;grid-template-columns:min-content 1fr}.date-days-ago[_ngcontent-%COMP%]{display:block}.date[_ngcontent-%COMP%], .days-ago[_ngcontent-%COMP%]{display:none}}'],changeDetection:0}),e})(),data:{restoreScrollPositionFrom:["/my-absences/report/confirm"]}},{path:"confirm",component:(()=>{class e extends Ie{constructor(e,t,n,c,s,i,r,a,o,b){super(e,t,n,c,s,i,r,a),this.state=o,this.selectionService=b,this.selectedLessonIds$=this.selectionService.selectedIds$.pipe(Object(l.a)(e=>Object(T.a)(w(e.map(e=>e.lessonIds))))),this.confirmationStateId=this.settings.checkableAbsenceStateId}getHalfDayType(){return this.presenceTypesService.getPresenceType(this.settings.halfDayPresenceTypeId).pipe(Object(l.a)(e=>e.Active?e:null))}onSaveSuccess(){this.selectionService.clear(),this.state.resetEntries(),super.onSaveSuccess()}navigateBack(){this.state.queryParams$.pipe(Object(d.a)(1)).subscribe(e=>{this.router.navigate(["/my-absences/report"],{queryParams:e})})}}return e.\u0275fac=function(t){return new(t||e)(I.Mb(fe.c),I.Mb(s.g),I.Mb(Se.b),I.Mb(_.d),I.Mb(ye.a),I.Mb(he.a),I.Mb(m.a),I.Mb(g.a),I.Mb(we),I.Mb(Ee))},e.\u0275cmp=I.Gb({type:e,selectors:[["erz-my-absences-confirm"]],features:[I.wb],decls:25,vars:32,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y"],["class","mb-3 pb-3 border-bottom",4,"erzLet"],[3,"formGroup","ngSubmit"],[1,"form-group","mb-3","border-bottom"],["class","form-check my-3",3,"ngClass",4,"ngFor","ngForOf"],[1,"remark"],[1,"d-flex","justify-content-end"],["type","button",1,"btn","btn-secondary",3,"disabled","click"],["type","submit",1,"btn","btn-primary","ml-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"mb-3","pb-3","border-bottom"],[1,"form-check","my-3",3,"ngClass"],["type","radio","formControlName","absenceTypeId",1,"form-check-input",3,"id","value"],[1,"form-check-label",3,"for"],[4,"ngIf"],["class","invalid-feedback mt-4",4,"ngFor","ngForOf"],[1,"invalid-feedback","mt-4"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"sr-only"]],template:function(e,t){1&e&&(I.Sb(0,"div",0),I.Bc(1,St,3,6,"div",1),I.gc(2,"async"),I.Sb(3,"form",2),I.dc("ngSubmit",function(){return t.onSubmit()}),I.Sb(4,"div",3),I.Sb(5,"label"),I.Dc(6),I.gc(7,"translate"),I.gc(8,"addSpace"),I.Rb(),I.Bc(9,Rt,7,14,"div",4),I.gc(10,"async"),I.Rb(),I.Sb(11,"div",5),I.Dc(12),I.gc(13,"translate"),I.Rb(),I.Sb(14,"div",6),I.Sb(15,"button",7),I.dc("click",function(){return t.cancel()}),I.gc(16,"async"),I.Dc(17),I.gc(18,"translate"),I.Rb(),I.Sb(19,"button",8),I.gc(20,"async"),I.Dc(21),I.gc(22,"translate"),I.Bc(23,Ct,3,0,"div",9),I.gc(24,"async"),I.Rb(),I.Rb(),I.Rb(),I.Rb()),2&e&&(I.zb(1),I.lc("erzLet",I.hc(2,11,t.getSelectedCount())),I.zb(2),I.lc("formGroup",t.formGroup),I.zb(3),I.Gc("",I.hc(7,13,"my-absences.confirm.choose-presence-type"),"",I.ic(8,15,":",":"),""),I.zb(3),I.lc("ngForOf",I.hc(10,18,t.absenceTypes$)),I.zb(3),I.Fc(" ",I.hc(13,20,"my-absences.confirm.remark")," "),I.zb(3),I.lc("disabled",I.hc(16,22,t.saving$)),I.zb(2),I.Fc(" ",I.hc(18,24,"my-absences.confirm.cancel")," "),I.zb(2),I.lc("disabled",I.hc(20,26,t.saving$)),I.zb(2),I.Fc(" ",I.hc(22,28,"my-absences.confirm.save")," "),I.zb(2),I.lc("ngIf",I.hc(24,30,t.saving$)))},directives:[B.a,fe.r,fe.j,fe.e,U.l,U.m,U.k,fe.n,fe.b,fe.i,fe.d],pipes:[U.b,_.c,ze.a],styles:[""],changeDetection:0}),e})()}]}]}];let kt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=I.Kb({type:e}),e.\u0275inj=I.Jb({imports:[[s.j.forChild($t)],s.j]}),e})(),Dt=(()=>{class e{}return e.\u0275fac=function(t){return new(t||e)},e.\u0275mod=I.Kb({type:e}),e.\u0275inj=I.Jb({imports:[[c.a,kt]]}),e})()}}]);