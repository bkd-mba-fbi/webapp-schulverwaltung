import{b as ne}from"./chunk-NTSKCSYH.js";import{a as Ze}from"./chunk-DYBK5FKC.js";import{a as Ye}from"./chunk-24TK3FB4.js";import"./chunk-7VKKHU7R.js";import{p as We}from"./chunk-LLGOVPQJ.js";import"./chunk-2H6IFZM2.js";import{e as te}from"./chunk-QOR23F4L.js";import{b as qe}from"./chunk-7FRZV7VF.js";import"./chunk-Y4QYVF5K.js";import"./chunk-OFB4XAK2.js";import{b as Ge,d as z,e as Ke}from"./chunk-VUPOI3TG.js";import"./chunk-WACRWBCS.js";import"./chunk-MIRGHONI.js";import"./chunk-YUHFF3NM.js";import{L as Ve,b as ze,g as me,p as Ue,q as He}from"./chunk-H6G6Q6V6.js";import"./chunk-NL5E3FC5.js";import"./chunk-YD3RJIHU.js";import{a as ee,b as ie}from"./chunk-KK2SHN2W.js";import{u as Ne}from"./chunk-AP373D4K.js";import"./chunk-B6WYZ7BT.js";import{$a as de,Ab as S,Bb as j,Cc as Oe,Cd as we,Dc as Le,Dd as Be,Gb as o,Gd as je,Ha as p,Hb as r,Ib as R,Ic as X,Jd as k,Kb as Me,Kd as E,La as se,Ld as Fe,M as v,Ma as f,Na as ve,O as fe,P as T,Ra as m,S as _e,Ua as ye,Va as Se,Wa as c,X as F,Xa as d,Ya as _,Yb as Ie,Yc as I,Zb as L,_ as D,_b as J,a as K,aa as y,ab as xe,b as W,cb as N,cc as pe,d as ue,da as Ce,db as u,eb as Te,fb as De,g as re,gc as Q,h as be,ia as Y,ja as Z,ka as ge,l as O,lc as ke,mb as ce,n as h,nb as l,o as V,ob as $,pb as P,qb as le,rb as Pe,sc as Ee,tc as Ae,uc as Re,va as w,wa as a,wb as B,xa as g,xb as G,yb as q,zb as $e}from"./chunk-IFJN5CDK.js";var bt=["*"];function ft(e,s){e&1&&de(0)}function _t(e,s){if(e&1&&(c(0,"a",1),p(1,ft,1,0,"ng-container",3),d()),e&2){let t=u(),i=ce(3);f("routerLink",t.link)("queryParams",t.linkParams),a(),f("ngTemplateOutlet",i)}}function Ct(e,s){e&1&&de(0)}function gt(e,s){if(e&1&&(c(0,"a",2),p(1,Ct,1,0,"ng-container",3),d()),e&2){let t=u(),i=ce(3);f("href",t.externalLink,w),a(),f("ngTemplateOutlet",i)}}function vt(e,s){if(e&1&&(c(0,"span",5),l(1),d()),e&2){let t=u(2);a(),$(t.count)}}function yt(e,s){e&1&&(ge(),c(0,"svg",6),_(1,"path",7),d())}function St(e,s){if(e&1&&(c(0,"span",4),l(1),o(2,"translate"),d(),c(3,"div"),De(4),p(5,vt,2,1,"span",5)(6,yt,2,0,":svg:svg",6),d()),e&2){let t=u();a(),$(r(2,2,t.label)),a(4),m(t.hasCount(t.count)?5:6)}}var Je=(()=>{class e{constructor(){}hasCount(t){return typeof t=="number"&&t>=0}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-action"]],inputs:{label:"label",count:"count",link:"link",linkParams:"linkParams",externalLink:"externalLink"},standalone:!0,features:[S],ngContentSelectors:bt,decls:4,vars:2,consts:[["actionContent",""],[3,"routerLink","queryParams"],[3,"href"],[4,"ngTemplateOutlet"],[1,"label"],[1,"count"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none"],["fill","currentColor","d","m12 20-1.425-1.4 5.6-5.6H4v-2h12.175l-5.6-5.6L12 4l8 8-8 8Z"]],template:function(i,n){i&1&&(Te(),p(0,_t,2,3,"a",1)(1,gt,2,2,"a",2)(2,St,7,4,"ng-template",null,0,Me)),i&2&&(m(n.externalLink?-1:0),a(),m(n.externalLink?1:-1))},dependencies:[Re,Ie,E,k],styles:["a[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:space-between;align-items:center;padding:1rem 1.5rem;background:#f7e9d2;text-decoration:none;line-height:1}a[_ngcontent-%COMP%]:hover{background:#f2e0c3}a[_ngcontent-%COMP%]:focus-visible{outline-width:2px;outline-offset:-2px}div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.label[_ngcontent-%COMP%]{font-weight:400}.count[_ngcontent-%COMP%]{font-size:1.5rem}"]})}}return e})();var Qe=(()=>{class e{constructor(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-deadline"]],inputs:{count:"count"},standalone:!0,features:[S],decls:3,vars:8,template:function(i,n){i&1&&(l(0),o(1,"translate"),o(2,"addSpace")),i&2&&Pe("",r(1,3,"dashboard.actions.deadline"),"",R(2,5,": ",":"),"",n.count,`
`)},dependencies:[E,k,Ke],styles:["[_nghost-%COMP%]{background:#ea161f;color:#fff;white-space:nowrap;font-weight:500;font-size:.875rem;min-height:1.5rem;display:flex;padding:.375rem .5rem;align-items:center;border-radius:2.5rem}"]})}}return e})();var Xe=X({Id:Le,Holder:Oe});var et=(()=>{class e extends ee{constructor(t,i){super(t,i,Xe,"TeacherSubstitutions")}getTeacherSubstitution(t){return this.getList({params:{"filter.Id":`=${t}`}}).pipe(h(i=>i[0]||null))}static{this.\u0275fac=function(i){return new(i||e)(D(Q),D(I))}}static{this.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var Mt=["LessonTeacherRole","ClassTeacherRole","TeacherRole","AbsenceAdministratorRole"],It=["LessonTeacherRole","TeacherRole","StudentRole","SubstituteAdministratorRole"],kt=["LessonTeacherRole","StudentRole"],A=(()=>{class e{constructor(t,i,n,b,x,U,H,ut){this.settingsService=t,this.lessonPresencesService=i,this.studentsService=n,this.courseService=b,this.teacherSubstitutionService=x,this.personService=U,this.storageService=H,this.settings=ut,this.rolesAndPermissions$=this.settingsService.getRolesAndPermissions(),this.userId$=new be(1),this.lessonAbsences$=this.userId$.pipe(T(C=>this.studentsService.getLessonAbsences(C)),v(1)),this.lessonIncidents$=this.userId$.pipe(T(C=>this.studentsService.getLessonIncidents(C)),v(1)),this.loading$=this.rolesAndPermissions$.pipe(h(C=>C==null)),this.hasSearch$=this.rolesAndPermissions$.pipe(h(this.hasRoles(Mt))),this.hasActions$=this.rolesAndPermissions$.pipe(h(this.hasRoles(It))),this.hasTimetable$=this.rolesAndPermissions$.pipe(h(this.hasRoles(kt))),this.hasLessonTeacherRole$=this.rolesAndPermissions$.pipe(h(this.hasRoles(["LessonTeacherRole"])),v(1)),this.hasTeacherRole$=this.rolesAndPermissions$.pipe(h(this.hasRoles(["TeacherRole"])),v(1)),this.hasStudentRole$=this.rolesAndPermissions$.pipe(h(this.hasRoles(["StudentRole"])),v(1)),this.hasSubstituteAdministratorRole$=this.rolesAndPermissions$.pipe(h(this.hasRoles(["SubstituteAdministratorRole"])),v(1)),this.editAbsencesCount$=this.hasLessonTeacherRole$.pipe(T(C=>C?this.lessonPresencesService.checkableAbsencesCount():O(!1)),v(1)),this.openAbsencesCount$=this.rolesAndPermissions$.pipe(h(this.hasRoles(["LessonTeacherRole","ClassTeacherRole"])),T(C=>C?this.lessonPresencesService.getListOfUnconfirmed():O([])),h(C=>C.length),v(1)),this.myAbsencesCount$=this.hasStudentRole$.pipe(T(C=>C?this.getMyAbsences():O([])),h(this.getMyAbsencesCount.bind(this)),v(1)),this.coursesToRateCount$=this.courseService.getNumberOfCoursesForRating().pipe(fe(0),v(1)),this.hasPresenceControl$=this.hasLessonTeacherRole$.pipe(T(C=>C?this.lessonPresencesService.hasLessonsLessonTeacher():O(!1)),v(1)),this.hasOpenAbsences$=this.openAbsencesCount$.pipe(h(C=>C>0),v(1)),this.editAbsencesParams$=this.getFullName().pipe(h(C=>({confirmationStates:this.settings.checkableAbsenceStateId,teacher:C})),v(1));let he=this.storageService.getPayload()?.id_person;he&&this.userId$.next(Number(he))}hasRoles(t){return i=>(i??[]).some(n=>t.includes(n))}getMyAbsences(){return V([this.userId$,this.lessonAbsences$,this.lessonIncidents$]).pipe(T(([t,i,n])=>this.loadTimetableEntries(t,i,n).pipe(h(b=>[...i,...n].map(x=>this.withTimetableEntry(x,b)).filter(Ne)))))}getMyAbsencesCount(t){return t?.filter(i=>("ConfirmationStateId"in i?i.ConfirmationStateId:null)===this.settings.unconfirmedAbsenceStateId).length||0}getFullName(){let t=Number(this.storageService.getPayload()?.substitution_id)||null;return t?this.teacherSubstitutionService.getTeacherSubstitution(t).pipe(h(i=>i?.Holder)):this.personService.getMyself().pipe(h(i=>i.FullName))}withTimetableEntry(t,i){return i.find(n=>n.Id===t.LessonRef.Id)?t:null}loadTimetableEntries(t,i,n){return this.studentsService.getTimetableEntries(t,{"filter.Id":`;${[...i,...n].map(b=>b.LessonRef.Id).join(";")}`})}static{this.\u0275fac=function(i){return new(i||e)(D(ne),D(te),D(z),D(We),D(et),D(qe),D(Fe),D(I))}}static{this.\u0275prov=F({token:e,factory:e.\u0275fac})}}return e})();var Et=()=>["/presence-control"],At=()=>["/edit-absences"],Rt=()=>["/open-absences"],Ot=()=>["/events"],Lt=()=>["/my-absences","report"],wt=()=>["/my-absences"];function Bt(e,s){e&1&&_(0,"bkd-dashboard-action",0),e&2&&f("label","dashboard.actions.presence-control")("link",j(2,Et))}function jt(e,s){if(e&1&&(_(0,"bkd-dashboard-action",1),o(1,"async"),o(2,"async")),e&2){let t=u();f("label","dashboard.actions.edit-absences")("link",j(8,At))("linkParams",r(1,4,t.dashboardService.editAbsencesParams$))("count",r(2,6,t.dashboardService.editAbsencesCount$))}}function Ft(e,s){if(e&1&&(_(0,"bkd-dashboard-action",2),o(1,"async")),e&2){let t=u();f("label","dashboard.actions.open-absences")("link",j(5,Rt))("count",r(1,3,t.dashboardService.openAbsencesCount$))}}function Nt(e,s){if(e&1&&(_(0,"bkd-dashboard-deadline",4),o(1,"async")),e&2){let t=u(2);f("count",r(1,1,t.dashboardService.coursesToRateCount$))}}function zt(e,s){if(e&1&&(c(0,"bkd-dashboard-action",0),p(1,Nt,2,3,"bkd-dashboard-deadline",4),o(2,"async"),d()),e&2){let t,i=u();f("label","dashboard.actions.tests")("link",j(5,Ot)),a(),m((t=r(2,3,i.dashboardService.coursesToRateCount$))!==null&&t!==void 0&&t?1:-1)}}function Ut(e,s){e&1&&_(0,"bkd-dashboard-action",0),e&2&&f("label","dashboard.actions.my-absences-report")("link",j(2,Lt))}function Ht(e,s){if(e&1&&(_(0,"bkd-dashboard-action",2),o(1,"async")),e&2){let t=u();f("label","dashboard.actions.my-absences")("link",j(5,wt))("count",r(1,3,t.dashboardService.myAbsencesCount$))}}function Vt(e,s){if(e&1&&_(0,"bkd-dashboard-action",3),e&2){let t=u();f("label","dashboard.actions.substitutions")("externalLink",t.substitutionsAdminLink)}}var it=(()=>{class e{constructor(t,i){this.dashboardService=t,this.settings=i}get substitutionsAdminLink(){return this.settings.dashboard.substitutionsAdminLink}static{this.\u0275fac=function(i){return new(i||e)(g(A),g(I))}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-actions"]],standalone:!0,features:[S],decls:15,vars:23,consts:[[3,"label","link"],[3,"label","link","linkParams","count"],[3,"label","link","count"],[3,"label","externalLink"],[3,"count"]],template:function(i,n){i&1&&(p(0,Bt,1,3,"bkd-dashboard-action",0),o(1,"async"),p(2,jt,3,9,"bkd-dashboard-action",1),o(3,"async"),o(4,"async"),p(5,Ft,2,6,"bkd-dashboard-action",2),o(6,"async"),p(7,zt,3,6,"bkd-dashboard-action",0),o(8,"async"),p(9,Ut,1,3,"bkd-dashboard-action",0),o(10,"async"),p(11,Ht,2,6,"bkd-dashboard-action",2),o(12,"async"),p(13,Vt,1,2,"bkd-dashboard-action",3),o(14,"async")),i&2&&(m(r(1,7,n.dashboardService.hasPresenceControl$)?0:-1),a(2),m(r(3,9,n.dashboardService.hasLessonTeacherRole$)&&r(4,11,n.dashboardService.editAbsencesParams$)?2:-1),a(3),m(r(6,13,n.dashboardService.hasOpenAbsences$)?5:-1),a(2),m(r(8,15,n.dashboardService.hasTeacherRole$)?7:-1),a(2),m(r(10,17,n.dashboardService.hasStudentRole$)?9:-1),a(2),m(r(12,19,n.dashboardService.hasStudentRole$)?11:-1),a(2),m(r(14,21,n.dashboardService.hasSubstituteAdministratorRole$)?13:-1))},dependencies:[Je,Qe,L],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}"]})}}return e})();var nt=(()=>{class e{constructor(t,i){this.studentsRestService=t,this.router=i}navigateToDossier(t){return ue(this,null,function*(){let i=Number(t);yield this.router.navigate(["dashboard","student",i,"addresses"])})}static{this.\u0275fac=function(i){return new(i||e)(g(z),g(Ae))}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-search"]],standalone:!0,features:[S],decls:1,vars:2,consts:[[3,"valueChange","typeaheadService","placeholder"]],template:function(i,n){i&1&&(c(0,"bkd-typeahead",0),N("valueChange",function(x){return x&&n.navigateToDossier(x)}),d()),i&2&&f("typeaheadService",n.studentsRestService)("placeholder","dashboard.search.placeholder")},dependencies:[Ze],styles:["[_nghost-%COMP%]{display:block;padding:.75rem;background:#f7e9d2}"]})}}return e})();var at=(()=>{class e{constructor(t){this.sanitizer=t}transform(t,i){switch(i){case"html":return this.sanitizer.bypassSecurityTrustHtml(t);case"style":return this.sanitizer.bypassSecurityTrustStyle(t);case"script":return this.sanitizer.bypassSecurityTrustScript(t);case"url":return this.sanitizer.bypassSecurityTrustUrl(t);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(t);default:throw new Error(`Invalid safe type specified: ${i}`)}}static{this.\u0275fac=function(i){return new(i||e)(g(ke,16))}}static{this.\u0275pipe=Ce({name:"safe",type:e,pure:!0,standalone:!0})}}return e})();function ot(e){return{id:dt(e.EventId,e.Id),from:e.From,until:e.To,eventId:e.EventId,subject:e.EventDesignation,room:e.EventLocation||void 0,teacher:e.EventManagerInformation||void 0}}function rt(e){let s=e.reduce((t,i)=>{let n=dt(i.EventRef.Id,i.LessonRef.Id);return W(K({},t),{[n]:[...t[n]??[],i.StudyClassNumber]})},{});return Object.keys(s).reduce((t,i)=>W(K({},t),{[i]:we([...s[i]].sort())}),{})}function st(e,s){return e.map(t=>W(K({},t),{studyClass:s[t.id]?.join(", ")}))}function dt(e,s){return`${e}-${s}`}var Gt=(e,s)=>s.id;function qt(e,s){e&1&&(c(0,"th"),l(1),o(2,"translate"),d()),e&2&&(a(),P(" ",r(2,1,"dashboard.timetable.table.teacher")," "))}function Kt(e,s){if(e&1&&(c(0,"a",3),l(1),c(2,"span",8),l(3),d()()),e&2){let t=u().$implicit,i=u(2);f("href",i.buildLink(t.eventId),w),a(),P(" ",t.subject,""),a(2),P(", ",t.studyClass,"")}}function Wt(e,s){if(e&1&&l(0),e&2){let t=u().$implicit;P(" ",t.subject," ")}}function Yt(e,s){if(e&1&&(c(0,"td",4),l(1),o(2,"translate"),d()),e&2){let t=u().$implicit;a(),le(" ",r(2,2,"dashboard.timetable.table.study-class"),": ",t.studyClass," ")}}function Zt(e,s){if(e&1&&(c(0,"td",5),l(1),d()),e&2){let t=u().$implicit;a(),P(" ",t.teacher," ")}}function Jt(e,s){e&1&&(c(0,"span",7),l(1),o(2,"translate"),d()),e&2&&(a(),$(r(2,1,"dashboard.timetable.table.room")))}function Qt(e,s){if(e&1&&(c(0,"tr")(1,"td",1),l(2),o(3,"date"),o(4,"date"),d(),c(5,"td",2),p(6,Kt,4,3,"a",3),o(7,"async"),p(8,Wt,1,1),d(),p(9,Yt,3,4,"td",4),o(10,"async"),p(11,Zt,2,1,"td",5),o(12,"async"),c(13,"td",6),p(14,Jt,3,3,"span",7),l(15),d()()),e&2){let t=s.$implicit,i=u(2);a(2),le(" ",R(3,7,t.from,"HH:mm"),"\u2013",R(4,10,t.until,"HH:mm")," "),a(4),m(r(7,13,i.isTeacher$)?6:8),a(3),m(r(10,15,i.isTeacher$)?9:-1),a(2),m(r(12,17,i.isStudent$)?11:-1),a(3),m(t.room?14:-1),a(),P(" ",t.room," ")}}function Xt(e,s){if(e&1&&(c(0,"table",0)(1,"thead")(2,"tr")(3,"th"),l(4),o(5,"translate"),d(),c(6,"th"),l(7),o(8,"translate"),d(),p(9,qt,3,3,"th"),o(10,"async"),c(11,"th"),l(12),o(13,"translate"),d()()(),c(14,"tbody"),ye(15,Qt,16,19,"tr",null,Gt),d()()),e&2){let t=u();a(4),$(r(5,4,"dashboard.timetable.table.time")),a(3),$(r(8,6,"dashboard.timetable.table.subject")),a(2),m(r(10,8,t.isStudent$)?9:-1),a(3),P(" ",r(13,10,"dashboard.timetable.table.room")," "),a(3),Se(t.entries)}}function ei(e,s){e&1&&(c(0,"p"),l(1),o(2,"translate"),d()),e&2&&(a(),$(r(2,1,"dashboard.timetable.no-entries")))}var ct=(()=>{class e{constructor(t,i){this.dashboardService=t,this.settings=i,this.entries=[],this.isStudent$=this.dashboardService.hasStudentRole$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$}buildLink(t){return this.settings.eventlist.eventdetail.replace(":id",String(t))}static{this.\u0275fac=function(i){return new(i||e)(g(A),g(I))}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-timetable-table"]],inputs:{entries:"entries"},standalone:!0,features:[S],decls:2,vars:1,consts:[[1,"table"],[1,"time"],[1,"subject"],["target","_parent",3,"href"],[1,"study-class"],[1,"teacher"],[1,"room"],[1,"room-label"],[1,"subject-study-class"]],template:function(i,n){i&1&&p(0,Xt,17,12,"table",0)(1,ei,3,3,"p"),i&2&&m(n.entries.length>0?0:1)},dependencies:[L,J,E,k],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:1rem 1.75rem}.room-label[_ngcontent-%COMP%], td.study-class[_ngcontent-%COMP%]{display:none}@media (max-width: 767.98px){table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{border-top:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:"time room" "subject subject" "study-class study-class" "teacher teacher";gap:.5rem;padding:1rem;border-bottom:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:0;padding:0}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time[_ngcontent-%COMP%]{grid-area:time;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.subject[_ngcontent-%COMP%]{grid-area:subject;font-size:1rem;line-height:1.25rem;font-weight:400}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.teacher[_ngcontent-%COMP%]{grid-area:teacher;font-size:.8125rem;line-height:1.0625rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.room[_ngcontent-%COMP%]{grid-area:room;text-align:right;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.study-class[_ngcontent-%COMP%]{grid-area:study-class;font-size:.8125rem;line-height:1.0625rem;font-weight:300}td.study-class[_ngcontent-%COMP%]{display:block}.subject-study-class[_ngcontent-%COMP%]{display:none}.room-label[_ngcontent-%COMP%]{display:inline}}']})}}return e})();var ti=X({}),lt=(()=>{class e extends ee{constructor(t,i){super(t,i,ti,"Teachers")}getTimetableEntries(t,i={}){let n=i instanceof pe?i:new pe({fromObject:i});return n=n.set("fields","Id,From,To,EventId,EventNumber,EventDesignation,EventLocation"),this.http.get(`${this.baseUrl}/${t}/TimetableEntries/CurrentSemester`,{params:n}).pipe(T(je(Ge)))}static{this.\u0275fac=function(i){return new(i||e)(D(Q),D(I))}}static{this.\u0275prov=F({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();function ni(e,s){e&1&&(c(0,"a",6),o(1,"safe"),l(2),o(3,"translate"),d()),e&2&&(f("href",R(1,2,s,"url"),w),a(2),P(" ",r(3,5,"dashboard.timetable.subscribe-calendar")," "))}function ai(e,s){e&1&&_(0,"bkd-spinner")}function oi(e,s){e&1&&(c(0,"a",8),o(1,"safe"),l(2),o(3,"translate"),d()),e&2&&(f("href",R(1,2,s,"url"),w),a(2),P(" ",r(3,5,"dashboard.timetable.subscribe-calendar")," "))}function ri(e,s){if(e&1&&(_(0,"bkd-dashboard-timetable-table",7),p(1,oi,4,7,"a",8),o(2,"async")),e&2){let t,i=u(),n=q(18);f("entries",n),a(),m((t=r(2,2,i.getSubscribeCalendarUrl()))?1:-1,t)}}var si="cal",pt=(()=>{class e{constructor(t,i,n,b,x){this.teachersService=t,this.studentsService=i,this.lessonPresencesService=n,this.userSettings=b,this.dashboardService=x,this.userId$=this.dashboardService.userId$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$,this.isStudent$=this.dashboardService.hasStudentRole$,this.date$=new re(me(new Date)),this.loading$=new re(!0),this.timetableEntries$=this.loadTimetableEntries()}gotoToday(){this.loading$.next(!0),this.date$.next(me(new Date))}gotoPreviousDay(){this.loading$.next(!0),this.date$.next(He(this.date$.getValue(),1))}gotoNextDay(){this.loading$.next(!0),this.date$.next(ze(this.date$.getValue(),1))}getSubscribeCalendarUrl(){return this.userSettings.getSetting(si)}loadTimetableEntries(){return V([this.isTeacher$,this.isStudent$]).pipe(T(([t,i])=>t?this.fetchTimetableEntries("teacher"):i?this.fetchTimetableEntries("student"):O([])),_e(()=>this.loading$.next(!1)),v(1))}fetchTimetableEntries(t){return V([this.userId$,this.date$]).pipe(T(([i,n])=>{let b={"filter.From":`=${Ue(n,"yyyy-MM-dd")}`,sort:"From,To"};return t==="teacher"?this.teachersService.getTimetableEntries(i,b):this.studentsService.getTimetableEntries(i,b)}),h(i=>i.map(ot)),h(i=>Be(i,n=>n.id)),T(i=>t==="teacher"?this.loadStudyClasses().pipe(h(n=>st(i,n))):O(i)))}loadStudyClasses(){return this.date$.pipe(T(t=>this.lessonPresencesService.getLessonStudyClassesByDate(t)),h(rt))}static{this.\u0275fac=function(i){return new(i||e)(g(lt),g(z),g(te),g(ne),g(A))}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-timetable"]],standalone:!0,features:[S],decls:23,vars:24,consts:[[1,"header"],["type","button",1,"btn","btn-primary","today",3,"click"],["type","button",1,"btn","btn-secondary","previous-day",3,"click"],[1,"material-icons"],["type","button",1,"btn","btn-secondary","next-day",3,"click"],[1,"date"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-header",3,"href"],[3,"entries"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-bottom",3,"href"]],template:function(i,n){if(i&1){let b=xe();c(0,"div",0)(1,"button",1),N("click",function(){return Y(b),Z(n.gotoToday())}),l(2),o(3,"translate"),d(),c(4,"button",2),o(5,"translate"),N("click",function(){return Y(b),Z(n.gotoPreviousDay())}),c(6,"span",3),l(7,"chevron_left"),d()(),c(8,"button",4),o(9,"translate"),N("click",function(){return Y(b),Z(n.gotoNextDay())}),c(10,"span",3),l(11,"chevron_right"),d()(),c(12,"div",5),l(13),o(14,"async"),o(15,"date"),d(),p(16,ni,4,7,"a",6),o(17,"async"),d(),B(18),o(19,"async"),p(20,ai,1,0,"bkd-spinner"),o(21,"async"),p(22,ri,3,4)}if(i&2){let b;a(2),P(" ",r(3,6,"dashboard.timetable.today")," "),a(2),se("aria-label",r(5,8,"dashboard.timetable.previousDay")),a(4),se("aria-label",r(9,10,"dashboard.timetable.nextDay")),a(5),$(R(15,14,r(14,12,n.date$),"E, dd. MMMM yyyy")),a(3),m((b=r(17,17,n.getSubscribeCalendarUrl()))?16:-1,b),a(2),G(r(19,19,n.timetableEntries$)),a(2),m(r(21,22,n.loading$)?20:22)}},dependencies:[ct,ie,L,J,E,k,at],styles:["[_nghost-%COMP%]{display:block;margin-bottom:1rem}.header[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:2rem;display:flex;align-items:center;gap:1rem}.previous-day[_ngcontent-%COMP%], .next-day[_ngcontent-%COMP%]{padding-left:.375rem;padding-right:.375rem}.date[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.subscribe-calendar-header[_ngcontent-%COMP%]{margin-left:auto}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:none}a.btn[_ngcontent-%COMP%]{text-decoration:none}@media (max-width: 767.98px){.subscribe-calendar-header[_ngcontent-%COMP%]{display:none}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:block;margin-top:2rem}}@media (max-width: 767.98px) and (max-width: 575.98px){.header[_ngcontent-%COMP%]{flex-wrap:wrap-reverse}.header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{width:100%}}"]})}}return e})();function di(e,s){e&1&&_(0,"bkd-spinner")}function ci(e,s){e&1&&(c(0,"p"),l(1),o(2,"translate"),d()),e&2&&(a(),P(" ",r(2,1,"dashboard.no-access")," "))}function li(e,s){e&1&&(c(0,"div")(1,"h2"),l(2),o(3,"translate"),d(),_(4,"bkd-dashboard-search"),d()),e&2&&(a(2),$(r(3,1,"dashboard.search.title")))}function pi(e,s){e&1&&(c(0,"div")(1,"h2"),l(2),o(3,"translate"),d(),_(4,"bkd-dashboard-actions"),d()),e&2&&(a(2),$(r(3,1,"dashboard.actions.title")))}function mi(e,s){if(e&1&&(c(0,"div",1),p(1,li,5,3,"div")(2,pi,5,3,"div"),d()),e&2){u();let t=q(2),i=q(4);a(),m(t?1:-1),a(),m(i?2:-1)}}function hi(e,s){e&1&&(c(0,"div",2)(1,"h2"),l(2),o(3,"translate"),d(),_(4,"bkd-dashboard-timetable"),d()),e&2&&(a(2),$(r(3,1,"dashboard.timetable.title")))}var mt=(()=>{class e{constructor(t){this.dashboardService=t}static{this.\u0275fac=function(i){return new(i||e)(g(A))}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard-layout"]],standalone:!0,features:[S],decls:17,vars:19,consts:[[1,"columns"],[1,"search-actions-column"],[1,"timetable-column"]],template:function(i,n){if(i&1&&(B(0),o(1,"async"),B(2),o(3,"async"),B(4),o(5,"async"),B(6),o(7,"async"),c(8,"div")(9,"h1"),l(10),o(11,"translate"),d(),p(12,di,1,0,"bkd-spinner")(13,ci,3,3,"p"),c(14,"div",0),p(15,mi,3,2,"div",1)(16,hi,5,3,"div",2),d()()),i&2){let b=r(1,7,n.dashboardService.loading$);a(2);let x=G(r(3,9,n.dashboardService.hasSearch$));a(2);let U=G(r(5,12,n.dashboardService.hasActions$)),H=r(7,15,n.dashboardService.hasTimetable$);a(5),ve("visually-hidden",b||x||U||H),a(),P(" ",r(11,17,"dashboard.heading")," "),a(2),m(b?12:-1),a(),m(!b&&!x&&!U&&!H?13:-1),a(2),m(x||U?15:-1),a(),m(H?16:-1)}},dependencies:[ie,nt,it,pt,L,E,k],styles:[".columns[_ngcontent-%COMP%]{display:flex;flex-direction:column}.columns[_ngcontent-%COMP%], .search-actions-column[_ngcontent-%COMP%]{gap:3rem}.search-actions-column[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;max-width:40rem}.timetable-column[_ngcontent-%COMP%]{flex:2}@media (min-width: 992px){.columns[_ngcontent-%COMP%]{flex-direction:row;gap:1.5rem}.search-actions-column[_ngcontent-%COMP%]{max-width:33%}}"],changeDetection:0})}}return e})();var ht=(()=>{class e{constructor(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=y({type:e,selectors:[["bkd-dashboard"]],standalone:!0,features:[$e([A,Ve]),S],decls:1,vars:0,template:function(i,n){i&1&&_(0,"router-outlet")},dependencies:[Ee],changeDetection:0})}}return e})();var $n=[{path:"",component:ht,children:[{path:"",component:mt},Ye]}];export{$n as DASHBOARD_ROUTES};
