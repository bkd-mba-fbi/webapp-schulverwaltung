import{p as K,r as Q,s as X,t as Z,w as ee}from"./chunk-LLGOVPQJ.js";import"./chunk-Y4QYVF5K.js";import"./chunk-OFB4XAK2.js";import{d as W}from"./chunk-WACRWBCS.js";import{a as V,b as z}from"./chunk-YD3RJIHU.js";import{b as Y}from"./chunk-KK2SHN2W.js";import{A as F,u as k}from"./chunk-AP373D4K.js";import{Ab as f,Bb as N,Gb as a,Ha as j,Hb as d,Jd as x,Kd as w,Ld as U,M as B,Ma as y,P as _,Ra as O,Wa as g,X as A,Xa as u,Ya as m,Yc as J,Zb as R,_ as p,aa as l,db as H,h as E,n as o,nb as C,o as T,ob as $,s as P,sc as q,wa as c,wb as G,xa as v,xb as I,yb as M,zb as b}from"./chunk-IFJN5CDK.js";var S=(()=>{class e{constructor(s,t,n,h,oe,ae,de){this.storageService=s,this.loadingService=t,this.coursesRestService=n,this.subscriptionRestService=h,this.reportsService=oe,this.gradingScalesRestService=ae,this.settings=de,this.studentId$=new E(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(B(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(o(i=>i.slice().sort((r,pe)=>r.Designation.localeCompare(pe.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(o(i=>i.flatMap(r=>r.Id))),this.idSubscriptions$=T([this.studentId$,this.studentCourseIds$]).pipe(_(([i,r])=>this.subscriptionRestService.getIdSubscriptionsByStudentAndCourse(i,r))),this.ids$=this.idSubscriptions$.pipe(o(i=>i.map(r=>r.Id))),this.testReports$=this.ids$.pipe(o(i=>this.reportsService.getStudentSubscriptionReports(i))),this.tests$=this.studentCourses$.pipe(o(i=>i.flatMap(r=>r.Tests).filter(k))),this.gradingScaleIdsFromTests$=this.tests$.pipe(o(i=>[...i.map(r=>r.GradingScaleId)].filter(k).filter(F))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe(o(i=>i.flatMap(r=>r.GradingScaleId).filter(k).filter(F))),this.gradingScaleIds$=T([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe(o(([i,r])=>i.concat(r).filter(F))),this.gradingScales$=this.gradingScaleIds$.pipe(_(i=>P(i.map(r=>this.gradingScalesRestService.getGradingScale(r)))));let D=this.storageService.getPayload()?.id_person;D&&this.studentId$.next(Number(D))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}static{this.\u0275fac=function(t){return new(t||e)(p(U),p(z),p(K),p(Q),p(W),p(X),p(J))}}static{this.\u0275prov=A({token:e,factory:e.\u0275fac})}}return e})();var me=()=>[],ie=(()=>{class e{constructor(s){this.myGradesService=s}static{this.\u0275fac=function(t){return new(t||e)(v(S))}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades-header"]],standalone:!0,features:[f],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(t,n){if(t&1&&(g(0,"div",0)(1,"div"),C(2),a(3,"translate"),u(),g(4,"div"),m(5,"bkd-reports-link",1),a(6,"async"),u()()),t&2){let h;c(2),$(d(3,2,"my-grades.header")),c(3),y("reports",(h=d(6,4,n.myGradesService.testReports$))!==null&&h!==void 0?h:N(6,me))}},dependencies:[V,R,w,x],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return e})();function le(e,ne){e&1&&m(0,"bkd-spinner")}function ue(e,ne){if(e&1&&m(0,"bkd-dossier-grades-view",1),e&2){H();let s=M(0),t=M(2),n=M(4);y("courses",s)("studentId",t)("gradingScales",n)("isEditable",!1)}}var re=(()=>{class e{constructor(s){this.myGradesService=s}static{this.\u0275fac=function(t){return new(t||e)(v(S))}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades-show"]],standalone:!0,features:[b([Z]),f],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(t,n){t&1&&(G(0),a(1,"async"),G(2),a(3,"async"),G(4),a(5,"async"),g(6,"div",0)(7,"h1"),C(8),a(9,"translate"),u(),m(10,"bkd-my-grades-header"),j(11,le,1,0,"bkd-spinner"),a(12,"async"),j(13,ue,1,4,"bkd-dossier-grades-view",1),u()),t&2&&(I(d(1,2,n.myGradesService.studentCoursesSorted$)),c(2),I(d(3,5,n.myGradesService.studentId$)),c(2),I(d(5,8,n.myGradesService.gradingScales$)),c(4),$(d(9,11,"my-grades.title")),c(3),O(d(12,13,n.myGradesService.loading$)?11:13))},dependencies:[ie,ee,Y,R,w,x]})}}return e})();var se=(()=>{class e{constructor(){}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades"]],standalone:!0,features:[b([S]),f],decls:1,vars:0,template:function(t,n){t&1&&m(0,"router-outlet")},dependencies:[q]})}}return e})();var Ae=[{path:"",component:se,children:[{path:"",component:re}]}];export{Ae as MY_GRADES_ROUTES};
