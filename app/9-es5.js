!function(){function t(t){return function(t){if(Array.isArray(t))return e(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(!t)return;if("string"==typeof t)return e(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);"Object"===r&&t.constructor&&(r=t.constructor.name);if("Map"===r||"Set"===r)return Array.from(t);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return e(t,n)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function e(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}function o(t,e){return(o=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var n,r=s(t);if(e){var i=s(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return a(this,n)}}function a(t,e){return!e||"object"!=typeof e&&"function"!=typeof e?function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t):e}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Muja:function(t,e,n){"use strict";var r=n("EqEh");e.a=function(t,e){return Object(r.a)(t,e)}},wbm3:function(e,r,a){"use strict";a.r(r),a.d(r,"EvaluateAbsencesModule",function(){return ht});var s,l,u,f=a("PCNd"),b=a("tyNb"),d=a("1G5W"),h=a("CCnw"),p=a("CqUA"),g=a("NPit"),v=a("fhBx"),y=a("Xr/R"),m=a("fXoL"),S=a("ofXK"),P=((s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),e&&o(t,e)}(r,t);var e=c(r);function r(t,i,o,c){var a;return n(this,r),(a=e.call(this,t,i,o,"/evaluate-absences")).lessonPresenceService=c,a.queryParamsString$.pipe(Object(d.a)(a.destroy$)).subscribe(function(t){return a.confirmBackLinkParams={returnparams:t}}),a}return i(r,[{key:"getInitialFilter",value:function(){return{student:null,educationalEvent:null,studyClass:null}}},{key:"isValidFilter",value:function(t){return Boolean(t.student||t.educationalEvent||t.studyClass)}},{key:"getInitialSorting",value:function(){return{key:"StudentFullName",ascending:!0}}},{key:"loadEntries",value:function(t,e,n){return this.loadingService.load(this.lessonPresenceService.getStatistics(t,e,n),v.a)}},{key:"buildParamsFromFilter",value:function(t){return Object(g.a)(t)}}]),r}(v.b)).\u0275fac=function(t){return new(t||s)(m.Zb(S.i),m.Zb(p.a),m.Zb(y.a),m.Zb(h.a))},s.\u0275prov=m.Ib({token:s,factory:s.\u0275fac}),s),R=a("qUtt"),k=a("0HM3"),O=((l=function(){function t(e){n(this,t),this.state=e}return i(t,[{key:"ngOnInit",value:function(){}}]),t}()).\u0275fac=function(t){return new(t||l)(m.Mb(P))},l.\u0275cmp=m.Gb({type:l,selectors:[["erz-evaluate-absences"]],features:[m.yb([P,{provide:R.a,useExisting:P},{provide:k.a,useValue:"/evaluate-absences"}])],decls:1,vars:0,template:function(t,e){1&t&&m.Nb(0,"router-outlet")},directives:[b.k],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),l),C=a("lJxs"),w=a("IzEk"),j=a("eIep"),I=a("yl8S"),z=a("KJh6"),$=a("Ug8t"),E=a("EOpz"),F=a("mmcK"),x=a("vjgy"),M=a("4vbw"),_=a("jSy9"),A=a("sYmb"),B=((u=function(){function t(e,r,i){n(this,t),this.studentsService=e,this.educationalEventsService=r,this.studyClassesService=i,this.filter={student:null,educationalEvent:null,studyClass:null},this.filterChange=new m.n,this.classesHttpFilter={params:{fields:"IsActive","filter.IsActive":"=true"}}}return i(t,[{key:"ngOnInit",value:function(){}},{key:"show",value:function(){this.filterChange.emit(this.filter)}}]),t}()).\u0275fac=function(t){return new(t||u)(m.Mb(F.a),m.Mb(x.a),m.Mb(M.a))},u.\u0275cmp=m.Gb({type:u,selectors:[["erz-evaluate-absences-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},decls:20,vars:19,consts:[[1,"filters","mb-2"],[1,"form-group"],[3,"typeaheadService","value","valueChange"],[3,"typeaheadService","value","additionalHttpParams","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(m.Sb(0,"div",0),m.Sb(1,"div",1),m.Sb(2,"label"),m.Dc(3),m.gc(4,"translate"),m.Rb(),m.Sb(5,"erz-typeahead",2),m.dc("valueChange",function(t){return e.filter.student=t}),m.Rb(),m.Rb(),m.Sb(6,"div",1),m.Sb(7,"label"),m.Dc(8),m.gc(9,"translate"),m.Rb(),m.Sb(10,"erz-typeahead",2),m.dc("valueChange",function(t){return e.filter.educationalEvent=t}),m.Rb(),m.Rb(),m.Sb(11,"div",1),m.Sb(12,"label"),m.Dc(13),m.gc(14,"translate"),m.Rb(),m.Sb(15,"erz-typeahead",3),m.dc("valueChange",function(t){return e.filter.studyClass=t}),m.Rb(),m.Rb(),m.Sb(16,"div",4),m.Sb(17,"button",5),m.dc("click",function(){return e.show()}),m.Dc(18),m.gc(19,"translate"),m.Rb(),m.Rb(),m.Rb()),2&t&&(m.zb(3),m.Ec(m.hc(4,11,"evaluate-absences.header.student")),m.zb(2),m.lc("typeaheadService",e.studentsService)("value",e.filter.student),m.zb(3),m.Ec(m.hc(9,13,"evaluate-absences.header.module-instance")),m.zb(2),m.lc("typeaheadService",e.educationalEventsService)("value",e.filter.educationalEvent),m.zb(3),m.Ec(m.hc(14,15,"evaluate-absences.header.study-class")),m.zb(2),m.lc("typeaheadService",e.studyClassesService)("value",e.filter.studyClass)("additionalHttpParams",e.classesHttpFilter),m.zb(3),m.Fc(" ",m.hc(19,17,"evaluate-absences.header.show")," "))},directives:[_.a],pipes:[A.c],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1.5rem;border-bottom:1px solid #dee2e6}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),u),D=a("dlKe"),T=a("4Kj8");function L(t,e){if(1&t&&(m.Sb(0,"a",15),m.gc(1,"async"),m.Sb(2,"i",16),m.Dc(3,"description"),m.Rb(),m.Rb()),2&t){var n=m.fc(5);m.lc("href",m.hc(1,1,n.reportUrl$),m.xc)}}function N(t,e){if(1&t){var n=m.Tb();m.Sb(0,"th",17),m.dc("click",function(){m.vc(n);var t=e.$implicit;return m.fc(5).state.toggleSorting(t.key)}),m.Sb(1,"div",18),m.Sb(2,"div",19),m.Dc(3),m.gc(4,"translate"),m.Rb(),m.Sb(5,"div",20),m.Dc(6),m.gc(7,"async"),m.Rb(),m.Rb(),m.Rb()}if(2&t){var r=e.$implicit,i=m.fc(5);m.lc("ngClass",r.label),m.zb(3),m.Fc(" ",m.hc(4,3,"evaluate-absences.list.header."+r.label)," "),m.zb(3),m.Fc(" ",m.hc(7,5,i.getSortingChar$(r))," ")}}var U=function(t){return["student",t]},q=function(t){return{returnparams:t}};function K(t,e){if(1&t&&(m.Sb(0,"a",24),m.gc(1,"async"),m.Dc(2),m.Rb()),2&t){var n=m.fc().$implicit,r=m.fc().$implicit,i=m.fc(6);m.lc("routerLink",m.pc(5,U,r.StudentRef.Id))("queryParams",m.pc(7,q,m.hc(1,3,i.profileReturnParams$))),m.zb(2),m.Fc(" ",r[n.key]," ")}}function Z(t,e){if(1&t&&m.Dc(0),2&t){var n=m.fc().$implicit,r=m.fc().$implicit;m.Fc(" ",r[n.key]," ")}}function G(t,e){if(1&t&&(m.Sb(0,"td"),m.gc(1,"translate"),m.Bc(2,K,3,9,"a",22),m.Bc(3,Z,1,1,"ng-template",null,23,m.Cc),m.Rb()),2&t){var n=e.$implicit,r=m.uc(4);m.Ab("data-label",m.hc(1,3,"evaluate-absences.list.header."+n.label)),m.zb(2),m.lc("ngIf","StudentFullName"===n.key)("ngIfElse",r)}}function H(t,e){if(1&t&&(m.Sb(0,"tr"),m.Bc(1,G,5,5,"td",21),m.Rb()),2&t){var n=m.fc(6);m.zb(1),m.lc("ngForOf",n.columns)}}function J(t,e){if(1&t&&(m.Sb(0,"tbody"),m.Bc(1,H,2,1,"tr",21),m.Rb()),2&t){var n=m.fc(4).erzLet;m.zb(1),m.lc("ngForOf",n.entries)}}function X(t,e){1&t&&m.Nb(0,"erz-spinner",25)}function V(t,e){if(1&t){var n=m.Tb();m.Sb(0,"button",26),m.dc("click",function(){return m.vc(n),m.fc(5).state.nextPage()}),m.Dc(1),m.gc(2,"translate"),m.Rb()}2&t&&(m.zb(1),m.Fc(" ",m.hc(2,1,"global.pagination.load-more")," "))}function Q(t,e){if(1&t){var n=m.Tb();m.Sb(0,"div",7),m.Sb(1,"div",8),m.Bc(2,L,4,3,"a",9),m.gc(3,"async"),m.Rb(),m.Sb(4,"table",10),m.dc("scrolled",function(){return m.vc(n),m.fc(4).onScroll()}),m.Sb(5,"thead"),m.Sb(6,"tr"),m.Bc(7,N,8,7,"th",11),m.Rb(),m.Rb(),m.Bc(8,J,2,1,"tbody",12),m.Rb(),m.Bc(9,X,1,0,"erz-spinner",13),m.Bc(10,V,3,3,"button",14),m.Rb()}if(2&t){var r=m.fc(3).erzLet,i=m.fc();m.zb(2),m.lc("ngIf",m.hc(3,5,!r.loadingPage&&i.reportUrl$)),m.zb(5),m.lc("ngForOf",i.columns),m.zb(1),m.lc("ngIf",r.entries&&r.entries.length>0),m.zb(1),m.lc("ngIf",r.loadingPage),m.zb(1),m.lc("ngIf",r.hasMore&&!r.loadingPage)}}function W(t,e){1&t&&(m.Sb(0,"p",27),m.Dc(1),m.gc(2,"translate"),m.Rb()),2&t&&(m.zb(1),m.Fc(" ",m.hc(2,1,"evaluate-absences.no-entries")," "))}function Y(t,e){if(1&t&&(m.Qb(0),m.Bc(1,Q,11,7,"div",5),m.Bc(2,W,3,3,"ng-template",null,6,m.Cc),m.Pb()),2&t){var n=m.uc(3),r=m.fc(2).erzLet;m.zb(1),m.lc("ngIf",r.entries&&r.entries.length>0||r.loadingPage)("ngIfElse",n)}}function tt(t,e){1&t&&m.Nb(0,"erz-spinner")}function et(t,e){if(1&t&&(m.Qb(0),m.Bc(1,Y,4,2,"ng-container",2),m.gc(2,"async"),m.Bc(3,tt,1,0,"ng-template",null,4,m.Cc),m.Pb()),2&t){var n=m.uc(4),r=m.fc(2);m.zb(1),m.lc("ngIf",!m.hc(2,2,r.state.loading$))("ngIfElse",n)}}function nt(t,e){1&t&&(m.Sb(0,"p",27),m.Dc(1),m.gc(2,"translate"),m.Rb()),2&t&&(m.zb(1),m.Ec(m.hc(2,1,"evaluate-absences.no-filter")))}function rt(t,e){if(1&t){var n=m.Tb();m.Qb(0),m.Sb(1,"erz-evaluate-absences-header",1),m.dc("filterChange",function(t){return m.vc(n),m.fc().state.setFilter(t)}),m.gc(2,"async"),m.Rb(),m.Bc(3,et,5,4,"ng-container",2),m.gc(4,"async"),m.Bc(5,nt,3,3,"ng-template",null,3,m.Cc),m.Pb()}if(2&t){var r=m.uc(6),i=m.fc();m.zb(1),m.lc("filter",m.hc(2,3,i.filterFromParams$)),m.zb(2),m.lc("ngIf",m.hc(4,5,i.state.isFilterValid$))("ngIfElse",r)}}var it,ot=function(t,e,n){return{entries:t,hasMore:e,loadingPage:n}},ct=((it=function(){function e(t,r,i,o,c,a){n(this,e),this.state=t,this.scrollPosition=r,this.route=i,this.presenceTypesService=o,this.reportsService=c,this.lessonPresencesService=a,this.reportUrl$=this.loadReportUrl(),this.columns=[{key:"StudentFullName",label:"student"},{key:"TotalAbsences",label:"total"},{key:"TotalAbsencesValidExcuse",label:"valid-excuse"},{key:"TotalAbsencesWithoutExcuse",label:"without-excuse"},{key:"TotalAbsencesUnconfirmed",label:"unconfirmed"},{key:"TotalIncidents",label:"incident"}],this.filterFromParams$=this.route.queryParams.pipe(Object(C.a)(at)),this.profileReturnParams$=this.state.queryParamsString$}return i(e,[{key:"ngOnInit",value:function(){var e=this;this.filterFromParams$.pipe(Object(w.a)(1)).subscribe(function(t){return e.state.setFilter(t)}),this.presenceTypesService.halfDayActive$.subscribe(function(n){n&&(e.columns=[].concat(t(e.columns),[{key:"TotalHalfDays",label:"halfday"}]))})}},{key:"ngAfterViewInit",value:function(){this.scrollPosition.restore()}},{key:"onScroll",value:function(){this.state.nextPage()}},{key:"getSortingChar$",value:function(t){return this.state.sorting$.pipe(Object(C.a)(function(e){return e&&t.key===e.key?e.ascending?"\u2193":"\u2191":""}))}},{key:"loadReportUrl",value:function(){var t=this;return this.state.validFilter$.pipe(Object(j.a)(function(e){return t.lessonPresencesService.getLessonRefs(e)}),Object(C.a)(function(e){return e.length>0?t.reportsService.getEvaluateAbsencesUrl(t.getReportRecordIds(e)):null}))}},{key:"getReportRecordIds",value:function(t){return t.map(function(t){return"".concat(t.LessonRef.Id,"_").concat(t.RegistrationRef.Id)})}}]),e}()).\u0275fac=function(t){return new(t||it)(m.Mb(P),m.Mb(I.a),m.Mb(b.a),m.Mb(z.a),m.Mb($.a),m.Mb(h.a))},it.\u0275cmp=m.Gb({type:it,selectors:[["erz-evaluate-absences-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],[1,"buttons"],["class","report btn btn-primary mb-2","target","_blank",3,"href",4,"ngIf"],["infiniteScroll","",1,"table","table-striped","table-fixed",3,"scrolled"],["scope","col",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","inline",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm d-block mx-auto",3,"click",4,"ngIf"],["target","_blank",1,"report","btn","btn-primary","mb-2",3,"href"],[1,"material-icons"],["scope","col",3,"ngClass","click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction"],[4,"ngFor","ngForOf"],["class","student",3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["noLink",""],[1,"student",3,"routerLink","queryParams"],[1,"inline"],["type","button",1,"btn","btn-secondary","btn-sm","d-block","mx-auto",3,"click"],[1,"mt-3","px-3"]],template:function(t,e){1&t&&(m.Bc(0,rt,7,7,"ng-container",0),m.gc(1,"async"),m.gc(2,"async"),m.gc(3,"async")),2&t&&m.lc("erzLet",m.rc(7,ot,m.hc(1,1,e.state.entries$),m.hc(2,3,e.state.hasMore$),m.hc(3,5,e.state.loadingPage$)))},directives:[E.a,B,S.m,D.a,S.l,S.k,b.i,T.a],pipes:[S.b,A.c],styles:["th[_ngcontent-%COMP%]{cursor:pointer}th.student[_ngcontent-%COMP%]{width:30%}.column-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}a.student[_ngcontent-%COMP%]{color:#33333d}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{line-height:1;font-size:2.2rem}"],changeDetection:0}),it);function at(t){return{student:t.student?Number(t.student):null,educationalEvent:t.educationalEvent?Number(t.educationalEvent):null,studyClass:t.studyClass?Number(t.studyClass):null}}var st,lt,ut=a("ccj6"),ft=a("hH5/"),bt=[{path:"",component:O,children:[{path:"",component:ct,data:{restoreScrollPositionFrom:["/evaluate-absences/student/:id"]}},{path:"student/:id",children:[{path:"",component:ut.a},{path:"confirm",component:ft.a}]}]}],dt=((lt=function t(){n(this,t)}).\u0275fac=function(t){return new(t||lt)},lt.\u0275mod=m.Kb({type:lt}),lt.\u0275inj=m.Jb({imports:[[b.j.forChild(bt)],b.j]}),lt),ht=((st=function t(){n(this,t)}).\u0275fac=function(t){return new(t||st)},st.\u0275mod=m.Kb({type:st}),st.\u0275inj=m.Jb({imports:[[f.a,dt]]}),st)},yl8S:function(t,e,r){"use strict";r.d(e,"a",function(){return m});var o=r("tyNb"),c=r("XNiG"),a=r("LRne"),s=r("pLZG"),l=r("lJxs"),u=r("IzEk"),f=r("5+tZ"),b=r("eIep"),d=r("Y6wi"),h=r("UXun"),p=r("1G5W"),g=r("zP0r"),v=r("fXoL"),y=r("ofXK"),m=function(){var t=function(){function t(e,r){var i=this;n(this,t),this.router=e,this.viewportScroller=r,this.scrollPositions={},this.previousRoute=null,this.currentRoute=null,this.currentScrollPosition=[0,0],this.destroy$=new c.a,this.scrollPosition$=this.router.events.pipe(Object(s.a)(P),Object(l.a)(this.getScrollPosition.bind(this))),this.activationEnd$=this.router.events.pipe(Object(s.a)(S)),this.navigationEnd$=this.router.events.pipe(Object(s.a)(R)),this.route$=this.activationEnd$.pipe(Object(u.a)(1)).pipe(Object(f.a)(function(t){return[Object(a.a)(t),i.navigationEnd$.pipe(Object(b.a)(function(){return i.activationEnd$.pipe(Object(u.a)(1))}))]}),Object(d.a)(),Object(l.a)(function(t){return t.snapshot}),Object(h.a)(1)),this.scrollPosition$.pipe(Object(p.a)(this.destroy$)).subscribe(function(t){return i.currentScrollPosition=t}),this.route$.pipe(Object(p.a)(this.destroy$)).subscribe(function(t){i.previousRoute=i.currentRoute,i.currentRoute=t})}return i(t,[{key:"ngOnDestroy",value:function(){this.destroy$.next()}},{key:"restore",value:function(){var t=this;if(this.currentRoute&&this.requiresStoring(this.currentRoute)){if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){var e=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[e]||[0,0])}var n=this.currentRoute;this.route$.pipe(Object(g.a)(1),Object(u.a)(1),Object(p.a)(this.destroy$),Object(s.a)(function(e){return t.shouldStoreFor(n,e)})).subscribe(function(){var e=t.getPath(n);t.scrollPositions[e]=t.currentScrollPosition})}}},{key:"getScrollPosition",value:function(){return this.viewportScroller.getScrollPosition()}},{key:"scrollToPosition",value:function(t){this.viewportScroller.scrollToPosition(t)}},{key:"getPath",value:function(t){return t?"/"+t.pathFromRoot.map(function(t){return t.routeConfig&&t.routeConfig.path}).filter(function(t){return t}).join("/"):"/"}},{key:"requiresStoring",value:function(t){return Boolean(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}},{key:"shouldStoreFor",value:function(t,e){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(e))}}]),t}();return t.\u0275fac=function(e){return new(e||t)(v.Zb(o.g),v.Zb(y.t))},t.\u0275prov=v.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t}();function S(t){return t instanceof o.b}function P(t){return t instanceof o.e}function R(t){return t instanceof o.d}}}])}();