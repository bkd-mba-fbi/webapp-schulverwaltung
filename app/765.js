"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[765],{1433:(T,R,s)=>{s.d(R,{f:()=>y});var a=s(177),t=s(5539),n=s(2809),r=s(4438),e=s(4599);let y=(()=>{class M{constructor(u,l){this.settings=u,this.storageService=l,this.avatarStyles={}}ngOnChanges(u){u.studentId&&(this.avatarStyles=this.buildAvatarStyles(this.studentId))}buildAvatarStyles(u){return{"background-image":[this.buildAvatarUrl(u),this.fallbackAvatarUrl].map(l=>`url(${l})`).join(", ")}}buildAvatarUrl(u){const l=this.storageService.getAccessToken()||"";return`${this.settings.apiUrl}/Files/personPictures/${u}?token=${l}`}get fallbackAvatarUrl(){return`${this.settings.scriptsAndAssetsPath}/assets/images/avatar-placeholder.png`}static#e=this.\u0275fac=function(l){return new(l||M)(r.rXU(n.yy),r.rXU(e.n))};static#n=this.\u0275cmp=r.VBU({type:M,selectors:[["bkd-avatar"]],inputs:{studentId:"studentId",link:"link",linkParams:"linkParams"},standalone:!0,features:[r.OA$,r.aNF],decls:1,vars:5,consts:[[1,"avatar",3,"routerLink","queryParams","ngStyle"]],template:function(l,i){1&l&&r.nrm(0,"a",0),2&l&&(r.AVh("disabled",!i.link),r.Y8G("routerLink",i.link)("queryParams",i.linkParams)("ngStyle",i.avatarStyles))},dependencies:[t.Wk,a.B3],styles:["[_nghost-%COMP%]{display:flex}.small[_nghost-%COMP%]{width:40px;min-width:40px;height:50px}.medium[_nghost-%COMP%]{width:58px;min-width:58px;height:75px}.large[_nghost-%COMP%]{width:100px;min-width:100px;height:130px}.avatar[_ngcontent-%COMP%]{flex:1;border:1px solid rgba(0,0,0,.25);background-repeat:no-repeat;background-size:cover;background-position:center}a.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:default}"]})}return M})()},4589:(T,R,s)=>{s.d(R,{W:()=>M});var a=s(177),t=s(4438);function n(v,u){if(1&v&&(t.qex(0),t.EFF(1),t.nrm(2,"br"),t.bVm()),2&v){const l=t.XpG();t.R7$(),t.SpI(" ",l.student.AddressLine2,"")}}function r(v,u){if(1&v&&(t.qex(0),t.j41(1,"a",2),t.EFF(2),t.k0s(),t.nrm(3,"br"),t.bVm()),2&v){const l=t.XpG();t.R7$(),t.Mz_("href","tel:",l.student.PhonePrivate,"",t.B4B),t.R7$(),t.SpI(" ",l.student.PhonePrivate," ")}}function e(v,u){if(1&v&&(t.qex(0),t.j41(1,"a",2),t.EFF(2),t.k0s(),t.nrm(3,"br"),t.bVm()),2&v){const l=t.XpG();t.R7$(),t.Mz_("href","tel:",l.student.PhoneMobile,"",t.B4B),t.R7$(),t.SpI(" ",l.student.PhoneMobile," ")}}function y(v,u){if(1&v&&(t.j41(0,"a",2),t.EFF(1),t.k0s()),2&v){const l=t.XpG();t.Mz_("href","mailto:",l.email,"",t.B4B),t.R7$(),t.SpI(" ",l.email," ")}}let M=(()=>{class v{constructor(){this.emailProperty="DisplayEmail"}get postalCode(){return"PostalCode"in this.student?this.student.PostalCode:this.student.Zip}get email(){return"Email2"===this.emailProperty&&"Email2"in this.student?this.student.Email2||null:this.student.DisplayEmail}static#e=this.\u0275fac=function(i){return new(i||v)};static#n=this.\u0275cmp=t.VBU({type:v,selectors:[["bkd-student-dossier-address"]],inputs:{student:"student",emailProperty:"emailProperty"},standalone:!0,features:[t.aNF],decls:9,vars:7,consts:[[4,"ngIf"],[3,"href",4,"ngIf"],[3,"href"]],template:function(i,f){1&i&&(t.j41(0,"address"),t.EFF(1),t.nrm(2,"br"),t.DNE(3,n,3,1,"ng-container",0),t.EFF(4),t.nrm(5,"br"),t.DNE(6,r,4,3,"ng-container",0)(7,e,4,3,"ng-container",0)(8,y,2,3,"a",1),t.k0s()),2&i&&(t.R7$(),t.SpI(" ",f.student.AddressLine1,""),t.R7$(2),t.Y8G("ngIf",f.student.AddressLine2),t.R7$(),t.Lme(" ",f.postalCode||""," ",f.student.Location,""),t.R7$(2),t.Y8G("ngIf",f.student.PhonePrivate),t.R7$(),t.Y8G("ngIf",f.student.PhoneMobile),t.R7$(),t.Y8G("ngIf",f.email))},dependencies:[a.bT],changeDetection:0})}return v})()},717:(T,R,s)=>{s.d(R,{e:()=>g});var a=s(177),t=s(3955),n=s(8676),r=s(4214),e=s(4438);function y(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.JRh(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.CompanyName)}}function M(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.JRh(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.CompanyNameAddition)}}function v(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.Lme(" ",(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.Lastname)||""," ",(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.Firstname)||"","")}}function u(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.JRh(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.AddressLine1)}}function l(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.JRh(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.AddressLine2)}}function i(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.Lme("",null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.PostalCode," ",null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.Location,"")}}function f(c,I){if(1&c&&(e.qex(0),e.j41(1,"a",2),e.EFF(2),e.nrm(3,"br"),e.k0s(),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.Mz_("href","tel:",null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.PhoneBusiness,"",e.B4B),e.R7$(),e.JRh(null==p.company.apprenticeshipManager?null:p.company.apprenticeshipManager.PhoneBusiness)}}function h(c,I){if(1&c&&(e.qex(0),e.j41(1,"a",2),e.nI1(2,"bkdPersonEmail"),e.EFF(3),e.nI1(4,"bkdPersonEmail"),e.k0s(),e.bVm()),2&c){const p=e.XpG();e.R7$(),e.Mz_("href","mailto:",e.bMT(2,3,p.company.apprenticeshipManager),"",e.B4B),e.R7$(2),e.JRh(e.bMT(4,5,p.company.apprenticeshipManager))}}function D(c,I){if(1&c&&(e.j41(0,"div",3),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"addSpace"),e.nrm(4,"br"),e.EFF(5),e.nI1(6,"date"),e.nI1(7,"date"),e.k0s()),2&c){const p=e.XpG();e.R7$(),e.Lme(" ",e.bMT(2,4,"shared.profile.apprenticeship-period"),"",e.i5U(3,6,":",":"),""),e.R7$(4),e.Lme(" ",e.i5U(6,9,p.company.apprenticeshipContract.ContractDateFrom,"dd.MM.yyyy"),"\u2013",e.i5U(7,12,p.company.apprenticeshipContract.ContractDateTo,"dd.MM.yyyy"),"\n")}}function _(c,I){if(1&c&&(e.qex(0),e.EFF(1),e.nrm(2,"br"),e.bVm()),2&c){const p=e.XpG(2);e.R7$(),e.Lme(" ",p.company.jobTrainer.Lastname||""," ",p.company.jobTrainer.Firstname||"","")}}function A(c,I){if(1&c&&(e.qex(0),e.j41(1,"a",2),e.EFF(2),e.nrm(3,"br"),e.k0s(),e.bVm()),2&c){const p=e.XpG(2);e.R7$(),e.Mz_("href","tel:",p.company.jobTrainer.PhoneBusiness,"",e.B4B),e.R7$(),e.JRh(p.company.jobTrainer.PhoneBusiness)}}function b(c,I){if(1&c&&(e.qex(0),e.j41(1,"a",2),e.EFF(2),e.nrm(3,"br"),e.k0s(),e.bVm()),2&c){const p=e.XpG(2);e.R7$(),e.Mz_("href","tel:",p.company.jobTrainer.PhoneMobile,"",e.B4B),e.R7$(),e.JRh(p.company.jobTrainer.PhoneMobile)}}function O(c,I){if(1&c&&(e.qex(0),e.j41(1,"a",2),e.nI1(2,"bkdPersonEmail"),e.EFF(3),e.nI1(4,"bkdPersonEmail"),e.k0s(),e.bVm()),2&c){const p=e.XpG(2);e.R7$(),e.Mz_("href","mailto:",e.bMT(2,3,p.company.jobTrainer),"",e.B4B),e.R7$(2),e.JRh(e.bMT(4,5,p.company.jobTrainer))}}function $(c,I){if(1&c&&(e.j41(0,"div",3),e.EFF(1),e.nI1(2,"translate"),e.nI1(3,"addSpace"),e.j41(4,"address"),e.DNE(5,_,3,2,"ng-container",0)(6,A,4,3,"ng-container",0)(7,b,4,3,"ng-container",0)(8,O,5,7,"ng-container",0),e.nI1(9,"bkdPersonEmail"),e.k0s()()),2&c){const p=e.XpG();e.R7$(),e.Lme(" ",e.bMT(2,6,"shared.profile.job-trainer"),"",e.i5U(3,8,":",":")," "),e.R7$(4),e.Y8G("ngIf",p.company.jobTrainer.Lastname||p.company.jobTrainer.Firstname),e.R7$(),e.Y8G("ngIf",p.company.jobTrainer.PhoneBusiness),e.R7$(),e.Y8G("ngIf",p.company.jobTrainer.PhoneMobile),e.R7$(),e.Y8G("ngIf",e.bMT(9,11,p.company.jobTrainer))}}let g=(()=>{class c{constructor(){}static#e=this.\u0275fac=function(P){return new(P||c)};static#n=this.\u0275cmp=e.VBU({type:c,selectors:[["bkd-student-dossier-apprenticeship-company"]],inputs:{company:"company"},standalone:!0,features:[e.aNF],decls:12,vars:12,consts:[[4,"ngIf"],["class","subentry",4,"ngIf"],[3,"href"],[1,"subentry"]],template:function(P,m){1&P&&(e.j41(0,"address"),e.DNE(1,y,3,1,"ng-container",0)(2,M,3,1,"ng-container",0)(3,v,3,2,"ng-container",0)(4,u,3,1,"ng-container",0)(5,l,3,1,"ng-container",0)(6,i,3,2,"ng-container",0)(7,f,4,3,"ng-container",0)(8,h,5,7,"ng-container",0),e.nI1(9,"bkdPersonEmail"),e.k0s(),e.DNE(10,D,8,15,"div",1)(11,$,10,13,"div",1)),2&P&&(e.R7$(),e.Y8G("ngIf",null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.CompanyName),e.R7$(),e.Y8G("ngIf",null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.CompanyNameAddition),e.R7$(),e.Y8G("ngIf",(null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.Lastname)||(null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.Firstname)),e.R7$(),e.Y8G("ngIf",null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.AddressLine1),e.R7$(),e.Y8G("ngIf",null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.AddressLine2),e.R7$(),e.Y8G("ngIf",(null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.PostalCode)&&(null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.Location)),e.R7$(),e.Y8G("ngIf",null==m.company.apprenticeshipManager?null:m.company.apprenticeshipManager.PhoneBusiness),e.R7$(),e.Y8G("ngIf",e.bMT(9,10,m.company.apprenticeshipManager)),e.R7$(2),e.Y8G("ngIf",m.company.apprenticeshipContract.ContractDateFrom),e.R7$(),e.Y8G("ngIf",m.company.jobTrainer))},dependencies:[a.bT,a.vh,t.h,t.D9,n.c,r.u],styles:[".subentry[_ngcontent-%COMP%]{padding-bottom:1rem}"],changeDetection:0})}return c})()},6194:(T,R,s)=>{s.d(R,{O:()=>l});var a=s(177),t=s(4214),n=s(4438);function r(i,f){if(1&i&&(n.qex(0),n.EFF(1),n.nrm(2,"br"),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.JRh(h.person.AddressLine1)}}function e(i,f){if(1&i&&(n.qex(0),n.EFF(1),n.nrm(2,"br"),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.JRh(h.person.AddressLine2)}}function y(i,f){if(1&i&&(n.qex(0),n.EFF(1),n.nrm(2,"br"),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.Lme("",h.person.Zip," ",h.person.Location,"")}}function M(i,f){if(1&i&&(n.qex(0),n.j41(1,"a",1),n.EFF(2),n.nrm(3,"br"),n.k0s(),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.Mz_("href","tel:",h.person.PhonePrivate,"",n.B4B),n.R7$(),n.JRh(h.person.PhonePrivate)}}function v(i,f){if(1&i&&(n.qex(0),n.j41(1,"a",1),n.EFF(2),n.nrm(3,"br"),n.k0s(),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.Mz_("href","tel:",h.person.PhoneMobile,"",n.B4B),n.R7$(),n.JRh(h.person.PhoneMobile)}}function u(i,f){if(1&i&&(n.qex(0),n.j41(1,"a",1),n.nI1(2,"bkdPersonEmail"),n.EFF(3),n.nI1(4,"bkdPersonEmail"),n.k0s(),n.bVm()),2&i){const h=n.XpG();n.R7$(),n.Mz_("href","mailto:",n.bMT(2,3,h.person),"",n.B4B),n.R7$(2),n.JRh(n.bMT(4,5,h.person))}}let l=(()=>{class i{constructor(){}static#e=this.\u0275fac=function(D){return new(D||i)};static#n=this.\u0275cmp=n.VBU({type:i,selectors:[["bkd-student-dossier-legal-representative"]],inputs:{person:"person"},standalone:!0,features:[n.aNF],decls:10,vars:10,consts:[[4,"ngIf"],[3,"href"]],template:function(D,_){1&D&&(n.j41(0,"address"),n.EFF(1),n.nrm(2,"br"),n.DNE(3,r,3,1,"ng-container",0)(4,e,3,1,"ng-container",0)(5,y,3,2,"ng-container",0)(6,M,4,3,"ng-container",0)(7,v,4,3,"ng-container",0)(8,u,5,7,"ng-container",0),n.nI1(9,"bkdPersonEmail"),n.k0s()),2&D&&(n.R7$(),n.Lme(" ",_.person.LastName," ",_.person.FirstName,""),n.R7$(2),n.Y8G("ngIf",_.person.AddressLine1),n.R7$(),n.Y8G("ngIf",_.person.AddressLine2),n.R7$(),n.Y8G("ngIf",_.person.Zip&&_.person.Zip),n.R7$(),n.Y8G("ngIf",_.person.PhonePrivate),n.R7$(),n.Y8G("ngIf",_.person.PhoneMobile),n.R7$(),n.Y8G("ngIf",n.bMT(9,8,_.person)))},dependencies:[a.bT,t.u],changeDetection:0})}return i})()},6611:(T,R,s)=>{s.d(R,{a:()=>M});var a=s(5783),t=s(5306);const n=a.NW({Id:a.ai}),r=a.OH({HRef:(0,t.c$)(a.Yj)}),e=a.OH({From:t.iC,To:t.iC,EventNumber:a.Yj,EventDesignation:a.Yj,Designation:(0,t.c$)(a.Yj)}),y=a.E$([n,r,e]),M=a.NW({Id:a.Yj,LessonRef:y,StudentRef:t.Or,TypeRef:t.Or,Type:(0,t.c$)(a.Yj),ConfirmationState:(0,t.c$)(a.Yj),ConfirmationStateId:a.ai,Comment:(0,t.c$)(a.Yj),StudentFullName:a.Yj,RegistrationId:a.ai,HRef:a.Yj})},8676:(T,R,s)=>{s.d(R,{c:()=>n});var a=s(4438),t=s(3422);let n=(()=>{class r{constructor(y){this.i18n=y}transform(y,M){return"fr-CH"===this.i18n.detectLanguage()?(Array.from(M).map(u=>y=y.replace(u," ".concat(u))),y):y}static#e=this.\u0275fac=function(M){return new(M||r)(a.rXU(t.W,16))};static#n=this.\u0275pipe=a.EJ8({name:"addSpace",type:r,pure:!0,standalone:!0})}return r})()},4214:(T,R,s)=>{s.d(R,{u:()=>t});var a=s(4438);let t=(()=>{class n{transform(e){return e?.DisplayEmail||e?.Email||e?.Email2||null}static#e=this.\u0275fac=function(y){return new(y||n)};static#n=this.\u0275pipe=a.EJ8({name:"bkdPersonEmail",type:n,pure:!0,standalone:!0})}return n})()},8296:(T,R,s)=>{s.d(R,{v:()=>v});var a=s(5558),t=s(4668),n=s(2809),r=s(5666),e=s(785),y=s(4438),M=s(1626);let v=(()=>{class u{constructor(i,f){this.http=i,this.settings=f}getAbsenceConfirmationStates(){return this.http.get(`${this.baseUrl}/AbsenceConfirmationStates`).pipe((0,a.n)((0,e.k$)(r.H)),(0,t.t)(1))}getStayPermits(){return this.http.get(`${this.baseUrl}/StayPermits`).pipe((0,a.n)((0,e.k$)(r.H)),(0,t.t)(1))}get baseUrl(){return`${this.settings.apiUrl}/DropDownItems`}static#e=this.\u0275fac=function(f){return new(f||u)(y.KVO(M.Qq),y.KVO(n.yy))};static#n=this.\u0275prov=y.jDH({token:u,factory:u.\u0275fac,providedIn:"root"})}return u})()},4688:(T,R,s)=>{s.d(R,{a:()=>f});var a=s(5783),t=s(5558),n=s(6354),r=s(2809),e=s(5306);const y=a.NW({Id:a.ai,FormOfAddress:a.Yj,Nationality:(0,e.c$)(a.Yj),AddressLine1:(0,e.c$)(a.Yj),AddressLine2:(0,e.c$)(a.Yj),BillingAddress:(0,e.c$)(a.Yj),Birthdate:(0,e.c$)(e.iC),CorrespondenceAddress:(0,e.c$)(a.Yj),DisplayEmail:(0,e.c$)(a.Yj),Email:(0,e.bW)(a.Yj),Email2:(0,e.bW)(a.Yj),FirstName:(0,e.c$)(a.Yj),Gender:(0,e.c$)(a.KC([a.eu("M"),a.eu("F"),a.eu("X")])),HomeTown:(0,e.c$)(a.Yj),LastName:(0,e.c$)(a.Yj),FullName:(0,e.c$)(a.Yj),Location:(0,e.c$)(a.Yj),MiddleName:(0,e.c$)(a.Yj),NativeLanguage:(0,e.c$)(a.Yj),PhoneMobile:(0,e.c$)(a.Yj),PhonePrivate:(0,e.c$)(a.Yj),PhoneBusiness:(0,e.bW)(a.Yj),SocialSecurityNumber:(0,e.c$)(a.Yj),StayPermit:(0,e.c$)(a.ai),StayPermitExpiry:(0,e.c$)(e.iC),Zip:(0,e.c$)(a.Yj)});var M=s(785),v=s(5437),u=s(6952),l=s(4438),i=s(1626);let f=(()=>{class h extends u.G{constructor(_,A){super(_,A,y,"Persons"),this.personEmailCodec=a.NW((0,v.U)(this.codec.props,["Email","FormOfAddress"]))}getListForIds(_){return this.getList({params:{"filter.Id":`;${_.join(";")}`}})}getMyself(_){return this.http.get(`${this.baseUrl}/me`,_).pipe((0,t.n)((0,M.D4)(this.codec)))}getByIdWithEmailInfos(_){return this.http.get(`${this.baseUrl}/`,{params:{"filter.Id=":_.toString(),fields:["FormOfAddress","Email"].join(",")}}).pipe((0,t.n)((0,M.k$)(this.personEmailCodec)),(0,n.T)(A=>A[0]))}update(_,A,b,O){return this.http.put(`${this.baseUrl}/${_}`,{PhonePrivate:A,PhoneMobile:b,Email2:O}).pipe((0,n.T)(()=>{}))}static#e=this.\u0275fac=function(A){return new(A||h)(l.KVO(i.Qq),l.KVO(r.yy))};static#n=this.\u0275prov=l.jDH({token:h,factory:h.\u0275fac,providedIn:"root"})}return h})()},4561:(T,R,s)=>{s.d(R,{m:()=>X});var a=s(1626),t=s(4572),n=s(7673),r=s(5558),e=s(5964),y=s(6354),M=s(3382),v=s(172),u=s(1803),l=s(9728),i=s(4273);function f(C,Y){const o=(0,i.a)(C),d=(0,i.a)(Y),E=o.getTime()-d.getTime();return E<0?-1:E>0?1:E}var g=s(4438),c=s(2949),I=s(4688),p=s(2809),P=s(5783),m=s(5306);const x=P.NW({Email:(0,m.c$)(P.Yj),Email2:(0,m.c$)(P.Yj),PhoneBusiness:(0,m.c$)(P.Yj),CompanyName:(0,m.bW)(P.Yj),CompanyNameAddition:(0,m.bW)(P.Yj),Firstname:(0,m.c$)(P.Yj),Lastname:(0,m.c$)(P.Yj),AddressLine1:(0,m.bW)(P.Yj),AddressLine2:(0,m.bW)(P.Yj),PostalCode:(0,m.c$)(P.Yj),Location:(0,m.c$)(P.Yj),Id:P.ai});var U=s(6952);let W=(()=>{class C extends U.G{constructor(o,d){super(o,d,x,"ApprenticeshipManagers")}static#e=this.\u0275fac=function(d){return new(d||C)(g.KVO(a.Qq),g.KVO(p.yy))};static#n=this.\u0275prov=g.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})();const G=P.NW({Email:(0,m.c$)(P.Yj),Email2:(0,m.c$)(P.Yj),PhoneBusiness:(0,m.c$)(P.Yj),PhoneMobile:(0,m.c$)(P.Yj),Firstname:(0,m.c$)(P.Yj),Lastname:(0,m.c$)(P.Yj),Id:P.ai});let K=(()=>{class C extends U.G{constructor(o,d){super(o,d,G,"JobTrainers")}static#e=this.\u0275fac=function(d){return new(d||C)(g.KVO(a.Qq),g.KVO(p.yy))};static#n=this.\u0275prov=g.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})();var V=s(2673),N=s(8296);let X=(()=>{class C{constructor(o,d,E,L,F,j){this.studentService=o,this.personsService=d,this.apprenticeshipManagersService=E,this.jobTrainersService=L,this.loadingService=F,this.dropDownItemsService=j,this.loading$=this.loadingService.loading$}getProfile(o){return this.loadingService.load((0,t.z)([this.loadStudent(o),this.loadLegalRepresentatives(o),this.loadApprenticeshipContracts(o)]).pipe((0,r.n)((0,M.i)(this.mapToProfile.bind(this)))))}getMyProfile(){return this.loadingService.load(this.personsService.getMyself({context:(new a._y).set(u.Q,{disableErrorHandlingForStatus:[403]})}).pipe((0,r.n)(o=>(0,t.z)([(0,n.of)(o),this.loadLegalRepresentatives(o.Id),this.loadApprenticeshipContracts(o.Id),this.loadStayPermitValue(o.StayPermit)]))).pipe((0,r.n)((0,M.i)(this.mapToProfile.bind(this))),(0,e.p)(l.TM)))}loadStudent(o){return this.studentService.get(o,{context:(new a._y).set(u.Q,{disableErrorHandlingForStatus:[404]})}).pipe((0,v.Sq)())}loadLegalRepresentatives(o){return this.studentService.getLegalRepresentatives(o)}loadApprenticeshipContracts(o){return this.studentService.getCurrentApprenticeshipContracts(o,{context:(new a._y).set(u.Q,{disableErrorHandlingForStatus:[404]})}).pipe((0,v.Sq)([]))}loadStayPermitValue(o){return this.dropDownItemsService.getStayPermits().pipe((0,y.T)(d=>d.find(E=>E.Key===o)?.Value||null))}mapToProfile(o,d,E,L=null){return o?(d=this.getRelevantLegalRepresentatives(o,d),(0,t.z)([this.loadLegalRepresentativPersons(d),this.loadJobTrainers(E),this.loadApprenticeshipManagers(E)]).pipe((0,y.T)(([F,j,S])=>this.createProfile(o,L,d,F,E,S,j)))):(0,n.of)(null)}loadLegalRepresentativPersons(o){return 0===o.length?(0,n.of)([]):this.personsService.getListForIds(o.map(d=>d.RepresentativeId))}loadJobTrainers(o){const d=o.map(E=>E.JobTrainer).filter(E=>"number"==typeof E);return 0===d.length?(0,n.of)([]):(0,t.z)(d.map(E=>this.jobTrainersService.get(E)))}loadApprenticeshipManagers(o){const d=o.map(E=>E.ApprenticeshipManagerId);return 0===d.length?(0,n.of)([]):(0,t.z)(d.map(E=>this.apprenticeshipManagersService.get(E)))}createProfile(o,d,E,L,F,j,S){return{student:o,stayPermitValue:d||void 0,legalRepresentativePersons:E.map(B=>this.findPerson(B.RepresentativeId,L)).filter(l.TM),apprenticeshipCompanies:F.map(B=>this.createApprenticeshipCompany(B,j,S))}}getRelevantLegalRepresentatives(o,d){const E=function $(C){return function A(C,Y){const o=(0,i.a)(C),d=(0,i.a)(Y),E=f(o,d),L=Math.abs(function D(C,Y){const o=(0,i.a)(C),d=(0,i.a)(Y);return o.getFullYear()-d.getFullYear()}(o,d));o.setFullYear(1584),d.setFullYear(1584);const j=E*(L-+(f(o,d)===-E));return 0===j?0:j}(new Date,C.Birthdate||new Date)>=18}(o);return d.filter(L=>!E||L.RepresentativeAfterMajority)}createApprenticeshipCompany(o,d,E){return{apprenticeshipContract:o,jobTrainer:this.findPerson(o.JobTrainer,E),apprenticeshipManager:this.findPerson(o.ApprenticeshipManagerId,d)}}findPerson(o,d){return o&&d.find(E=>E.Id===o)||null}static#e=this.\u0275fac=function(d){return new(d||C)(g.KVO(c.y),g.KVO(I.a),g.KVO(W),g.KVO(K),g.KVO(V.U),g.KVO(N.v))};static#n=this.\u0275prov=g.jDH({token:C,factory:C.\u0275fac,providedIn:"root"})}return C})()},2949:(T,R,s)=>{s.d(R,{y:()=>A});var a=s(1626),t=s(5558),n=s(2809),r=s(5783),e=s(5306);const y=r.NW({Id:r.ai,JobTrainer:(0,e.c$)(r.ai),ApprenticeshipManagerId:r.ai,ContractDateFrom:(0,e.c$)(e.iC),ContractDateTo:(0,e.c$)(e.iC)}),M=r.NW({Id:r.ai,RepresentativeId:r.ai,RepresentativeAfterMajority:r.zM});var v=s(6611);const u=r.NW({Id:r.Yj,LessonRef:e.Or,StudentRef:e.Or,TypeRef:e.Or,Type:(0,e.c$)(r.Yj),Comment:(0,e.c$)(r.Yj),StudentFullName:r.Yj,HRef:r.Yj}),l=r.NW({LessonRef:e.Or,StudentRef:e.Or,TypeRef:e.Or,Comment:(0,e.c$)(r.Yj),StudentFullName:r.Yj,Type:(0,e.c$)(r.Yj),RegistrationId:r.ai,HRef:r.Yj});var i=s(9573);const f=r.NW({Id:r.ai,From:e.iC,To:e.iC,EventId:r.ai,EventNumber:r.Yj,EventDesignation:r.Yj,EventLocation:(0,e.c$)(r.Yj),EventManagerInformation:r.Yj});var h=s(785),D=s(3220),_=s(4438);let A=(()=>{class b extends D.X{constructor($,g){super($,g,i.o,"Students","FullName")}getLegalRepresentatives($,g){return this.http.get(`${this.baseUrl}/${$}/LegalRepresentatives`,{params:g}).pipe((0,t.n)((0,h.k$)(M)))}getCurrentApprenticeshipContracts($,g){return this.http.get(`${this.baseUrl}/${$}/ApprenticeshipContracts/Current`,g).pipe((0,t.n)((0,h.k$)(y)))}getLessonAbsences($,g){return this.http.get(`${this.baseUrl}/${$}/LessonAbsences`,{params:g}).pipe((0,t.n)((0,h.k$)(v.a)))}getLessonIncidents($,g){return this.http.get(`${this.baseUrl}/${$}/LessonIncidents`,{params:g}).pipe((0,t.n)((0,h.k$)(l)))}getLessonDispensations($,g){return this.http.get(`${this.baseUrl}/${$}/LessonDispensations`,{params:g}).pipe((0,t.n)((0,h.k$)(u)))}getTimetableEntries($,g={}){return g instanceof a.Nl||(g=new a.Nl({fromObject:g})),g=g.set("fields","Id,From,To,EventId,EventNumber,EventDesignation,EventLocation,EventManagerInformation"),this.http.get(`${this.baseUrl}/${$}/TimetableEntries/CurrentSemester`,{params:g}).pipe((0,t.n)((0,h.k$)(f)))}static#e=this.\u0275fac=function(g){return new(g||b)(_.KVO(a.Qq),_.KVO(n.yy))};static#n=this.\u0275prov=_.jDH({token:b,factory:b.\u0275fac,providedIn:"root"})}return b})()},3220:(T,R,s)=>{s.d(R,{X:()=>v});var a=s(5783),t=s(5558),n=s(6354),r=s(785),e=s(5437),y=s(6952);class v extends y.G{constructor(l,i,f,h,D,_="Id"){super(l,i,f,h),this.labelAttr=D,this.keyAttr=_,this.typeaheadCodec=a.NW((0,e.U)(this.codec.props,[this.keyAttr,this.labelAttr]))}getTypeaheadItems(l,i){const f={params:{fields:[this.keyAttr,this.labelAttr].join(","),[`filter.${this.labelAttr}`]:`~*${l}*`}};return this.http.get(`${this.baseUrl}/`,i?this.mergeHttpParams(f,i):f).pipe((0,t.n)((0,r.k$)(this.typeaheadCodec)),(0,n.T)(h=>h.map(D=>({Key:D[this.keyAttr],Value:D[this.labelAttr]}))))}getTypeaheadItemByKey(l){return this.http.get(`${this.baseUrl}/${l}`,{params:{fields:[this.keyAttr,this.labelAttr].join(",")}}).pipe((0,t.n)((0,r.D4)(this.typeaheadCodec)),(0,n.T)(i=>({Key:i[this.keyAttr],Value:i[this.labelAttr]})))}mergeHttpParams(l,i){const f={params:{...l.params,...i.params}};return i.params.fields&&(f.params.fields=l.params.fields.concat(",",i.params.fields)),f}}}}]);