import{p as K,r as Q,s as X,t as Z,w as ee}from"./chunk-5FFJJJZ5.js";import"./chunk-Y4QYVF5K.js";import"./chunk-TCEEBBQP.js";import{d as W}from"./chunk-VNNH2VUZ.js";import{a as V,b as z}from"./chunk-KCOBA4SV.js";import{b as Y}from"./chunk-GWJDWK72.js";import{C as F,w as k}from"./chunk-7TIAFCYF.js";import{$a as u,Ab as I,Bb as $,Cb as M,Db as b,Eb as f,Fb as N,Kb as o,La as j,Lb as a,M as B,P as _,Qa as y,Rd as x,Sd as w,Td as U,Va as O,X as A,_ as p,_a as h,aa as l,ab as m,ec as R,ed as J,h as E,hb as H,n as d,o as T,rb as C,s as P,sb as G,ya as c,za as v,zc as q}from"./chunk-TTJNYD2F.js";var S=(()=>{class e{constructor(s,t,n,g,oe,ae,de){this.storageService=s,this.loadingService=t,this.coursesRestService=n,this.subscriptionRestService=g,this.reportsService=oe,this.gradingScalesRestService=ae,this.settings=de,this.studentId$=new E(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(B(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(d(i=>i.slice().sort((r,pe)=>r.Designation.localeCompare(pe.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(d(i=>i.flatMap(r=>r.Id))),this.subscriptionIds$=T([this.studentId$,this.studentCourseIds$]).pipe(_(([i,r])=>this.subscriptionRestService.getSubscriptionIdsByStudentAndCourse(i,r))),this.testReports$=this.subscriptionIds$.pipe(d(i=>this.reportsService.getStudentSubscriptionGradesReports(i))),this.tests$=this.studentCourses$.pipe(d(i=>i.flatMap(r=>r.Tests).filter(k))),this.gradingScaleIdsFromTests$=this.tests$.pipe(d(i=>[...i.map(r=>r.GradingScaleId)].filter(k).filter(F))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe(d(i=>i.flatMap(r=>r.GradingScaleId).filter(k).filter(F))),this.gradingScaleIds$=T([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe(d(([i,r])=>i.concat(r).filter(F))),this.gradingScales$=this.gradingScaleIds$.pipe(_(i=>P(i.map(r=>this.gradingScalesRestService.getGradingScale(r)))));let D=this.storageService.getPayload()?.id_person;D&&this.studentId$.next(Number(D))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}static{this.\u0275fac=function(t){return new(t||e)(p(U),p(z),p(K),p(Q),p(W),p(X),p(J))}}static{this.\u0275prov=A({token:e,factory:e.\u0275fac})}}return e})();var me=()=>[],ie=(()=>{class e{constructor(s){this.myGradesService=s}static{this.\u0275fac=function(t){return new(t||e)(v(S))}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades-header"]],standalone:!0,features:[f],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(t,n){if(t&1&&(h(0,"div",0)(1,"div"),C(2),o(3,"translate"),u(),h(4,"div"),m(5,"bkd-reports-link",1),o(6,"async"),u()()),t&2){let g;c(2),G(a(3,2,"my-grades.header")),c(3),y("reports",(g=a(6,4,n.myGradesService.testReports$))!==null&&g!==void 0?g:N(6,me))}},dependencies:[V,R,w,x],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return e})();function le(e,ne){e&1&&m(0,"bkd-spinner")}function ue(e,ne){if(e&1&&m(0,"bkd-dossier-grades-view",1),e&2){H();let s=M(0),t=M(2),n=M(4);y("courses",s)("studentId",t)("gradingScales",n)("isEditable",!1)}}var re=(()=>{class e{constructor(s){this.myGradesService=s}static{this.\u0275fac=function(t){return new(t||e)(v(S))}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades-show"]],standalone:!0,features:[b([Z]),f],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(t,n){t&1&&(I(0),o(1,"async"),I(2),o(3,"async"),I(4),o(5,"async"),h(6,"div",0)(7,"h1"),C(8),o(9,"translate"),u(),m(10,"bkd-my-grades-header"),j(11,le,1,0,"bkd-spinner"),o(12,"async"),j(13,ue,1,4,"bkd-dossier-grades-view",1),u()),t&2&&($(a(1,2,n.myGradesService.studentCoursesSorted$)),c(2),$(a(3,5,n.myGradesService.studentId$)),c(2),$(a(5,8,n.myGradesService.gradingScales$)),c(4),G(a(9,11,"my-grades.title")),c(3),O(a(12,13,n.myGradesService.loading$)?11:13))},dependencies:[ie,ee,Y,R,w,x]})}}return e})();var se=(()=>{class e{constructor(){}static{this.\u0275fac=function(t){return new(t||e)}}static{this.\u0275cmp=l({type:e,selectors:[["bkd-my-grades"]],standalone:!0,features:[b([S]),f],decls:1,vars:0,template:function(t,n){t&1&&m(0,"router-outlet")},dependencies:[q]})}}return e})();var Ae=[{path:"",component:se,children:[{path:"",component:re}]}];export{Ae as MY_GRADES_ROUTES};
