import{n as v,o as P,p as m,s as $}from"./chunk-ZXUJZ6KS.js";import{H as e,Q as s,_ as p,ba as f,ca as d,da as n,j as l,ja as g,oa as h,q as u,sd as S,v as a,x as c}from"./chunk-GP622B77.js";var k=(()=>{let r=class r{constructor(){this.router=h($),this.viewportScroller=h(S),this.scrollPositions={},this.previousRoute=null,this.currentRoute=this.getInitialActivatedRouteSnapshot(),this.currentScrollPosition=[0,0],this.destroy$=new l,this.activationEnd$=this.router.events.pipe(e(R)),this.navigationEnd$=this.router.events.pipe(e(C)),this.navigationStart$=this.router.events.pipe(e(y)),this.scrollPosition$=this.navigationStart$.pipe(a(this.getScrollPosition.bind(this))),this.route$=this.activationEnd$.pipe(s(1)).pipe(c(t=>[u(t),this.navigationEnd$.pipe(f(()=>this.activationEnd$.pipe(s(1))))]),d(),a(t=>t.snapshot),p(1)),this.scrollPosition$.pipe(n(this.destroy$)).subscribe(t=>this.currentScrollPosition=t),this.route$.pipe(n(this.destroy$)).subscribe(t=>{this.previousRoute=this.currentRoute,this.currentRoute=t})}ngOnDestroy(){this.destroy$.next()}restore(){if(!this.currentRoute||!this.requiresStoring(this.currentRoute))return;if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){let i=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[i]||[0,0])}let t=this.currentRoute;this.route$.pipe(s(1),n(this.destroy$),e(i=>this.shouldStoreFor(t,i))).subscribe(()=>{let i=this.getPath(t);this.scrollPositions[i]=this.currentScrollPosition})}getScrollPosition(){return this.viewportScroller.getScrollPosition()}scrollToPosition(t){this.viewportScroller.scrollToPosition(t)}getPath(t){return t?"/"+t.pathFromRoot.map(i=>i.routeConfig&&i.routeConfig.path).filter(i=>i).join("/"):"/"}requiresStoring(t){return!!(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}shouldStoreFor(t,i){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(i))}getInitialActivatedRouteSnapshot(){let t=this.router.routerState.snapshot.root;for(;t.firstChild;)t=t.firstChild;return t}};r.\u0275fac=function(i){return new(i||r)},r.\u0275prov=g({token:r,factory:r.\u0275fac,providedIn:"root"});let o=r;return o})();function R(o){return o instanceof m}function y(o){return o instanceof v}function C(o){return o instanceof P}export{k as a};
