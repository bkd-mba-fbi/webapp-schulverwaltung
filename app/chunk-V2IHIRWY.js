import{l as U,m as V,n as J,s as K}from"./chunk-6TCJNTKT.js";import{i as Y}from"./chunk-XWISOVKN.js";import{e as H,f as N}from"./chunk-6LRQCBUO.js";import"./chunk-Y4QYVF5K.js";import"./chunk-JE6RMKPQ.js";import"./chunk-RXV77OBQ.js";import"./chunk-M3VKTN3S.js";import{a as O}from"./chunk-USF5QQBL.js";import{b as z}from"./chunk-RWAE7AP7.js";import"./chunk-GXPB5I4C.js";import"./chunk-D2H555EG.js";import{i as q}from"./chunk-QWYAXZZX.js";import"./chunk-KKDVS2NL.js";import"./chunk-WNZFLLQC.js";import"./chunk-DVBPCEX4.js";import{b as R}from"./chunk-GH7I4V3C.js";import{H as j,O as A,s as T}from"./chunk-RYYQAFJB.js";import{Ac as v,Bc as y,Cc as C,F as k,Fc as G,Gc as P,Hb as D,Ib as E,Jb as B,Lc as o,Mc as n,Ob as h,Pb as u,Q as _,Qb as m,Rb as p,X as f,_ as I,dc as F,fb as d,ha as L,j as w,je as M,ma as s,rc as S,sc as g,t as a,td as b,u as $,ub as c}from"./chunk-CHBP6U4G.js";var l=(()=>{class t{constructor(){this.storageService=s(O),this.loadingService=s(H),this.coursesRestService=s(U),this.subscriptionRestService=s(z),this.reportsService=s(Y),this.gradingScalesRestService=s(V),this.studentId$=new w(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(f(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(a(e=>e.slice().sort((i,ee)=>i.Designation.localeCompare(ee.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Id))),this.subscriptionIds$=$([this.studentId$,this.studentCourseIds$]).pipe(k(([e,i])=>i.length>0),I(([e,i])=>this.subscriptionRestService.getSubscriptionIdsByStudentAndCourse(e,i))),this.testReports$=this.subscriptionIds$.pipe(a(e=>this.reportsService.getStudentSubscriptionGradesReports(e))),this.tests$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Tests).filter(R))),this.gradingScaleIds$=$([this.tests$.pipe(a(e=>[...e.map(i=>i.GradingScaleId)])),this.studentCourses$.pipe(a(e=>e.map(i=>i.GradingScaleId)))]).pipe(a(([e,i])=>A([...e,...i]).filter(R)),_(j),f(1)),this.gradingScales$=this.gradingScaleIds$.pipe(I(e=>this.gradingScalesRestService.getListForIds(e)),f(1));let r=this.storageService.getPayload()?.id_person;r&&this.studentId$.next(Number(r))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=L({token:t,factory:t.\u0275fac})}}return t})();var te=()=>[],Q=(()=>{class t{constructor(){this.myGradesService=s(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-header"]],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div"),S(2),o(3,"translate"),m(),u(4,"div"),p(5,"bkd-reports-link",1),o(6,"async"),m()()),e&2&&(d(2),g(n(3,2,"my-grades.header")),d(3),h("reports",n(6,4,i.myGradesService.testReports$)??P(6,te)))},dependencies:[N,b,M],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return t})();function ie(t,Z){t&1&&p(0,"bkd-spinner")}function re(t,Z){if(t&1&&p(0,"bkd-dossier-grades-view",1),t&2){F();let r=C(0),e=C(2),i=C(4);h("courses",r)("studentId",e)("gradingScales",i)("isEditable",!1)}}var W=(()=>{class t{constructor(){this.myGradesService=s(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-show"]],features:[G([J])],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(e,i){e&1&&(v(0),o(1,"async"),v(2),o(3,"async"),v(4),o(5,"async"),u(6,"div",0)(7,"h1"),S(8),o(9,"translate"),m(),p(10,"bkd-my-grades-header"),D(11,ie,1,0,"bkd-spinner"),o(12,"async"),E(13,re,1,4,"bkd-dossier-grades-view",1),m()),e&2&&(y(n(1,2,i.myGradesService.studentCoursesSorted$)),d(2),y(n(3,5,i.myGradesService.studentId$)),d(2),y(n(5,8,i.myGradesService.gradingScales$)),d(4),g(n(9,11,"my-grades.title")),d(3),B(n(12,13,i.myGradesService.loading$)?11:13))},dependencies:[Q,K,q,b,M],encapsulation:2})}}return t})();var X=(()=>{class t{constructor(){}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades"]],features:[G([l])],decls:1,vars:0,template:function(e,i){e&1&&p(0,"router-outlet")},dependencies:[T],encapsulation:2})}}return t})();var je=[{path:"",component:X,children:[{path:"",component:W}]}];export{je as MY_GRADES_ROUTES};
