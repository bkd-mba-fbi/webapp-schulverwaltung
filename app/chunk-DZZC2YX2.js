import{E as n,L as f,O as d,P as g,Q as a,W as S,Z as c,Zb as v,e as l,k as u,lc as m,m as h,mc as P,nc as $,o as p,qc as R,w as s}from"./chunk-XTHSYQMN.js";var N=(()=>{let e=class e{constructor(t,i){this.router=t,this.viewportScroller=i,this.scrollPositions={},this.previousRoute=null,this.currentRoute=this.getInitialActivatedRouteSnapshot(),this.currentScrollPosition=[0,0],this.destroy$=new l,this.activationEnd$=this.router.events.pipe(s(y)),this.navigationEnd$=this.router.events.pipe(s(F)),this.navigationStart$=this.router.events.pipe(s(C)),this.scrollPosition$=this.navigationStart$.pipe(h(this.getScrollPosition.bind(this))),this.route$=this.activationEnd$.pipe(n(1)).pipe(p(r=>[u(r),this.navigationEnd$.pipe(d(()=>this.activationEnd$.pipe(n(1))))]),g(),h(r=>r.snapshot),f(1)),this.scrollPosition$.pipe(a(this.destroy$)).subscribe(r=>this.currentScrollPosition=r),this.route$.pipe(a(this.destroy$)).subscribe(r=>{this.previousRoute=this.currentRoute,this.currentRoute=r})}ngOnDestroy(){this.destroy$.next()}restore(){if(!this.currentRoute||!this.requiresStoring(this.currentRoute))return;if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){let i=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[i]||[0,0])}let t=this.currentRoute;this.route$.pipe(n(1),a(this.destroy$),s(i=>this.shouldStoreFor(t,i))).subscribe(()=>{let i=this.getPath(t);this.scrollPositions[i]=this.currentScrollPosition})}getScrollPosition(){return this.viewportScroller.getScrollPosition()}scrollToPosition(t){this.viewportScroller.scrollToPosition(t)}getPath(t){return t?"/"+t.pathFromRoot.map(i=>i.routeConfig&&i.routeConfig.path).filter(i=>i).join("/"):"/"}requiresStoring(t){return!!(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}shouldStoreFor(t,i){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(i))}getInitialActivatedRouteSnapshot(){let t=this.router.routerState.snapshot.root;for(;t.firstChild;)t=t.firstChild;return t}};e.\u0275fac=function(i){return new(i||e)(c(R),c(v))},e.\u0275prov=S({token:e,factory:e.\u0275fac,providedIn:"root"});let o=e;return o})();function y(o){return o instanceof $}function C(o){return o instanceof m}function F(o){return o instanceof P}export{N as a};
