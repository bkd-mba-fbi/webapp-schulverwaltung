(window.webpackJsonp=window.webpackJsonp||[]).push([[9],{Muja:function(t,e,n){"use strict";var s=n("EqEh");e.a=function(t,e){return Object(s.a)(t,e)}},wbm3:function(t,e,n){"use strict";n.r(e),n.d(e,"EvaluateAbsencesModule",function(){return st});var s=n("PCNd"),r=n("tyNb"),i=n("1G5W"),c=n("CCnw"),a=n("CqUA"),o=n("NPit"),l=n("fhBx"),u=n("Xr/R"),b=n("fXoL"),d=n("ofXK");let f=(()=>{class t extends l.b{constructor(t,e,n,s){super(t,e,n,"/evaluate-absences"),this.lessonPresenceService=s,this.queryParamsString$.pipe(Object(i.a)(this.destroy$)).subscribe(t=>this.confirmBackLinkParams={returnparams:t})}getInitialFilter(){return{student:null,educationalEvent:null,studyClass:null}}isValidFilter(t){return Boolean(t.student||t.educationalEvent||t.studyClass)}getInitialSorting(){return{key:"StudentFullName",ascending:!0}}loadEntries(t,e,n){return this.loadingService.load(this.lessonPresenceService.getStatistics(t,e,n),l.a)}buildParamsFromFilter(t){return Object(o.a)(t)}}return t.\u0275fac=function(e){return new(e||t)(b.Zb(d.i),b.Zb(a.a),b.Zb(u.a),b.Zb(c.a))},t.\u0275prov=b.Ib({token:t,factory:t.\u0275fac}),t})();var h=n("qUtt"),g=n("0HM3");let p=(()=>{class t{constructor(t){this.state=t}ngOnInit(){}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(f))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences"]],features:[b.yb([f,{provide:h.a,useExisting:f},{provide:g.a,useValue:"/evaluate-absences"}])],decls:1,vars:0,template:function(t,e){1&t&&b.Nb(0,"router-outlet")},directives:[r.k],styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),t})();var m=n("lJxs"),v=n("IzEk"),y=n("eIep"),S=n("yl8S"),P=n("KJh6"),R=n("Ug8t"),C=n("EOpz"),O=n("mmcK"),z=n("vjgy"),$=n("4vbw"),I=n("jSy9"),k=n("sYmb");let F=(()=>{class t{constructor(t,e,n){this.studentsService=t,this.educationalEventsService=e,this.studyClassesService=n,this.filter={student:null,educationalEvent:null,studyClass:null},this.filterChange=new b.n,this.classesHttpFilter={params:{fields:"IsActive","filter.IsActive":"=true"}}}ngOnInit(){}show(){this.filterChange.emit(this.filter)}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(O.a),b.Mb(z.a),b.Mb($.a))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences-header"]],inputs:{filter:"filter"},outputs:{filterChange:"filterChange"},decls:20,vars:19,consts:[[1,"filters","mb-2"],[1,"form-group"],[3,"typeaheadService","value","valueChange"],[3,"typeaheadService","value","additionalHttpParams","valueChange"],[1,"buttons"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(t,e){1&t&&(b.Sb(0,"div",0),b.Sb(1,"div",1),b.Sb(2,"label"),b.Dc(3),b.gc(4,"translate"),b.Rb(),b.Sb(5,"erz-typeahead",2),b.dc("valueChange",function(t){return e.filter.student=t}),b.Rb(),b.Rb(),b.Sb(6,"div",1),b.Sb(7,"label"),b.Dc(8),b.gc(9,"translate"),b.Rb(),b.Sb(10,"erz-typeahead",2),b.dc("valueChange",function(t){return e.filter.educationalEvent=t}),b.Rb(),b.Rb(),b.Sb(11,"div",1),b.Sb(12,"label"),b.Dc(13),b.gc(14,"translate"),b.Rb(),b.Sb(15,"erz-typeahead",3),b.dc("valueChange",function(t){return e.filter.studyClass=t}),b.Rb(),b.Rb(),b.Sb(16,"div",4),b.Sb(17,"button",5),b.dc("click",function(){return e.show()}),b.Dc(18),b.gc(19,"translate"),b.Rb(),b.Rb(),b.Rb()),2&t&&(b.zb(3),b.Ec(b.hc(4,11,"evaluate-absences.header.student")),b.zb(2),b.lc("typeaheadService",e.studentsService)("value",e.filter.student),b.zb(3),b.Ec(b.hc(9,13,"evaluate-absences.header.module-instance")),b.zb(2),b.lc("typeaheadService",e.educationalEventsService)("value",e.filter.educationalEvent),b.zb(3),b.Ec(b.hc(14,15,"evaluate-absences.header.study-class")),b.zb(2),b.lc("typeaheadService",e.studyClassesService)("value",e.filter.studyClass)("additionalHttpParams",e.classesHttpFilter),b.zb(3),b.Fc(" ",b.hc(19,17,"evaluate-absences.header.show")," "))},directives:[I.a],pipes:[k.c],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;padding:1.5rem;border-bottom:1px solid #dee2e6}.filters[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.form-group[_ngcontent-%COMP%]{flex:1;min-width:20rem;max-width:40rem;margin-right:1.5rem;margin-bottom:.75rem}.buttons[_ngcontent-%COMP%]{flex:none;margin-top:2.75rem;margin-right:0}@media (max-width:767.98px){.buttons[_ngcontent-%COMP%]{width:100%;margin-top:1.5rem;margin-bottom:1.5rem}}"],changeDetection:0}),t})();var E=n("dlKe"),w=n("4Kj8");function j(t,e){if(1&t&&(b.Sb(0,"a",15),b.gc(1,"async"),b.gc(2,"async"),b.Sb(3,"i",16),b.Dc(4,"description"),b.Rb(),b.Rb()),2&t){const t=b.fc(5);b.Eb("disabled",b.hc(1,3,!t.reportUrl$)),b.lc("href",b.hc(2,5,t.reportUrl$),b.xc)}}function x(t,e){if(1&t){const t=b.Tb();b.Sb(0,"th",17),b.dc("click",function(){b.vc(t);const n=e.$implicit;return b.fc(5).state.toggleSorting(n.key)}),b.Sb(1,"div",18),b.Sb(2,"div",19),b.Dc(3),b.gc(4,"translate"),b.Rb(),b.Sb(5,"div",20),b.Dc(6),b.gc(7,"async"),b.Rb(),b.Rb(),b.Rb()}if(2&t){const t=e.$implicit,n=b.fc(5);b.lc("ngClass",t.label),b.zb(3),b.Fc(" ",b.hc(4,3,"evaluate-absences.list.header."+t.label)," "),b.zb(3),b.Fc(" ",b.hc(7,5,n.getSortingChar$(t))," ")}}const M=function(t){return["student",t]},B=function(t){return{returnparams:t}};function D(t,e){if(1&t&&(b.Sb(0,"a",24),b.gc(1,"async"),b.Dc(2),b.Rb()),2&t){const t=b.fc().$implicit,e=b.fc().$implicit,n=b.fc(6);b.lc("routerLink",b.pc(5,M,e.StudentRef.Id))("queryParams",b.pc(7,B,b.hc(1,3,n.profileReturnParams$))),b.zb(2),b.Fc(" ",e[t.key]," ")}}function A(t,e){if(1&t&&b.Dc(0),2&t){const t=b.fc().$implicit,e=b.fc().$implicit;b.Fc(" ",e[t.key]," ")}}function L(t,e){if(1&t&&(b.Sb(0,"td"),b.gc(1,"translate"),b.Bc(2,D,3,9,"a",22),b.Bc(3,A,1,1,"ng-template",null,23,b.Cc),b.Rb()),2&t){const t=e.$implicit,n=b.uc(4);b.Ab("data-label",b.hc(1,3,"evaluate-absences.list.header."+t.label)),b.zb(2),b.lc("ngIf","StudentFullName"===t.key)("ngIfElse",n)}}function _(t,e){if(1&t&&(b.Sb(0,"tr"),b.Bc(1,L,5,5,"td",21),b.Rb()),2&t){const t=b.fc(6);b.zb(1),b.lc("ngForOf",t.columns)}}function T(t,e){if(1&t&&(b.Sb(0,"tbody"),b.Bc(1,_,2,1,"tr",21),b.Rb()),2&t){const t=b.fc(4).erzLet;b.zb(1),b.lc("ngForOf",t.entries)}}function N(t,e){1&t&&b.Nb(0,"erz-spinner",25)}function q(t,e){if(1&t){const t=b.Tb();b.Sb(0,"button",26),b.dc("click",function(){return b.vc(t),b.fc(5).state.nextPage()}),b.Dc(1),b.gc(2,"translate"),b.Rb()}2&t&&(b.zb(1),b.Fc(" ",b.hc(2,1,"global.pagination.load-more")," "))}function U(t,e){if(1&t){const t=b.Tb();b.Sb(0,"div",7),b.Sb(1,"div",8),b.Bc(2,j,5,7,"a",9),b.Rb(),b.Sb(3,"table",10),b.dc("scrolled",function(){return b.vc(t),b.fc(4).onScroll()}),b.Sb(4,"thead"),b.Sb(5,"tr"),b.Bc(6,x,8,7,"th",11),b.Rb(),b.Rb(),b.Bc(7,T,2,1,"tbody",12),b.Rb(),b.Bc(8,N,1,0,"erz-spinner",13),b.Bc(9,q,3,3,"button",14),b.Rb()}if(2&t){const t=b.fc(3).erzLet,e=b.fc();b.zb(2),b.lc("ngIf",!t.loadingPage),b.zb(4),b.lc("ngForOf",e.columns),b.zb(1),b.lc("ngIf",t.entries&&t.entries.length>0),b.zb(1),b.lc("ngIf",t.loadingPage),b.zb(1),b.lc("ngIf",t.hasMore&&!t.loadingPage)}}function K(t,e){1&t&&(b.Sb(0,"p",27),b.Dc(1),b.gc(2,"translate"),b.Rb()),2&t&&(b.zb(1),b.Fc(" ",b.hc(2,1,"evaluate-absences.no-entries")," "))}function Z(t,e){if(1&t&&(b.Qb(0),b.Bc(1,U,10,5,"div",5),b.Bc(2,K,3,3,"ng-template",null,6,b.Cc),b.Pb()),2&t){const t=b.uc(3),e=b.fc(2).erzLet;b.zb(1),b.lc("ngIf",e.entries&&e.entries.length>0||e.loadingPage)("ngIfElse",t)}}function G(t,e){1&t&&b.Nb(0,"erz-spinner")}function H(t,e){if(1&t&&(b.Qb(0),b.Bc(1,Z,4,2,"ng-container",2),b.gc(2,"async"),b.Bc(3,G,1,0,"ng-template",null,4,b.Cc),b.Pb()),2&t){const t=b.uc(4),e=b.fc(2);b.zb(1),b.lc("ngIf",!b.hc(2,2,e.state.loading$))("ngIfElse",t)}}function J(t,e){1&t&&(b.Sb(0,"p",27),b.Dc(1),b.gc(2,"translate"),b.Rb()),2&t&&(b.zb(1),b.Ec(b.hc(2,1,"evaluate-absences.no-filter")))}function X(t,e){if(1&t){const t=b.Tb();b.Qb(0),b.Sb(1,"erz-evaluate-absences-header",1),b.dc("filterChange",function(e){return b.vc(t),b.fc().state.setFilter(e)}),b.gc(2,"async"),b.Rb(),b.Bc(3,H,5,4,"ng-container",2),b.gc(4,"async"),b.Bc(5,J,3,3,"ng-template",null,3,b.Cc),b.Pb()}if(2&t){const t=b.uc(6),e=b.fc();b.zb(1),b.lc("filter",b.hc(2,3,e.filterFromParams$)),b.zb(2),b.lc("ngIf",b.hc(4,5,e.state.isFilterValid$))("ngIfElse",t)}}const V=function(t,e,n){return{entries:t,hasMore:e,loadingPage:n}};let Q=(()=>{class t{constructor(t,e,n,s,r,i){this.state=t,this.scrollPosition=e,this.route=n,this.presenceTypesService=s,this.reportsService=r,this.lessonPresencesService=i,this.reportUrl$=this.loadReportUrl(),this.columns=[{key:"StudentFullName",label:"student"},{key:"TotalAbsences",label:"total"},{key:"TotalAbsencesValidExcuse",label:"valid-excuse"},{key:"TotalAbsencesWithoutExcuse",label:"without-excuse"},{key:"TotalAbsencesUnconfirmed",label:"unconfirmed"},{key:"TotalIncidents",label:"incident"}],this.filterFromParams$=this.route.queryParams.pipe(Object(m.a)(W)),this.profileReturnParams$=this.state.queryParamsString$}ngOnInit(){this.filterFromParams$.pipe(Object(v.a)(1)).subscribe(t=>this.state.setFilter(t)),this.presenceTypesService.halfDayActive$.subscribe(t=>{t&&(this.columns=[...this.columns,{key:"TotalHalfDays",label:"halfday"}])})}ngAfterViewInit(){this.scrollPosition.restore()}onScroll(){this.state.nextPage()}getSortingChar$(t){return this.state.sorting$.pipe(Object(m.a)(e=>e&&t.key===e.key?e.ascending?"\u2193":"\u2191":""))}loadReportUrl(){return this.state.validFilter$.pipe(Object(y.a)(t=>this.lessonPresencesService.getLessonRefs(t)),Object(m.a)(t=>t?this.reportsService.getEvaluateAbsencesUrl(this.getReportRecordIds(t)):null))}getReportRecordIds(t){return t.map(t=>`${t.LessonRef.Id}_${t.RegistrationRef.Id}`)}}return t.\u0275fac=function(e){return new(e||t)(b.Mb(f),b.Mb(S.a),b.Mb(r.a),b.Mb(P.a),b.Mb(R.a),b.Mb(c.a))},t.\u0275cmp=b.Gb({type:t,selectors:[["erz-evaluate-absences-list"]],decls:4,vars:11,consts:[[4,"erzLet"],[3,"filter","filterChange"],[4,"ngIf","ngIfElse"],["noFilter",""],["loading",""],["class","p-3",4,"ngIf","ngIfElse"],["noEntries",""],[1,"p-3"],[1,"buttons"],["class","report btn btn-primary mb-2","target","_blank",3,"disabled","href",4,"ngIf"],["infiniteScroll","",1,"table","table-striped","table-fixed",3,"scrolled"],["scope","col",3,"ngClass","click",4,"ngFor","ngForOf"],[4,"ngIf"],["class","inline",4,"ngIf"],["type","button","class","btn btn-secondary btn-sm d-block mx-auto",3,"click",4,"ngIf"],["target","_blank",1,"report","btn","btn-primary","mb-2",3,"href"],[1,"material-icons"],["scope","col",3,"ngClass","click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction"],[4,"ngFor","ngForOf"],["class","student",3,"routerLink","queryParams",4,"ngIf","ngIfElse"],["noLink",""],[1,"student",3,"routerLink","queryParams"],[1,"inline"],["type","button",1,"btn","btn-secondary","btn-sm","d-block","mx-auto",3,"click"],[1,"mt-3","px-3"]],template:function(t,e){1&t&&(b.Bc(0,X,7,7,"ng-container",0),b.gc(1,"async"),b.gc(2,"async"),b.gc(3,"async")),2&t&&b.lc("erzLet",b.rc(7,V,b.hc(1,1,e.state.entries$),b.hc(2,3,e.state.hasMore$),b.hc(3,5,e.state.loadingPage$)))},directives:[C.a,F,d.m,E.a,d.l,d.k,r.i,w.a],pipes:[d.b,k.c],styles:["th[_ngcontent-%COMP%]{cursor:pointer}th.student[_ngcontent-%COMP%]{width:30%}.column-title[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis;white-space:nowrap}a.student[_ngcontent-%COMP%]{color:#33333d}.buttons[_ngcontent-%COMP%]{display:flex;justify-content:flex-end}.buttons[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{line-height:1;font-size:2.2rem}"],changeDetection:0}),t})();function W(t){return{student:t.student?Number(t.student):null,educationalEvent:t.educationalEvent?Number(t.educationalEvent):null,studyClass:t.studyClass?Number(t.studyClass):null}}var Y=n("ccj6"),tt=n("hH5/");const et=[{path:"",component:p,children:[{path:"",component:Q,data:{restoreScrollPositionFrom:["/evaluate-absences/student/:id"]}},{path:"student/:id",children:[{path:"",component:Y.a},{path:"confirm",component:tt.a}]}]}];let nt=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Kb({type:t}),t.\u0275inj=b.Jb({imports:[[r.j.forChild(et)],r.j]}),t})(),st=(()=>{class t{}return t.\u0275fac=function(e){return new(e||t)},t.\u0275mod=b.Kb({type:t}),t.\u0275inj=b.Jb({imports:[[s.a,nt]]}),t})()},yl8S:function(t,e,n){"use strict";n.d(e,"a",function(){return m});var s=n("tyNb"),r=n("XNiG"),i=n("LRne"),c=n("pLZG"),a=n("lJxs"),o=n("IzEk"),l=n("5+tZ"),u=n("eIep"),b=n("Y6wi"),d=n("UXun"),f=n("1G5W"),h=n("zP0r"),g=n("fXoL"),p=n("ofXK");let m=(()=>{class t{constructor(t,e){this.router=t,this.viewportScroller=e,this.scrollPositions={},this.previousRoute=null,this.currentRoute=null,this.currentScrollPosition=[0,0],this.destroy$=new r.a,this.scrollPosition$=this.router.events.pipe(Object(c.a)(y),Object(a.a)(this.getScrollPosition.bind(this))),this.activationEnd$=this.router.events.pipe(Object(c.a)(v)),this.navigationEnd$=this.router.events.pipe(Object(c.a)(S)),this.route$=this.activationEnd$.pipe(Object(o.a)(1)).pipe(Object(l.a)(t=>[Object(i.a)(t),this.navigationEnd$.pipe(Object(u.a)(()=>this.activationEnd$.pipe(Object(o.a)(1))))]),Object(b.a)(),Object(a.a)(t=>t.snapshot),Object(d.a)(1)),this.scrollPosition$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>this.currentScrollPosition=t),this.route$.pipe(Object(f.a)(this.destroy$)).subscribe(t=>{this.previousRoute=this.currentRoute,this.currentRoute=t})}ngOnDestroy(){this.destroy$.next()}restore(){if(!this.currentRoute||!this.requiresStoring(this.currentRoute))return;if(this.previousRoute&&this.shouldStoreFor(this.currentRoute,this.previousRoute)){const t=this.getPath(this.currentRoute);this.scrollToPosition(this.scrollPositions[t]||[0,0])}const t=this.currentRoute;this.route$.pipe(Object(h.a)(1),Object(o.a)(1),Object(f.a)(this.destroy$),Object(c.a)(e=>this.shouldStoreFor(t,e))).subscribe(()=>{const e=this.getPath(t);this.scrollPositions[e]=this.currentScrollPosition})}getScrollPosition(){return this.viewportScroller.getScrollPosition()}scrollToPosition(t){this.viewportScroller.scrollToPosition(t)}getPath(t){return t?"/"+t.pathFromRoot.map(t=>t.routeConfig&&t.routeConfig.path).filter(t=>t).join("/"):"/"}requiresStoring(t){return Boolean(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)&&t.routeConfig.data.restoreScrollPositionFrom.length>0)}shouldStoreFor(t,e){return(t&&t.routeConfig&&t.routeConfig.data&&Array.isArray(t.routeConfig.data.restoreScrollPositionFrom)?t.routeConfig.data.restoreScrollPositionFrom:[]).includes(this.getPath(e))}}return t.\u0275fac=function(e){return new(e||t)(g.Zb(s.g),g.Zb(p.t))},t.\u0275prov=g.Ib({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();function v(t){return t instanceof s.b}function y(t){return t instanceof s.e}function S(t){return t instanceof s.d}}}]);