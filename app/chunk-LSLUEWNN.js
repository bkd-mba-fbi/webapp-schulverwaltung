import{l as U,m as V,n as J,s as K}from"./chunk-CV3DHWJV.js";import{d as Y}from"./chunk-BHASDBIA.js";import{a as N,b as H}from"./chunk-2JKGIYT3.js";import"./chunk-Y4QYVF5K.js";import"./chunk-QGDSASTQ.js";import"./chunk-2QS7YZBA.js";import{a as O}from"./chunk-DQZMQ4YX.js";import{a as z}from"./chunk-DCZMTIC7.js";import"./chunk-AQYFD262.js";import{i as q}from"./chunk-YNODG5RP.js";import"./chunk-SNNR7FJ6.js";import"./chunk-EFJ6WEH7.js";import"./chunk-HVLHLZKP.js";import{b as G,h as M}from"./chunk-DQAQYQ7K.js";import{r as _,z as A}from"./chunk-ZXUJZ6KS.js";import{Ae as b,Cc as n,Dc as a,Gb as D,H as F,Hb as E,Ib as B,Nb as g,Ob as f,Pb as l,Qb as c,Xb as P,_ as L,ba as x,db as p,ic as h,id as I,ja as T,jc as S,l as w,oa as s,ob as m,rc as v,sc as y,tc as C,v as d,w as R,wc as $,xc as j}from"./chunk-GP622B77.js";var u=(()=>{let t=class t{constructor(){this.storageService=s(O),this.loadingService=s(N),this.coursesRestService=s(U),this.subscriptionRestService=s(z),this.reportsService=s(Y),this.gradingScalesRestService=s(V),this.settings=s(A),this.studentId$=new w(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(L(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(d(e=>e.slice().sort((i,ee)=>i.Designation.localeCompare(ee.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(d(e=>e.flatMap(i=>i.Id))),this.subscriptionIds$=R([this.studentId$,this.studentCourseIds$]).pipe(F(([e,i])=>i.length>0),x(([e,i])=>this.subscriptionRestService.getSubscriptionIdsByStudentAndCourse(e,i))),this.testReports$=this.subscriptionIds$.pipe(d(e=>this.reportsService.getStudentSubscriptionGradesReports(e))),this.tests$=this.studentCourses$.pipe(d(e=>e.flatMap(i=>i.Tests).filter(G))),this.gradingScaleIdsFromTests$=this.tests$.pipe(d(e=>[...e.map(i=>i.GradingScaleId)].filter(G).filter(M))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe(d(e=>e.flatMap(i=>i.GradingScaleId).filter(G).filter(M))),this.gradingScaleIds$=R([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe(d(([e,i])=>e.concat(i).filter(M))),this.gradingScales$=this.gradingScaleIds$.pipe(x(e=>this.gradingScalesRestService.getListForIds(e)));let o=this.storageService.getPayload()?.id_person;o&&this.studentId$.next(Number(o))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}};t.\u0275fac=function(e){return new(e||t)},t.\u0275prov=T({token:t,factory:t.\u0275fac});let r=t;return r})();var te=()=>[],Q=(()=>{let t=class t{constructor(){this.myGradesService=s(u)}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m({type:t,selectors:[["bkd-my-grades-header"]],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(e,i){e&1&&(f(0,"div",0)(1,"div"),h(2),n(3,"translate"),l(),f(4,"div"),c(5,"bkd-reports-link",1),n(6,"async"),l()()),e&2&&(p(2),S(a(3,2,"my-grades.header")),p(3),g("reports",a(6,4,i.myGradesService.testReports$)??j(6,te)))},dependencies:[H,I,b],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]});let r=t;return r})();function ie(r,t){r&1&&c(0,"bkd-spinner")}function re(r,t){if(r&1&&c(0,"bkd-dossier-grades-view",1),r&2){P();let Z=C(0),o=C(2),e=C(4);g("courses",Z)("studentId",o)("gradingScales",e)("isEditable",!1)}}var W=(()=>{let t=class t{constructor(){this.myGradesService=s(u)}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m({type:t,selectors:[["bkd-my-grades-show"]],features:[$([J])],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(e,i){e&1&&(v(0),n(1,"async"),v(2),n(3,"async"),v(4),n(5,"async"),f(6,"div",0)(7,"h1"),h(8),n(9,"translate"),l(),c(10,"bkd-my-grades-header"),D(11,ie,1,0,"bkd-spinner"),n(12,"async"),E(13,re,1,4,"bkd-dossier-grades-view",1),l()),e&2&&(y(a(1,2,i.myGradesService.studentCoursesSorted$)),p(2),y(a(3,5,i.myGradesService.studentId$)),p(2),y(a(5,8,i.myGradesService.gradingScales$)),p(4),S(a(9,11,"my-grades.title")),p(3),B(a(12,13,i.myGradesService.loading$)?11:13))},dependencies:[Q,K,q,I,b],encapsulation:2});let r=t;return r})();var X=(()=>{let t=class t{constructor(){}};t.\u0275fac=function(e){return new(e||t)},t.\u0275cmp=m({type:t,selectors:[["bkd-my-grades"]],features:[$([u])],decls:1,vars:0,template:function(e,i){e&1&&c(0,"router-outlet")},dependencies:[_],encapsulation:2});let r=t;return r})();var _e=[{path:"",component:X,children:[{path:"",component:W}]}];export{_e as MY_GRADES_ROUTES};
