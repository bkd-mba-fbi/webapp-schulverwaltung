import{e as ce,f as ue}from"./chunk-I5JSV7AG.js";import{a as pe}from"./chunk-I6B7SZW4.js";import{a as me}from"./chunk-TN3HRY7Y.js";import{g as q,h as $}from"./chunk-2QS7YZBA.js";import{a as se}from"./chunk-56A7FKFV.js";import{b as K}from"./chunk-MGLEQUF6.js";import{d as le}from"./chunk-2N7K67C6.js";import{a as Y,b as V}from"./chunk-YNODG5RP.js";import{b as de}from"./chunk-DQAQYQ7K.js";import{f as Z,h as j,t as re,z as M}from"./chunk-ZXUJZ6KS.js";import{Ae as ae,Cc as h,Cd as f,Dc as y,Dd as z,Ec as R,Gb as p,Ha as W,Ib as d,Id as G,Kc as H,Nb as x,Ob as m,Pb as u,Pc as F,Qb as c,Rd as v,Sd as N,Xb as l,ab as _,ba as J,db as a,gc as te,gd as ne,ic as s,ja as D,jc as L,jd as oe,kc as S,lc as b,oa as C,ob as A,q as B,rb as ee,rc as ie,sc as U,tc as g,v as E,vc as P,w}from"./chunk-GP622B77.js";function Le(e,t){if(e&1&&(s(0),c(1,"br")),e&2){let i=l();S(" ",i.student().AddressLine2)}}function Ae(e,t){if(e&1&&(m(0,"a",0),s(1),u(),c(2,"br")),e&2){let i=l();x("href",P("tel:",i.student().PhonePrivate),_),a(),S(" ",i.student().PhonePrivate," ")}}function Te(e,t){if(e&1&&(m(0,"a",0),s(1),u(),c(2,"br")),e&2){let i=l();x("href",P("tel:",i.student().PhoneMobile),_),a(),S(" ",i.student().PhoneMobile," ")}}function Ee(e,t){if(e&1&&(m(0,"a",0),s(1),u()),e&2){let i=l();x("href",P("mailto:",i.email()),_),a(),S(" ",i.email()," ")}}var it=(()=>{let t=class t{constructor(){this.student=F.required(),this.emailProperty=F("DisplayEmail"),this.postalCode=H(()=>{let n=this.student();return"PostalCode"in n?n.PostalCode:n.Zip}),this.email=H(()=>{let n=this.student();return this.emailProperty()==="Email2"&&"Email2"in n?n.Email2||null:n.DisplayEmail})}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-address"]],inputs:{student:[1,"student"],emailProperty:[1,"emailProperty"]},decls:9,vars:7,consts:[[3,"href"]],template:function(o,r){o&1&&(m(0,"address"),s(1),c(2,"br"),p(3,Le,2,1),s(4),c(5,"br"),p(6,Ae,3,3),p(7,Te,3,3),p(8,Ee,2,3,"a",0),u()),o&2&&(a(),S(" ",r.student().AddressLine1),a(2),d(r.student().AddressLine2?3:-1),a(),b(" ",r.postalCode()||""," ",r.student().Location),a(2),d(r.student().PhonePrivate?6:-1),a(),d(r.student().PhoneMobile?7:-1),a(),d(r.email()?8:-1))},styles:["address[_ngcontent-%COMP%]{padding-left:1rem}"],changeDetection:0});let e=t;return e})();var X=(()=>{let t=class t{transform(n){return n?.DisplayEmail||n?.Email||n?.Email2||null}};t.\u0275fac=function(o){return new(o||t)},t.\u0275pipe=ee({name:"bkdPersonEmail",type:t,pure:!0});let e=t;return e})();function De(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);S(" ",i.CompanyName)}}function Me(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);S(" ",i.CompanyNameAddition)}}function ke(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);b(" ",i.Lastname||""," ",i.Firstname||"")}}function Re(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);S(" ",i.AddressLine1)}}function Fe(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);S(" ",i.AddressLine2)}}function Ne(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(0);b(" ",i.PostalCode," ",i.Location)}}function Oe(e,t){if(e&1&&(m(0,"a",1),s(1),c(2,"br"),u()),e&2){l(2);let i=g(0);x("href",P("tel:",i.PhoneBusiness),_),a(),L(i.PhoneBusiness)}}function Be(e,t){if(e&1&&(m(0,"a",1),h(1,"bkdPersonEmail"),s(2),h(3,"bkdPersonEmail"),u()),e&2){l(2);let i=g(0);x("href",P("mailto:",y(1,3,i)),_),a(2),L(y(3,5,i))}}function we(e,t){if(e&1&&(m(0,"address"),p(1,De,2,1),p(2,Me,2,1),p(3,ke,2,2),p(4,Re,2,1),p(5,Fe,2,1),p(6,Ne,2,2),p(7,Oe,3,3,"a",1),p(8,Be,4,7,"a",1),h(9,"bkdPersonEmail"),u()),e&2){l();let i=g(0);a(),d(i.CompanyName?1:-1),a(),d(i.CompanyNameAddition?2:-1),a(),d(i.Lastname||i.Firstname?3:-1),a(),d(i.AddressLine1?4:-1),a(),d(i.AddressLine2?5:-1),a(),d(i.PostalCode&&i.Location?6:-1),a(),d(i.PhoneBusiness?7:-1),a(),d(y(9,8,i)?8:-1)}}function Ue(e,t){if(e&1&&(m(0,"div",0),s(1),h(2,"translate"),h(3,"addSpace"),c(4,"br"),s(5),h(6,"date"),h(7,"date"),u()),e&2){l();let i=g(1);a(),b(" ",y(2,4,"shared.profile.apprenticeship-period"),"",R(3,6,":",":")),a(4),b(" ",R(6,9,i.ContractDateFrom,"dd.MM.yyyy"),"\u2013",R(7,12,i.ContractDateTo,"dd.MM.yyyy")," ")}}function je(e,t){if(e&1&&(s(0),c(1,"br")),e&2){l(2);let i=g(2);b(" ",i.Lastname||""," ",i.Firstname||"")}}function ze(e,t){if(e&1&&(m(0,"a",1),s(1),c(2,"br"),u()),e&2){l(2);let i=g(2);x("href",P("tel:",i.PhoneBusiness),_),a(),L(i.PhoneBusiness)}}function Ge(e,t){if(e&1&&(m(0,"a",1),s(1),c(2,"br"),u()),e&2){l(2);let i=g(2);x("href",P("tel:",i.PhoneMobile),_),a(),L(i.PhoneMobile)}}function Ye(e,t){if(e&1&&(m(0,"a",1),h(1,"bkdPersonEmail"),s(2),h(3,"bkdPersonEmail"),u()),e&2){l(2);let i=g(2);x("href",P("mailto:",y(1,3,i)),_),a(2),L(y(3,5,i))}}function $e(e,t){if(e&1&&(m(0,"div",0),s(1),h(2,"translate"),h(3,"addSpace"),m(4,"address"),p(5,je,2,2),p(6,ze,3,3,"a",1),p(7,Ge,3,3,"a",1),p(8,Ye,4,7,"a",1),h(9,"bkdPersonEmail"),u()()),e&2){l();let i=g(2);a(),b(" ",y(2,6,"shared.profile.job-trainer"),"",R(3,8,":",":")," "),a(4),d(i.Lastname||i.Firstname?5:-1),a(),d(i.PhoneBusiness?6:-1),a(),d(i.PhoneMobile?7:-1),a(),d(y(9,11,i)?8:-1)}}var mt=(()=>{let t=class t{constructor(){this.apprenticeship=F.required()}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-apprenticeship"]],inputs:{apprenticeship:[1,"apprenticeship"]},decls:6,vars:6,consts:[[1,"subentry"],[3,"href"]],template:function(o,r){if(o&1&&(ie(0)(1)(2),p(3,we,10,10,"address"),p(4,Ue,8,15,"div",0),p(5,$e,10,13,"div",0)),o&2){let I=U(r.apprenticeship().apprenticeshipManager);a();let k=U(r.apprenticeship().apprenticeshipContract);a();let O=U(r.apprenticeship().jobTrainer);a(),d(I?3:-1),a(),d(k.ContractDateFrom?4:-1),a(),d(O?5:-1)}},dependencies:[oe,ae,ue,X],styles:[".subentry[_ngcontent-%COMP%]{padding-bottom:1rem}"],changeDetection:0});let e=t;return e})();function Xe(e,t){if(e&1&&(s(0),c(1,"br")),e&2){let i=l();S(" ",i.person.AddressLine1)}}function Je(e,t){if(e&1&&(s(0),c(1,"br")),e&2){let i=l();S(" ",i.person.AddressLine2)}}function He(e,t){if(e&1&&(s(0),c(1,"br")),e&2){let i=l();b(" ",i.person.Zip," ",i.person.Location)}}function Ze(e,t){if(e&1&&(m(0,"a",0),s(1),c(2,"br"),u()),e&2){let i=l();x("href",P("tel:",i.person.PhonePrivate),_),a(),L(i.person.PhonePrivate)}}function qe(e,t){if(e&1&&(m(0,"a",0),s(1),c(2,"br"),u()),e&2){let i=l();x("href",P("tel:",i.person.PhoneMobile),_),a(),L(i.person.PhoneMobile)}}function Ve(e,t){if(e&1&&(m(0,"a",0),h(1,"bkdPersonEmail"),s(2),h(3,"bkdPersonEmail"),u()),e&2){let i=l();x("href",P("mailto:",y(1,3,i.person)),_),a(2),L(y(3,5,i.person))}}var ht=(()=>{let t=class t{constructor(){}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=A({type:t,selectors:[["bkd-student-dossier-legal-representative"]],inputs:{person:"person"},decls:10,vars:10,consts:[[3,"href"]],template:function(o,r){o&1&&(m(0,"address"),s(1),c(2,"br"),p(3,Xe,2,1),p(4,Je,2,1),p(5,He,2,2),p(6,Ze,3,3,"a",0),p(7,qe,3,3,"a",0),p(8,Ve,4,7,"a",0),h(9,"bkdPersonEmail"),u()),o&2&&(a(),b(" ",r.person.LastName," ",r.person.FirstName),a(2),d(r.person.AddressLine1?3:-1),a(),d(r.person.AddressLine2?4:-1),a(),d(r.person.Zip&&r.person.Zip?5:-1),a(),d(r.person.PhonePrivate?6:-1),a(),d(r.person.PhoneMobile?7:-1),a(),d(y(9,8,r.person)?8:-1))},dependencies:[X],encapsulation:2,changeDetection:0});let e=t;return e})();var fe=G({Email:v(f),Email2:v(f),PhoneBusiness:v(f),CompanyName:N(f),CompanyNameAddition:N(f),Firstname:v(f),Lastname:v(f),AddressLine1:N(f),AddressLine2:N(f),PostalCode:v(f),Location:v(f),Id:z});var he=(()=>{let t=class t extends Y{constructor(){let n=C(j),o=C(M);super(n,o,fe,"ApprenticeshipManagers")}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var Ce=G({Email:v(f),Email2:v(f),PhoneBusiness:v(f),PhoneMobile:v(f),Firstname:v(f),Lastname:v(f),Id:z});var xe=(()=>{let t=class t extends Y{constructor(){let n=C(j),o=C(M);super(n,o,Ce,"JobTrainers")}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();function Q(e,t){let i=+q(e)-+q(t);return i<0?-1:i>0?1:i}function ge(e,t,i){let[n,o]=$(i?.in,e,t);return n.getFullYear()-o.getFullYear()}function ve(e,t,i){let[n,o]=$(i?.in,e,t),r=Q(n,o),I=Math.abs(ge(n,o));n.setFullYear(1584),o.setFullYear(1584);let k=Q(n,o)===-r,O=r*(I-+k);return O===0?0:O}var Qe=18;function _e(e){return ve(new Date,e.Birthdate||new Date)>=Qe}var Se="dossier-myself",Pe="dossier-student",ye="dossier-legal-reps",be="dossier-apprenticeships",Ie="dossier-stay-permit",ai=(()=>{let t=class t{constructor(){this.studentService=C(ce),this.personsService=C(le),this.apprenticeshipManagersService=C(he),this.jobTrainersService=C(xe),this.dropDownItemsService=C(pe),this.loadingService=C(me),this.IGNORE_404_CONTEXT=new Z().set(K,{disableErrorHandlingForStatus:[404]}),this.loadingStudent$=this.loadingService.loading(Pe),this.loadingMyself$=this.loadingService.loading(Se),this.loadingLegalRepresentatives$=this.loadingService.loading(ye),this.loadingApprenticeships$=this.loadingService.loading(be),this.loadingStayPermit$=this.loadingService.loading(Ie)}getStudent(n){return this.loadingService.load(this.personsService.get(n,{context:this.IGNORE_404_CONTEXT}).pipe(E(o=>this.createStudentFromPerson(o)),V()),Pe)}createStudentFromPerson(n){return{Id:n.Id,AddressLine1:n.AddressLine1,AddressLine2:n.AddressLine2,Birthdate:n.Birthdate,DisplayEmail:n.DisplayEmail,FirstName:n.FirstName??"",FullName:n.FullName??"",Gender:n.Gender??"X",LastName:n.LastName??"",Location:n.Location,PhoneMobile:n.PhoneMobile,PhonePrivate:n.PhonePrivate,PostalCode:n.Zip}}getMyself(){return this.loadingService.load(this.personsService.getMyself({context:new Z().set(K,{disableErrorHandlingForStatus:[403]})}),Se)}getLegalRepresentatives(n){return this.loadingService.load(this.loadLegalRepresentatives(n).pipe(J(o=>this.loadLegalRepresentativePersons(o).pipe(E(r=>o.map(I=>this.findPerson(I.RepresentativeId,r)).filter(de))))),ye)}getApprenticeships(n){return this.loadingService.load(this.loadApprenticeshipContracts(n).pipe(J(o=>w([this.loadApprenticeshipManagers(o),this.loadJobTrainers(o)]).pipe(E(([r,I])=>o.map(k=>this.createApprenticeshipCompany(k,r,I)))))),be)}getStayPermitValue(n){return this.loadingService.load(this.dropDownItemsService.getStayPermits().pipe(E(o=>o.find(r=>r.Key===n)?.Value||null)),Ie)}loadLegalRepresentatives(n){return this.studentService.getLegalRepresentatives(n.Id).pipe(E(o=>{let r=_e(n);return o.filter(I=>!r||I.RepresentativeAfterMajority)}))}loadLegalRepresentativePersons(n){return n.length===0?B([]):this.personsService.getListForIds(n.map(o=>o.RepresentativeId))}loadApprenticeshipContracts(n){return this.studentService.getCurrentApprenticeshipContracts(n,{context:this.IGNORE_404_CONTEXT}).pipe(V([]))}loadJobTrainers(n){let o=n.map(r=>r.JobTrainer).filter(r=>typeof r=="number");return o.length===0?B([]):w(o.map(r=>this.jobTrainersService.get(r)))}loadApprenticeshipManagers(n){let o=n.map(r=>r.ApprenticeshipManagerId);return o.length===0?B([]):w(o.map(r=>this.apprenticeshipManagersService.get(r)))}createApprenticeshipCompany(n,o,r){return{apprenticeshipContract:n,jobTrainer:this.findPerson(n.JobTrainer,r),apprenticeshipManager:this.findPerson(n.ApprenticeshipManagerId,o)}}findPerson(n,o){return n&&o.find(r=>r.Id===n)||null}};t.\u0275fac=function(o){return new(o||t)},t.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"});let e=t;return e})();var hi=(()=>{let t=class t{constructor(){this.settings=C(M),this.storageService=C(se),this.avatarStyles={}}ngOnChanges(n){n.studentId&&(this.avatarStyles=this.buildAvatarStyles(this.studentId))}buildAvatarStyles(n){return{"background-image":[this.buildAvatarUrl(n),this.fallbackAvatarUrl].map(o=>`url(${o})`).join(", ")}}buildAvatarUrl(n){let o=this.storageService.getAccessToken()||"";return`${this.settings.apiUrl}/Files/personPictures/${n}?token=${o}`}get fallbackAvatarUrl(){return`${this.settings.scriptsAndAssetsPath}/assets/images/avatar-placeholder.png`}};t.\u0275fac=function(o){return new(o||t)},t.\u0275cmp=A({type:t,selectors:[["bkd-avatar"]],inputs:{studentId:"studentId",link:"link",linkParams:"linkParams"},features:[W],decls:1,vars:5,consts:[[1,"avatar",3,"routerLink","queryParams","ngStyle"]],template:function(o,r){o&1&&c(0,"a",0),o&2&&(te("disabled",!r.link),x("routerLink",r.link)("queryParams",r.linkParams)("ngStyle",r.avatarStyles))},dependencies:[re,ne],styles:["[_nghost-%COMP%]{display:flex}.small[_nghost-%COMP%]{width:40px;min-width:40px;height:50px}.medium[_nghost-%COMP%]{width:58px;min-width:58px;height:75px}.large[_nghost-%COMP%]{width:100px;min-width:100px;height:130px}.avatar[_ngcontent-%COMP%]{flex:1;border:1px solid rgba(0,0,0,.25);background-repeat:no-repeat;background-size:cover;background-position:center}a.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:default}"]});let e=t;return e})();export{ai as a,it as b,mt as c,ht as d,hi as e};
