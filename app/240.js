"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[240],{9240:(K,C,a)=>{a.r(C),a.d(C,{DASHBOARD_ROUTES:()=>ee});var M=a(6407),b=a(177),p=a(3955),v=a(1517),$=a(7887),T=a(2809),y=a(5539),t=a(4438);const S=["*"];function E(e,r){1&e&&t.eu8(0)}function P(e,r){if(1&e&&(t.j41(0,"a",4),t.DNE(1,E,1,0,"ng-container",5),t.k0s()),2&e){const n=t.XpG(),s=t.sdS(3);t.Y8G("routerLink",n.link)("queryParams",n.linkParams),t.R7$(),t.Y8G("ngTemplateOutlet",s)}}function O(e,r){1&e&&t.eu8(0)}function k(e,r){if(1&e&&(t.j41(0,"a",6),t.DNE(1,O,1,0,"ng-container",5),t.k0s()),2&e){const n=t.XpG(),s=t.sdS(3);t.Y8G("href",n.externalLink,t.B4B),t.R7$(),t.Y8G("ngTemplateOutlet",s)}}function i(e,r){if(1&e&&(t.j41(0,"span",9),t.EFF(1),t.k0s()),2&e){const n=t.XpG(2);t.R7$(),t.JRh(n.count)}}function x(e,r){1&e&&(t.qSk(),t.j41(0,"svg",10),t.nrm(1,"path",11),t.k0s())}function F(e,r){if(1&e&&(t.j41(0,"span",7),t.EFF(1),t.nI1(2,"translate"),t.k0s(),t.j41(3,"div"),t.SdG(4),t.DNE(5,i,2,1,"span",8)(6,x,2,0,"ng-template",null,1,t.C5r),t.k0s()),2&e){const n=t.sdS(7),s=t.XpG();t.R7$(),t.JRh(t.bMT(2,3,s.label)),t.R7$(4),t.Y8G("ngIf",s.hasCount(s.count))("ngIfElse",n)}}let A=(()=>{class e{constructor(){}hasCount(n){return"number"==typeof n&&n>=0}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-action"]],inputs:{label:"label",count:"count",link:"link",linkParams:"linkParams",externalLink:"externalLink"},standalone:!0,features:[t.aNF],ngContentSelectors:S,decls:4,vars:2,consts:[["actionContent",""],["icon",""],[3,"routerLink","queryParams",4,"ngIf"],[3,"href",4,"ngIf"],[3,"routerLink","queryParams"],[4,"ngTemplateOutlet"],[3,"href"],[1,"label"],["class","count",4,"ngIf","ngIfElse"],[1,"count"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none"],["fill","currentColor","d","m12 20-1.425-1.4 5.6-5.6H4v-2h12.175l-5.6-5.6L12 4l8 8-8 8Z"]],template:function(s,o){1&s&&(t.NAR(),t.DNE(0,P,2,3,"a",2)(1,k,2,2,"a",3)(2,F,8,5,"ng-template",null,0,t.C5r)),2&s&&(t.Y8G("ngIf",!o.externalLink),t.R7$(),t.Y8G("ngIf",o.externalLink))},dependencies:[b.bT,y.Wk,b.T3,p.h,p.D9],styles:["a[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:space-between;align-items:center;padding:1rem 1.5rem;background:#f7e9d2;text-decoration:none;line-height:1}a[_ngcontent-%COMP%]:hover{background:#f2e0c3}a[_ngcontent-%COMP%]:focus-visible{outline-width:2px;outline-offset:-2px}div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.label[_ngcontent-%COMP%]{font-weight:400}.count[_ngcontent-%COMP%]{font-size:1.5rem}"]})}return e})();var L=a(8676);let j=(()=>{class e{constructor(){}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-deadline"]],inputs:{count:"count"},standalone:!0,features:[t.aNF],decls:3,vars:8,template:function(s,o){1&s&&(t.EFF(0),t.nI1(1,"translate"),t.nI1(2,"addSpace")),2&s&&t.E5c("",t.bMT(1,3,"dashboard.actions.deadline"),"",t.i5U(2,5,": ",":"),"",o.count,"\n")},dependencies:[p.h,p.D9,L.c],styles:["[_nghost-%COMP%]{background:#ea161f;color:#fff;white-space:nowrap;font-weight:500;font-size:.875rem;min-height:1.5rem;display:flex;padding:.375rem .5rem;align-items:center;border-radius:2.5rem}"]})}return e})();var G=a(2771),g=a(5558),d=a(4668),l=a(6354),c=a(7673),f=a(9172),m=a(4572),D=a(9728),R=a(3515),U=a(9067),N=a(2949),J=a(5449),Y=a(5783);const z=Y.NW({Id:Y.ai,Holder:Y.Yj});var H=a(6952),W=a(1626);let w=(()=>{class e extends H.G{constructor(n,s){super(n,s,z,"TeacherSubstitutions")}getTeacherSubstitution(n){return this.getList({params:{"filter.Id":`=${n}`}}).pipe((0,l.T)(s=>s[0]||null))}static#t=this.\u0275fac=function(s){return new(s||e)(t.KVO(W.Qq),t.KVO(T.yy))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac,providedIn:"root"})}return e})();var Q=a(4688),Z=a(4599);const q=["LessonTeacherRole","ClassTeacherRole","TeacherRole","AbsenceAdministratorRole"],tt=["LessonTeacherRole","TeacherRole","StudentRole","SubstituteAdministratorRole"],et=["LessonTeacherRole","StudentRole"];let I=(()=>{class e{constructor(n,s,o,u,_,ne,se,ae){this.settingsService=n,this.lessonPresencesService=s,this.studentsService=o,this.courseService=u,this.teacherSubstitutionService=_,this.personService=ne,this.storageService=se,this.settings=ae,this.rolesAndPermissions$=this.settingsService.getRolesAndPermissions(),this.studentId$=new G.m(1),this.lessonAbsences$=this.studentId$.pipe((0,g.n)(h=>this.studentsService.getLessonAbsences(h)),(0,d.t)(1)),this.lessonIncidents$=this.studentId$.pipe((0,g.n)(h=>this.studentsService.getLessonIncidents(h)),(0,d.t)(1)),this.loading$=this.rolesAndPermissions$.pipe((0,l.T)(h=>null==h)),this.hasSearch$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(q))),this.hasActions$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(tt))),this.hasTimetable$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(et))),this.hasLessonTeacherRole$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(["LessonTeacherRole"])),(0,d.t)(1)),this.hasTeacherRole$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(["TeacherRole"])),(0,d.t)(1)),this.hasStudentRole$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(["StudentRole"])),(0,d.t)(1)),this.hasSubstituteAdministratorRole$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(["SubstituteAdministratorRole"])),(0,d.t)(1)),this.editAbsencesCount$=this.hasLessonTeacherRole$.pipe((0,g.n)(h=>h?this.lessonPresencesService.checkableAbsencesCount():(0,c.of)(!1)),(0,d.t)(1)),this.openAbsencesCount$=this.rolesAndPermissions$.pipe((0,l.T)(this.hasRoles(["LessonTeacherRole","ClassTeacherRole"])),(0,g.n)(h=>h?this.lessonPresencesService.getListOfUnconfirmed():(0,c.of)([])),(0,l.T)(h=>h.length),(0,d.t)(1)),this.myAbsencesCount$=this.hasStudentRole$.pipe((0,g.n)(h=>h?this.getMyAbsences():(0,c.of)([])),(0,l.T)(this.getMyAbsencesCount.bind(this)),(0,d.t)(1)),this.coursesToRateCount$=this.courseService.getNumberOfCoursesForRating().pipe((0,f.Z)(0),(0,d.t)(1)),this.hasPresenceControl$=this.hasLessonTeacherRole$.pipe((0,g.n)(h=>h?this.lessonPresencesService.hasLessonsLessonTeacher():(0,c.of)(!1)),(0,d.t)(1)),this.hasOpenAbsences$=this.openAbsencesCount$.pipe((0,l.T)(h=>h>0),(0,d.t)(1)),this.editAbsencesParams$=this.getFullName().pipe((0,l.T)(h=>({confirmationStates:this.settings.checkableAbsenceStateId,teacher:h})),(0,d.t)(1));const X=this.storageService.getPayload()?.id_person;X&&this.studentId$.next(Number(X))}hasRoles(n){return s=>(s??[]).some(o=>n.includes(o))}getMyAbsences(){return(0,m.z)([this.studentId$,this.lessonAbsences$,this.lessonIncidents$]).pipe((0,g.n)(([n,s,o])=>this.loadTimetableEntries(n,s,o).pipe((0,l.T)(u=>[...s,...o].map(_=>this.withTimetableEntry(_,u)).filter(D.TM)))))}getMyAbsencesCount(n){return n?.filter(s=>("ConfirmationStateId"in s?s.ConfirmationStateId:null)===this.settings.unconfirmedAbsenceStateId).length||0}getFullName(){const n=Number(this.storageService.getPayload()?.substitution_id)||null;return n?this.teacherSubstitutionService.getTeacherSubstitution(n).pipe((0,l.T)(s=>s?.Holder)):this.personService.getMyself().pipe((0,l.T)(s=>s.FullName))}withTimetableEntry(n,s){return s.find(o=>o.Id===n.LessonRef.Id)?n:null}loadTimetableEntries(n,s,o){return this.studentsService.getTimetableEntries(n,{"filter.Id":`;${[...s,...o].map(u=>u.LessonRef.Id).join(";")}`})}static#t=this.\u0275fac=function(s){return new(s||e)(t.KVO(R.A),t.KVO(U.g),t.KVO(N.y),t.KVO(J.I),t.KVO(w),t.KVO(Q.a),t.KVO(Z.n),t.KVO(T.yy))};static#e=this.\u0275prov=t.jDH({token:e,factory:e.\u0275fac})}return e})();const nt=()=>["/presence-control"],st=()=>["/edit-absences"],at=()=>["/open-absences"],ot=()=>["/events"],it=()=>["/my-absences","report"],rt=()=>["/my-absences"];function ct(e,r){1&e&&t.nrm(0,"bkd-dashboard-action",4),2&e&&t.Y8G("label","dashboard.actions.presence-control")("link",t.lJ4(2,nt))}function dt(e,r){if(1&e&&(t.nrm(0,"bkd-dashboard-action",5),t.nI1(1,"async"),t.nI1(2,"async")),2&e){const n=t.XpG();t.Y8G("label","dashboard.actions.edit-absences")("link",t.lJ4(8,st))("linkParams",t.bMT(1,4,n.dashboardService.editAbsencesParams$))("count",t.bMT(2,6,n.dashboardService.editAbsencesCount$))}}function lt(e,r){if(1&e&&(t.nrm(0,"bkd-dashboard-action",6),t.nI1(1,"async")),2&e){const n=t.XpG();t.Y8G("label","dashboard.actions.open-absences")("link",t.lJ4(5,at))("count",t.bMT(1,3,n.dashboardService.openAbsencesCount$))}}function ht(e,r){if(1&e&&(t.nrm(0,"bkd-dashboard-deadline",8),t.nI1(1,"async")),2&e){const n=t.XpG(2);t.Y8G("count",t.bMT(1,1,n.dashboardService.coursesToRateCount$))}}function bt(e,r){if(1&e&&(t.j41(0,"bkd-dashboard-action",4),t.DNE(1,ht,2,3,"bkd-dashboard-deadline",7),t.nI1(2,"async"),t.k0s()),2&e){let n;const s=t.XpG();t.Y8G("label","dashboard.actions.tests")("link",t.lJ4(5,ot)),t.R7$(),t.Y8G("ngIf",null!==(n=t.bMT(2,3,s.dashboardService.coursesToRateCount$))&&void 0!==n&&n)}}function mt(e,r){1&e&&t.nrm(0,"bkd-dashboard-action",4),2&e&&t.Y8G("label","dashboard.actions.my-absences-report")("link",t.lJ4(2,it))}function ut(e,r){if(1&e&&(t.nrm(0,"bkd-dashboard-action",6),t.nI1(1,"async")),2&e){const n=t.XpG();t.Y8G("label","dashboard.actions.my-absences")("link",t.lJ4(5,rt))("count",t.bMT(1,3,n.dashboardService.myAbsencesCount$))}}function pt(e,r){if(1&e&&t.nrm(0,"bkd-dashboard-action",9),2&e){const n=t.XpG();t.Y8G("label","dashboard.actions.substitutions")("externalLink",n.substitutionsAdminLink)}}let gt=(()=>{class e{constructor(n,s){this.dashboardService=n,this.settings=s}get substitutionsAdminLink(){return this.settings.dashboard.substitutionsAdminLink}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(I),t.rXU(T.yy))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-actions"]],standalone:!0,features:[t.aNF],decls:15,vars:23,consts:[[3,"label","link",4,"ngIf"],[3,"label","link","linkParams","count",4,"ngIf"],[3,"label","link","count",4,"ngIf"],[3,"label","externalLink",4,"ngIf"],[3,"label","link"],[3,"label","link","linkParams","count"],[3,"label","link","count"],[3,"count",4,"ngIf"],[3,"count"],[3,"label","externalLink"]],template:function(s,o){1&s&&(t.DNE(0,ct,1,3,"bkd-dashboard-action",0),t.nI1(1,"async"),t.DNE(2,dt,3,9,"bkd-dashboard-action",1),t.nI1(3,"async"),t.nI1(4,"async"),t.DNE(5,lt,2,6,"bkd-dashboard-action",2),t.nI1(6,"async"),t.DNE(7,bt,3,6,"bkd-dashboard-action",0),t.nI1(8,"async"),t.DNE(9,mt,1,3,"bkd-dashboard-action",0),t.nI1(10,"async"),t.DNE(11,ut,2,6,"bkd-dashboard-action",2),t.nI1(12,"async"),t.DNE(13,pt,1,2,"bkd-dashboard-action",3),t.nI1(14,"async")),2&s&&(t.Y8G("ngIf",t.bMT(1,7,o.dashboardService.hasPresenceControl$)),t.R7$(2),t.Y8G("ngIf",t.bMT(3,9,o.dashboardService.hasLessonTeacherRole$)&&t.bMT(4,11,o.dashboardService.editAbsencesParams$)),t.R7$(3),t.Y8G("ngIf",t.bMT(6,13,o.dashboardService.hasOpenAbsences$)),t.R7$(2),t.Y8G("ngIf",t.bMT(8,15,o.dashboardService.hasTeacherRole$)),t.R7$(2),t.Y8G("ngIf",t.bMT(10,17,o.dashboardService.hasStudentRole$)),t.R7$(2),t.Y8G("ngIf",t.bMT(12,19,o.dashboardService.hasStudentRole$)),t.R7$(2),t.Y8G("ngIf",t.bMT(14,21,o.dashboardService.hasSubstituteAdministratorRole$)))},dependencies:[b.bT,A,j,b.Jj],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}"]})}return e})();var ft=a(1861);let _t=(()=>{class e{constructor(n,s){this.studentsRestService=n,this.router=s}navigateToDossier(n){const s=Number(n);this.router.navigate(["dashboard","student",s,"addresses"])}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(N.y),t.rXU(y.Ix))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-search"]],standalone:!0,features:[t.aNF],decls:1,vars:2,consts:[[3,"valueChange","typeaheadService","placeholder"]],template:function(s,o){1&s&&(t.j41(0,"bkd-typeahead",0),t.bIt("valueChange",function(_){return _&&o.navigateToDossier(_)}),t.k0s()),2&s&&t.Y8G("typeaheadService",o.studentsRestService)("placeholder","dashboard.search.placeholder")},dependencies:[ft.V],styles:["[_nghost-%COMP%]{display:block;padding:.75rem;background:#f7e9d2}"]})}return e})();var B=a(3601),Tt=a(7165),yt=a(906),vt=a(4903),V=a(4412),It=a(8141),Ct=a(1037),Mt=a(345);let $t=(()=>{class e{constructor(n){this.sanitizer=n}transform(n,s){switch(s){case"html":return this.sanitizer.bypassSecurityTrustHtml(n);case"style":return this.sanitizer.bypassSecurityTrustStyle(n);case"script":return this.sanitizer.bypassSecurityTrustScript(n);case"url":return this.sanitizer.bypassSecurityTrustUrl(n);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(n);default:throw new Error(`Invalid safe type specified: ${s}`)}}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(Mt.up,16))};static#e=this.\u0275pipe=t.EJ8({name:"safe",type:e,pure:!0,standalone:!0})}return e})();function Et(e,r){1&e&&(t.j41(0,"th"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"dashboard.timetable.table.teacher")," "))}function Dt(e,r){1&e&&(t.j41(0,"th"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"dashboard.timetable.table.room")," "))}function Rt(e,r){if(1&e&&(t.j41(0,"a",12),t.EFF(1),t.j41(2,"span",13),t.EFF(3),t.k0s()()),2&e){const n=t.XpG().$implicit,s=t.XpG(2);t.Y8G("href",s.buildLink(n.eventId),t.B4B),t.R7$(),t.SpI(" ",n.subject,""),t.R7$(2),t.SpI(", ",n.studyClass,"")}}function St(e,r){if(1&e&&t.EFF(0),2&e){const n=t.XpG().$implicit;t.SpI(" ",n.subject," ")}}function Pt(e,r){if(1&e&&(t.j41(0,"td",14),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e){const n=t.XpG().$implicit;t.R7$(),t.Lme(" ",t.bMT(2,2,"dashboard.timetable.table.study-class"),": ",n.studyClass," ")}}function Ot(e,r){if(1&e&&(t.j41(0,"td",15),t.EFF(1),t.k0s()),2&e){const n=t.XpG().$implicit;t.R7$(),t.SpI(" ",n.teacher," ")}}function kt(e,r){1&e&&(t.j41(0,"span",18),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.JRh(t.bMT(2,1,"dashboard.timetable.table.room")))}function xt(e,r){if(1&e&&(t.j41(0,"td",16),t.DNE(1,kt,3,3,"span",17),t.EFF(2),t.k0s()),2&e){const n=t.XpG().$implicit;t.R7$(),t.Y8G("ngIf",n.room),t.R7$(),t.SpI(" ",n.room," ")}}function Ft(e,r){if(1&e&&(t.j41(0,"tr")(1,"td",6),t.EFF(2),t.nI1(3,"date"),t.nI1(4,"date"),t.k0s(),t.j41(5,"td",7),t.DNE(6,Rt,4,3,"a",8),t.nI1(7,"async"),t.DNE(8,St,1,1,"ng-template",null,1,t.C5r),t.k0s(),t.DNE(10,Pt,3,4,"td",9),t.nI1(11,"async"),t.DNE(12,Ot,2,1,"td",10),t.nI1(13,"async"),t.DNE(14,xt,3,2,"td",11),t.nI1(15,"async"),t.k0s()),2&e){const n=r.$implicit,s=t.sdS(9),o=t.XpG(2);t.R7$(2),t.Lme(" ",t.i5U(3,7,n.from,"HH:mm"),"\u2013",t.i5U(4,10,n.until,"HH:mm")," "),t.R7$(4),t.Y8G("ngIf",t.bMT(7,13,o.isTeacher$))("ngIfElse",s),t.R7$(4),t.Y8G("ngIf",t.bMT(11,15,o.isTeacher$)),t.R7$(2),t.Y8G("ngIf",t.bMT(13,17,o.isStudent$)),t.R7$(2),t.Y8G("ngIf",t.bMT(15,19,o.isStudent$))}}function At(e,r){if(1&e&&(t.j41(0,"table",3)(1,"thead")(2,"tr")(3,"th"),t.EFF(4),t.nI1(5,"translate"),t.k0s(),t.j41(6,"th"),t.EFF(7),t.nI1(8,"translate"),t.k0s(),t.DNE(9,Et,3,3,"th",4),t.nI1(10,"async"),t.DNE(11,Dt,3,3,"th",4),t.nI1(12,"async"),t.k0s()(),t.j41(13,"tbody"),t.DNE(14,Ft,16,21,"tr",5),t.k0s()()),2&e){const n=t.XpG();t.R7$(4),t.JRh(t.bMT(5,5,"dashboard.timetable.table.time")),t.R7$(3),t.JRh(t.bMT(8,7,"dashboard.timetable.table.subject")),t.R7$(2),t.Y8G("ngIf",t.bMT(10,9,n.isStudent$)),t.R7$(2),t.Y8G("ngIf",t.bMT(12,11,n.isStudent$)),t.R7$(3),t.Y8G("ngForOf",n.entries)}}function Lt(e,r){1&e&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.JRh(t.bMT(2,1,"dashboard.timetable.no-entries")))}let jt=(()=>{class e{constructor(n,s){this.dashboardService=n,this.settings=s,this.entries=[],this.isStudent$=this.dashboardService.hasStudentRole$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$}buildLink(n){return this.settings.eventlist.eventdetail.replace(":id",String(n))}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(I),t.rXU(T.yy))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-timetable-table"]],inputs:{entries:"entries"},standalone:!0,features:[t.aNF],decls:3,vars:2,consts:[["noEntries",""],["noLink",""],["class","table",4,"ngIf","ngIfElse"],[1,"table"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"time"],[1,"subject"],["target","_parent",3,"href",4,"ngIf","ngIfElse"],["class","study-class",4,"ngIf"],["class","teacher",4,"ngIf"],["class","room",4,"ngIf"],["target","_parent",3,"href"],[1,"subject-study-class"],[1,"study-class"],[1,"teacher"],[1,"room"],["class","room-label",4,"ngIf"],[1,"room-label"]],template:function(s,o){if(1&s&&t.DNE(0,At,15,13,"table",2)(1,Lt,3,3,"ng-template",null,0,t.C5r),2&s){const u=t.sdS(2);t.Y8G("ngIf",o.entries.length>0)("ngIfElse",u)}},dependencies:[b.bT,b.pM,b.Jj,b.vh,p.h,p.D9],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:1rem 1.75rem}.room-label[_ngcontent-%COMP%], td.study-class[_ngcontent-%COMP%]{display:none}@media (max-width: 767.98px){table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{border-top:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:"time room" "subject subject" "study-class study-class" "teacher teacher";gap:.5rem;padding:1rem;border-bottom:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:0;padding:0}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time[_ngcontent-%COMP%]{grid-area:time;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.subject[_ngcontent-%COMP%]{grid-area:subject;font-size:1rem;line-height:1.25rem;font-weight:400}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.teacher[_ngcontent-%COMP%]{grid-area:teacher;font-size:.8125rem;line-height:1.0625rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.room[_ngcontent-%COMP%]{grid-area:room;text-align:right;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.study-class[_ngcontent-%COMP%]{grid-area:study-class;font-size:.8125rem;line-height:1.0625rem;font-weight:300}td.study-class[_ngcontent-%COMP%]{display:block}.subject-study-class[_ngcontent-%COMP%]{display:none}.room-label[_ngcontent-%COMP%]{display:inline}}']})}return e})();function Gt(e,r){1&e&&(t.j41(0,"a",9),t.nI1(1,"safe"),t.EFF(2),t.nI1(3,"translate"),t.k0s()),2&e&&(t.Y8G("href",t.i5U(1,2,r.ngIf,"url"),t.B4B),t.R7$(2),t.SpI(" ",t.bMT(3,5,"dashboard.timetable.subscribe-calendar")," "))}function Nt(e,r){1&e&&(t.j41(0,"a",13),t.nI1(1,"safe"),t.EFF(2),t.nI1(3,"translate"),t.k0s()),2&e&&(t.Y8G("href",t.i5U(1,2,r.ngIf,"url"),t.B4B),t.R7$(2),t.SpI(" ",t.bMT(3,5,"dashboard.timetable.subscribe-calendar")," "))}function Yt(e,r){if(1&e&&(t.qex(0),t.nrm(1,"bkd-dashboard-timetable-table",11),t.DNE(2,Nt,4,7,"a",12),t.nI1(3,"async"),t.bVm()),2&e){const n=t.XpG().bkdLet,s=t.XpG();t.R7$(),t.Y8G("entries",n),t.R7$(),t.Y8G("ngIf",t.bMT(3,2,s.getSubscribeCalendarUrl()))}}function Ut(e,r){if(1&e&&(t.qex(0),t.DNE(1,Yt,4,4,"ng-container",10),t.nI1(2,"async"),t.bVm()),2&e){const n=t.XpG(),s=t.sdS(21);t.R7$(),t.Y8G("ngIf",!1===t.bMT(2,2,n.loading$))("ngIfElse",s)}}function Bt(e,r){1&e&&t.nrm(0,"bkd-spinner")}let Xt=(()=>{class e{constructor(n,s,o,u){this.studentsService=n,this.lessonPresencesService=s,this.userSettings=o,this.dashboardService=u,this.studentId$=this.dashboardService.studentId$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$,this.isStudent$=this.dashboardService.hasStudentRole$,this.date$=new V.t((0,B.o)(new Date)),this.loading$=new V.t(!0),this.timetableEntries$=this.loadTimetableEntries()}gotoToday(){this.loading$.next(!0),this.date$.next((0,B.o)(new Date))}gotoPreviousDay(){this.loading$.next(!0),this.date$.next((0,Tt.e)(this.date$.getValue(),1))}gotoNextDay(){this.loading$.next(!0),this.date$.next((0,yt.f)(this.date$.getValue(),1))}getSubscribeCalendarUrl(){return this.userSettings.getSetting("cal")}loadTimetableEntries(){return(0,m.z)([this.isTeacher$,this.isStudent$]).pipe((0,g.n)(([n,s])=>n?this.loadTeacherTimetableEntries():s?this.loadStudentTimetableEntries():(0,c.of)([])),(0,It.M)(()=>this.loading$.next(!1)))}loadTeacherTimetableEntries(){return this.date$.pipe((0,g.n)(n=>this.lessonPresencesService.getLessonsByDate(n)),(0,l.T)(Ct.t1),(0,l.T)(n=>n.map(this.convertLesson.bind(this))))}loadStudentTimetableEntries(){return(0,m.z)([this.studentId$,this.date$]).pipe((0,g.n)(([n,s])=>this.studentsService.getTimetableEntries(n,{"filter.From":`=${(0,vt.GP)(s,"yyyy-MM-dd")}`,sort:"From,To"})),(0,l.T)(n=>n.map(this.convertTimetableEntry.bind(this))))}convertLesson(n){return{id:n.LessonRef.Id,from:n.LessonDateTimeFrom,until:n.LessonDateTimeTo,eventId:n.EventRef.Id,subject:n.EventDesignation,studyClass:n.StudyClassNumber}}convertTimetableEntry(n){return{id:n.Id,from:n.From,until:n.To,eventId:n.EventId,subject:n.EventDesignation,room:n.EventLocation||void 0,teacher:n.EventManagerInformation||void 0}}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(N.y),t.rXU(U.g),t.rXU(R.A),t.rXU(I))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-timetable"]],standalone:!0,features:[t.aNF],decls:22,vars:21,consts:[["loading",""],[1,"header"],["type","button",1,"btn","btn-primary","today",3,"click"],["type","button",1,"btn","btn-secondary","previous-day",3,"click"],[1,"material-icons"],["type","button",1,"btn","btn-secondary","next-day",3,"click"],[1,"date"],["target","_parent","class","btn btn-secondary subscribe-calendar-header",3,"href",4,"ngIf"],[4,"bkdLet"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-header",3,"href"],[4,"ngIf","ngIfElse"],[3,"entries"],["target","_parent","class","btn btn-secondary subscribe-calendar-bottom",3,"href",4,"ngIf"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-bottom",3,"href"]],template:function(s,o){if(1&s){const u=t.RV6();t.j41(0,"div",1)(1,"button",2),t.bIt("click",function(){return t.eBV(u),t.Njj(o.gotoToday())}),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.j41(4,"button",3),t.nI1(5,"translate"),t.bIt("click",function(){return t.eBV(u),t.Njj(o.gotoPreviousDay())}),t.j41(6,"span",4),t.EFF(7,"chevron_left"),t.k0s()(),t.j41(8,"button",5),t.nI1(9,"translate"),t.bIt("click",function(){return t.eBV(u),t.Njj(o.gotoNextDay())}),t.j41(10,"span",4),t.EFF(11,"chevron_right"),t.k0s()(),t.j41(12,"div",6),t.EFF(13),t.nI1(14,"async"),t.nI1(15,"date"),t.k0s(),t.DNE(16,Gt,4,7,"a",7),t.nI1(17,"async"),t.k0s(),t.DNE(18,Ut,3,4,"ng-container",8),t.nI1(19,"async"),t.DNE(20,Bt,1,0,"ng-template",null,0,t.C5r)}2&s&&(t.R7$(2),t.SpI(" ",t.bMT(3,6,"dashboard.timetable.today")," "),t.R7$(2),t.BMQ("aria-label",t.bMT(5,8,"dashboard.timetable.previousDay")),t.R7$(4),t.BMQ("aria-label",t.bMT(9,10,"dashboard.timetable.nextDay")),t.R7$(5),t.JRh(t.i5U(15,14,t.bMT(14,12,o.date$),"E, dd. MMMM yyyy")),t.R7$(3),t.Y8G("ngIf",t.bMT(17,17,o.getSubscribeCalendarUrl())),t.R7$(2),t.Y8G("bkdLet",t.bMT(19,19,o.timetableEntries$)))},dependencies:[b.bT,$.N,jt,v.t,b.Jj,b.vh,p.h,p.D9,$t],styles:["[_nghost-%COMP%]{display:block;margin-bottom:1rem}.header[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:2rem;display:flex;align-items:center;gap:1rem}.previous-day[_ngcontent-%COMP%], .next-day[_ngcontent-%COMP%]{padding-left:.375rem;padding-right:.375rem}.date[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.subscribe-calendar-header[_ngcontent-%COMP%]{margin-left:auto}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:none}a.btn[_ngcontent-%COMP%]{text-decoration:none}@media (max-width: 767.98px){.subscribe-calendar-header[_ngcontent-%COMP%]{display:none}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:block;margin-top:2rem}}@media (max-width: 767.98px) and (max-width: 575.98px){.header[_ngcontent-%COMP%]{flex-wrap:wrap-reverse}.header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{width:100%}}"]})}return e})();const Kt=(e,r,n,s)=>({loading:e,hasSearch:r,hasActions:n,hasTimetable:s});function Jt(e,r){1&e&&t.nrm(0,"bkd-spinner")}function zt(e,r){1&e&&(t.j41(0,"p"),t.EFF(1),t.nI1(2,"translate"),t.k0s()),2&e&&(t.R7$(),t.SpI(" ",t.bMT(2,1,"dashboard.no-access")," "))}function Ht(e,r){1&e&&(t.j41(0,"div")(1,"h2"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.nrm(4,"bkd-dashboard-search"),t.k0s()),2&e&&(t.R7$(2),t.JRh(t.bMT(3,1,"dashboard.search.title")))}function Wt(e,r){1&e&&(t.j41(0,"div")(1,"h2"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.nrm(4,"bkd-dashboard-actions"),t.k0s()),2&e&&(t.R7$(2),t.JRh(t.bMT(3,1,"dashboard.actions.title")))}function wt(e,r){if(1&e&&(t.j41(0,"div",5),t.DNE(1,Ht,5,3,"div",1)(2,Wt,5,3,"div",1),t.k0s()),2&e){const n=t.XpG().bkdLet;t.R7$(),t.Y8G("ngIf",n.hasSearch),t.R7$(),t.Y8G("ngIf",n.hasActions)}}function Qt(e,r){1&e&&(t.j41(0,"div",6)(1,"h2"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.nrm(4,"bkd-dashboard-timetable"),t.k0s()),2&e&&(t.R7$(2),t.JRh(t.bMT(3,1,"dashboard.timetable.title")))}function Zt(e,r){if(1&e&&(t.j41(0,"div")(1,"h1"),t.EFF(2),t.nI1(3,"translate"),t.k0s(),t.DNE(4,Jt,1,0,"bkd-spinner",1)(5,zt,3,3,"p",1),t.j41(6,"div",2),t.DNE(7,wt,3,2,"div",3)(8,Qt,5,3,"div",4),t.k0s()()),2&e){const n=r.bkdLet;t.R7$(),t.AVh("visually-hidden",n.loading||n.hasSearch||n.hasActions||n.hasTimetable),t.R7$(),t.SpI(" ",t.bMT(3,7,"dashboard.heading")," "),t.R7$(2),t.Y8G("ngIf",n.loading),t.R7$(),t.Y8G("ngIf",!(n.loading||n.hasSearch||n.hasActions||n.hasTimetable)),t.R7$(2),t.Y8G("ngIf",n.hasSearch||n.hasActions),t.R7$(),t.Y8G("ngIf",n.hasTimetable)}}let qt=(()=>{class e{constructor(n){this.dashboardService=n}static#t=this.\u0275fac=function(s){return new(s||e)(t.rXU(I))};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard-layout"]],standalone:!0,features:[t.aNF],decls:5,vars:14,consts:[[4,"bkdLet"],[4,"ngIf"],[1,"columns"],["class","search-actions-column",4,"ngIf"],["class","timetable-column",4,"ngIf"],[1,"search-actions-column"],[1,"timetable-column"]],template:function(s,o){1&s&&(t.DNE(0,Zt,9,9,"div",0),t.nI1(1,"async"),t.nI1(2,"async"),t.nI1(3,"async"),t.nI1(4,"async")),2&s&&t.Y8G("bkdLet",t.ziG(9,Kt,t.bMT(1,1,o.dashboardService.loading$),t.bMT(2,3,o.dashboardService.hasSearch$),t.bMT(3,5,o.dashboardService.hasActions$),t.bMT(4,7,o.dashboardService.hasTimetable$)))},dependencies:[$.N,b.bT,v.t,_t,gt,Xt,b.Jj,p.h,p.D9],styles:[".columns[_ngcontent-%COMP%]{display:flex;flex-direction:column}.columns[_ngcontent-%COMP%], .search-actions-column[_ngcontent-%COMP%]{gap:3rem}.search-actions-column[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;max-width:40rem}.timetable-column[_ngcontent-%COMP%]{flex:2}@media (min-width: 992px){.columns[_ngcontent-%COMP%]{flex-direction:row;gap:1.5rem}.search-actions-column[_ngcontent-%COMP%]{max-width:33%}}"],changeDetection:0})}return e})();var te=a(9366);const ee=[{path:"",component:(()=>{class e{constructor(){}static#t=this.\u0275fac=function(s){return new(s||e)};static#e=this.\u0275cmp=t.VBU({type:e,selectors:[["bkd-dashboard"]],standalone:!0,features:[t.Jv_([I,te.s]),t.aNF],decls:1,vars:0,template:function(s,o){1&s&&t.nrm(0,"router-outlet")},dependencies:[y.n3],changeDetection:0})}return e})(),children:[{path:"",component:qt},M.R]}]},1861:(K,C,a)=>{a.d(C,{V:()=>j});var M=a(177),b=a(9417),p=a(1324),v=a(3955),$=a(1195),T=a(4412),y=a(6354),t=a(3294),S=a(5558),E=a(980),P=a(152),O=a(5964),k=a(9728),i=a(4438);function x(d,l){if(1&d){const c=i.RV6();i.j41(0,"button",6),i.bIt("click",function(m){i.eBV(c);const D=i.XpG();return i.Njj(D.modelChange(m))}),i.j41(1,"i",2),i.EFF(2,"clear"),i.k0s()()}}function F(d,l){1&d&&(i.j41(0,"div",7)(1,"div",8)(2,"span",9),i.EFF(3,"Loading..."),i.k0s()()())}let j=(()=>{class d{constructor(){this.selectedItem$=new T.t(null),this.placeholder="shared.typeahead.default-placeholder",this.valueChange=this.selectedItem$.pipe((0,y.T)(c=>c?c.Key:null),(0,t.F)()),this.componentId=(0,$.A)("bkd-typeahead-"),this.loading$=new T.t(!1),this.search=c=>c.pipe(function G(d,l){return c=>c.pipe((0,P.B)(l),(0,y.T)(g),(0,t.F)(),(0,O.p)((0,k.NT)(d)))}(3,300),(0,S.n)(this.fetchItems.bind(this)))}ngOnChanges(c){c.value&&c.value.currentValue&&c.value.currentValue!==this.selectedItemKey&&this.fetchItem(c.value.currentValue).subscribe(f=>{this.modelChange(f)})}format(c){return c.Value}modelChange(c){this.selectedItem$.next(c instanceof Object?c:null)}get selectedItemKey(){return this.selectedItem$.value?this.selectedItem$.value.Key:null}fetchItems(c){return this.loading$.next(!0),this.typeaheadService.getTypeaheadItems(c,this.additionalHttpParams).pipe((0,E.j)(()=>this.loading$.next(!1)))}fetchItem(c){return this.loading$.next(!0),this.typeaheadService.getTypeaheadItemByKey(c).pipe((0,E.j)(()=>this.loading$.next(!1)))}static#t=this.\u0275fac=function(f){return new(f||d)};static#e=this.\u0275cmp=i.VBU({type:d,selectors:[["bkd-typeahead"]],inputs:{typeaheadService:"typeaheadService",placeholder:"placeholder",value:"value",additionalHttpParams:"additionalHttpParams"},outputs:{valueChange:"valueChange"},standalone:!0,features:[i.OA$,i.aNF],decls:11,vars:18,consts:[[1,"input-group"],[1,"input-group-text",3,"id"],[1,"material-icons"],["type","text",1,"form-control",3,"ngModelChange","ngbTypeahead","inputFormatter","resultFormatter","ngModel"],["class","btn btn-link text-decoration-none","type","button",3,"click",4,"ngIf"],["class","spinner-container",4,"ngIf"],["type","button",1,"btn","btn-link","text-decoration-none",3,"click"],[1,"spinner-container"],["role","status",1,"spinner-border","spinner-border-sm"],[1,"visually-hidden"]],template:function(f,m){1&f&&(i.j41(0,"div",0)(1,"span",1)(2,"i",2),i.EFF(3,"search"),i.k0s()(),i.j41(4,"input",3),i.nI1(5,"async"),i.nI1(6,"translate"),i.nI1(7,"translate"),i.bIt("ngModelChange",function(R){return m.modelChange(R)}),i.k0s(),i.DNE(8,x,3,0,"button",4),i.k0s(),i.DNE(9,F,4,0,"div",5),i.nI1(10,"async")),2&f&&(i.R7$(),i.Y8G("id",m.componentId),i.R7$(3),i.Y8G("ngbTypeahead",m.search)("inputFormatter",m.format)("resultFormatter",m.format)("ngModel",i.bMT(5,10,m.selectedItem$)),i.BMQ("placeholder",i.bMT(6,12,m.placeholder))("aria-label",i.bMT(7,14,m.placeholder))("aria-describedby",m.componentId),i.R7$(4),i.Y8G("ngIf",m.value),i.R7$(),i.Y8G("ngIf",i.bMT(10,16,m.loading$)))},dependencies:[p.$n,b.YN,b.me,b.BC,b.vS,M.bT,M.Jj,v.h,v.D9],styles:["[_nghost-%COMP%]{display:block;position:relative;background:#fff}.spinner-container[_ngcontent-%COMP%]{position:absolute;top:0;bottom:0;right:.75rem;display:flex;align-items:center;z-index:1001}.spinner-border[_ngcontent-%COMP%]{color:#6c757d}input[_ngcontent-%COMP%]{padding-right:2.5em}.input-group[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{position:absolute;right:0;z-index:5}"],changeDetection:0})}return d})();function g(d){return d.trim().toLowerCase()}}}]);