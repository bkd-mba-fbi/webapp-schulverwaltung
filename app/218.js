"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[218],{6218:(_t,E,o)=>{o.r(E),o.d(E,{EventsModule:()=>Mn});var k=o(8393),N=o(6486),m=o(1523),J=o(9592),t=o(5879),q=o(5301),C=o(5619),A=o(7081),v=o(2572),c=o(7398),_=o(4664),x=o(4141),y=o(1389),mt=o(6031),ht=o(2547);function H(n){const{HasEvaluationStarted:a,EvaluationUntil:e,HasTestGrading:s}=n.EvaluationStatusRef;if(!0===a&&(14030===n.StatusId||10350===n.StatusId))return{value:T.Rating};if(!0===a&&!1===s){if(e)return{value:T.RatingUntil};if(10300===n.StatusId)return{value:T.IntermediateRating}}return!1===a&&!0===s&&10260!==n.StatusId&&10250!==n.StatusId?{value:T.Tests}:!0===a&&!0===s?e?{value:T.Tests,label:T.RatingUntil}:{value:T.Tests,label:T.IntermediateRating}:null}function bt(n){return!0===n.EvaluationStatusRef.HasEvaluationStarted}var w=o(1074),At=o(9018),K=o(3005),B=o(8173),g=o(9515),X=o(654),T=function(n){return n.Rating="rating",n.RatingUntil="rating-until",n.IntermediateRating="intermediate-rating",n.Tests="add-tests",n}(T||{});let z=(()=>{class n{constructor(e,s,i,r,l,d,h){this.coursesRestService=e,this.studyClassRestService=s,this.loadingService=i,this.storage=r,this.translate=l,this.eventsRestService=d,this.settings=h,this.loading$=this.loadingService.loading$,this.search$=new C.X(""),this.roles$=new C.X(void 0),this.formativeAssessments$=this.studyClassRestService.getActiveFormativeAssessments(),this.studyClasses$=this.studyClassRestService.getActive(),this.events$=this.loadEvents().pipe((0,A.d)(1)),this.filteredEvents$=(0,v.a)([this.events$,this.search$]).pipe((0,c.U)((0,y.h)(ht.P)))}getEvents(e=!1){return this.filteredEvents$.pipe((0,c.U)(s=>e?s.filter(i=>i.evaluationText):s))}loadEvents(){return this.roles$.pipe((0,_.w)(e=>this.loadingService.load(this.loadEventsForRoles(e))))}loadEventsForRoles(e){return(0,mt.n)(e,"ClassTeacherRole")?(0,v.a)([this.loadCoursesNotRated(e),this.formativeAssessments$,this.studyClasses$]).pipe((0,c.U)((0,y.h)(this.createAndSortEvents.bind(this)))):this.loadCoursesNotRated(e).pipe((0,c.U)(s=>this.createAndSortEvents(s)))}loadCoursesNotRated(e){return this.coursesRestService.getExpandedCourses(e).pipe((0,c.U)(s=>s.filter(i=>!function Zt(n){return!0===n.EvaluationStatusRef.HasReviewOfEvaluationStarted&&!!n.FinalGrades?.length}(i))))}createAndSortEvents(e,s=[],i=[]){const r=i.filter(l=>!s.map(d=>d.Id).includes(l.Id));return[...this.createFromCourses(e),...this.createFromAssessments(s),...this.createFromStudyClasses(r)].sort((l,d)=>l.Designation.localeCompare(d.Designation))}createFromStudyClasses(e){return e.map(s=>({id:s.Id,Designation:s.Number,detailLink:this.buildLink(s.Id,"eventdetail"),studentCount:s.StudentCount,state:null}))}createFromAssessments(e){return this.createFromStudyClasses(e).map(i=>({...i,state:T.Rating,evaluationText:this.translate.instant("events.state.rating"),evaluationLink:this.buildLink(i.id,"evaluation")}))}createFromCourses(e){return e.map(s=>{const i=H(s);return{id:s.Id,Designation:this.eventsRestService.getDesignation(s),detailLink:this.buildLink(s.Id,"eventdetail"),studentCount:s.AttendanceRef.StudentCount||0,dateFrom:s.DateFrom,dateTo:s.DateTo,state:i?.value||null,evaluationText:this.getEvaluationText(i,s.EvaluationStatusRef.EvaluationUntil),evaluationLink:this.getEvaluationLink(i?.value,s)}})}getEvaluationText(e,s){const i=e?.label||e?.value;return i?this.translate.instant(`events.state.${i}`)+(i===T.RatingUntil?` ${s?(0,q.Z)(s,"dd.MM.yyyy"):""}`:""):""}getEvaluationLink(e,s){return e&&e!==T.Tests?this.buildLink(s.Id,"evaluation"):null}buildLink(e,s){return(this.settings.eventlist[s]??"").replace(":id",String(e))}static#t=this.\u0275fac=function(s){return new(s||n)(t.LFG(w.s),t.LFG(At.R),t.LFG(K.b),t.LFG(B.V),t.LFG(g.sK),t.LFG(X.O),t.LFG(x.L6))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var u=o(6814),I=o(6567),yt=o(7163),R=o(59);function It(n,a){1&n&&(t.TgZ(0,"div",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.hij(" ",t.lcZ(2,1,"events.rating")," "))}function Ot(n,a){if(1&n&&(t.TgZ(0,"span"),t._uU(1),t.ALo(2,"date"),t._UZ(3,"wbr"),t._uU(4),t.ALo(5,"date"),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij("",t.xi3(2,2,e.dateFrom,"dd.MM.yyyy"),"\u2013"),t.xp6(3),t.Oqu(t.xi3(5,5,e.dateTo,"dd.MM.yyyy"))}}const Gt=function(n){return[n,"tests"]};function $t(n,a){if(1&n&&(t.TgZ(0,"a",19)(1,"i",20),t._uU(2,"arrow_right_alt"),t.qZA(),t.TgZ(3,"span",21),t._uU(4),t.qZA()()),2&n){const e=t.oxw(2).$implicit;t.Q6J("routerLink",t.VKq(2,Gt,e.id)),t.xp6(4),t.Oqu(e.evaluationText)}}function Pt(n,a){if(1&n&&(t.TgZ(0,"a",22)(1,"i",20),t._uU(2,"arrow_right_alt"),t.qZA(),t.TgZ(3,"span",21),t._uU(4),t.qZA()()),2&n){const e=t.oxw(2).$implicit;t.Q6J("href",e.evaluationLink,t.LSH),t.xp6(4),t.hij("",e.evaluationText," ")}}function Lt(n,a){if(1&n&&(t.TgZ(0,"div",12),t.YNc(1,$t,5,4,"a",17),t.YNc(2,Pt,5,2,"a",18),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.Q6J("ngIf",!e.evaluationLink),t.xp6(1),t.Q6J("ngIf",e.evaluationLink)}}function Mt(n,a){if(1&n&&(t.TgZ(0,"div",13)(1,"div",7)(2,"a",14),t._uU(3),t.qZA()(),t.TgZ(4,"div",8),t.YNc(5,Ot,6,8,"span",15),t.qZA(),t.TgZ(6,"div",9),t._uU(7),t.TgZ(8,"span",16),t._uU(9),t.ALo(10,"translate"),t.qZA()(),t.YNc(11,Lt,3,2,"div",10),t.qZA()),2&n){const e=a.$implicit,s=t.oxw(4);t.xp6(2),t.Q6J("href",e.detailLink,t.LSH),t.xp6(1),t.Oqu(e.Designation),t.xp6(2),t.Q6J("ngIf",e.dateFrom&&e.dateTo),t.xp6(2),t.hij(" ",e.studentCount," "),t.xp6(2),t.Oqu(t.lcZ(10,6,1===e.studentCount?"events.registration":"events.registrations")),t.xp6(2),t.Q6J("ngIf",s.withRatings&&e.evaluationText)}}function St(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",6)(2,"div",7),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"div",8),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"div",9),t._uU(9),t.ALo(10,"translate"),t.qZA(),t.YNc(11,It,3,3,"div",10),t.qZA(),t.YNc(12,Mt,12,8,"div",11),t.BQk()),2&n){const e=t.oxw(2).erzLet,s=t.oxw();t.xp6(3),t.Oqu(t.lcZ(4,5,"events.designation")),t.xp6(3),t.Oqu(t.lcZ(7,7,"events.date")),t.xp6(3),t.hij(" ",t.lcZ(10,9,"events.registrations")," "),t.xp6(2),t.Q6J("ngIf",s.withRatings),t.xp6(1),t.Q6J("ngForOf",e.events)}}function Et(n,a){1&n&&(t.TgZ(0,"p",23),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"events.no-events")))}function wt(n,a){if(1&n&&(t.ynx(0),t.YNc(1,St,13,11,"ng-container",3),t.YNc(2,Et,3,3,"ng-template",null,5,t.W1O),t.BQk()),2&n){const e=t.MAs(3),s=t.oxw().erzLet;t.xp6(1),t.Q6J("ngIf",(null==s.events?null:s.events.length)>0)("ngIfElse",e)}}function Ft(n,a){1&n&&t._UZ(0,"erz-spinner")}function Ut(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",1)(1,"erz-resettable-input",2),t.NdJ("valueChange",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.state.search$.next(i))}),t.ALo(2,"async"),t.ALo(3,"translate"),t.ALo(4,"translate"),t.qZA(),t.YNc(5,wt,4,2,"ng-container",3),t.ALo(6,"async"),t.YNc(7,Ft,1,0,"ng-template",null,4,t.W1O),t.qZA()}if(2&n){const e=a.erzLet,s=t.MAs(8),i=t.oxw();t.xp6(1),t.Q6J("value",t.lcZ(2,6,i.state.search$))("placeholder",t.lcZ(3,8,"events.search-by"))("label",t.lcZ(4,10,"events.search"))("disabled",!e.events),t.xp6(4),t.Q6J("ngIf",!1===t.lcZ(6,12,i.state.loading$))("ngIfElse",s)}}const kt=function(n){return{events:n}};let V=(()=>{class n{constructor(e,s){this.state=e,this.storage=s,this.withRatings=!0,this.state.roles$.next(this.storage.getPayload()?.roles)}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(z),t.Y36(B.V))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events-list"]],inputs:{withRatings:"withRatings"},decls:2,vars:5,consts:[["class","erz-container",4,"erzLet"],[1,"erz-container"],[1,"d-flex","search",3,"value","placeholder","label","disabled","valueChange"],[4,"ngIf","ngIfElse"],["loading",""],["noEvents",""],[1,"event-header"],[1,"designation"],[1,"date"],[1,"registrations"],["class","rating",4,"ngIf"],["class","event-entry",4,"ngFor","ngForOf"],[1,"rating"],[1,"event-entry"],[3,"href"],[4,"ngIf"],[1,"registrations-label"],["class","d-flex",3,"routerLink",4,"ngIf"],["class","d-flex",3,"href",4,"ngIf"],[1,"d-flex",3,"routerLink"],[1,"material-icons"],[1,"ps-1"],[1,"d-flex",3,"href"],[1,"mt-3"]],template:function(s,i){1&s&&(t.YNc(0,Ut,9,14,"div",0),t.ALo(1,"async")),2&s&&t.Q6J("erzLet",t.VKq(3,kt,t.lcZ(1,1,i.state.getEvents(i.withRatings))))},dependencies:[u.sg,u.O5,m.rH,I.e,yt.w,R.O,u.Ov,u.uU,g.X$],styles:['.search[_ngcontent-%COMP%]{max-width:500px}.event-header[_ngcontent-%COMP%]{display:grid;padding:1rem;border-bottom:2px solid #dee2e6;grid-template-areas:"designation date registrations rating";grid-template-columns:4fr 2fr 2fr 3fr}.event-entry[_ngcontent-%COMP%]{display:grid;padding:1rem;border-bottom:1px solid #dee2e6;grid-template-areas:"designation date registrations rating";grid-template-columns:4fr 2fr 2fr 3fr}.designation[_ngcontent-%COMP%]{grid-area:designation;padding-right:1rem}.date[_ngcontent-%COMP%]{grid-area:date;padding-right:1rem}.registrations[_ngcontent-%COMP%]{grid-area:registrations;padding-right:1rem}.rating[_ngcontent-%COMP%]{grid-area:rating}.rating[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.rating[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.rating[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{text-decoration-color:#ea161f}.registrations-label[_ngcontent-%COMP%]{display:none}@media (max-width: 575.98px){.event-header[_ngcontent-%COMP%]{display:none}.registrations-label[_ngcontent-%COMP%]{display:inline}.designation[_ngcontent-%COMP%], .date[_ngcontent-%COMP%], .registrations[_ngcontent-%COMP%]{padding-right:0}.event-entry[_ngcontent-%COMP%]{grid-template-areas:"designation" "date" "registrations" "rating";grid-template-columns:1fr}}']})}return n})(),Nt=(()=>{class n{constructor(){}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events-current"]],decls:4,vars:4,consts:[[3,"withRatings"]],template:function(s,i){1&s&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t._UZ(3,"erz-events-list",0)),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,2,"events.current.title")),t.xp6(2),t.Q6J("withRatings",!1))},dependencies:[V,g.X$]})}return n})(),Jt=(()=>{class n{constructor(){}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events-tests"]],decls:4,vars:4,consts:[[3,"withRatings"]],template:function(s,i){1&s&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t._UZ(3,"erz-events-list",0)),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,2,"events.title")),t.xp6(2),t.Q6J("withRatings",!0))},dependencies:[V,g.X$]})}return n})(),qt=(()=>{class n{constructor(){}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-events"]],features:[t._Bn([z])],decls:1,vars:0,template:function(s,i){1&s&&t._UZ(0,"router-outlet")},dependencies:[m.lC]})}return n})();var O=o(3997),W=o(4716),tt=o(6869),p=o(6223),G=o(253),zt=o(902),$=o(8645),Z=o(2096),F=o(9773),Rt=o(3296),P=o(1257);function Qt(n){return a=>{const e=Number(a.value);return e<=n?{greaterThan:{value:e,greaterThanValue:n}}:null}}var jt=o(2194),et=o(7328),nt=o(3019),Yt=o(6699),st=o(2181),L=o(8180),it=o(3986);function at(n){return n.map(({finalGrade:a})=>a).filter(Dt)}function Dt(n){return null!==n}function Kt(n,a){return a.map(e=>{if(void 0===e.Results||0===e.Results?.length)return{kind:"no-result",test:e};const s=e.Results?.find(i=>i.StudentId===n.Id);return void 0!==s?{kind:"grade",result:s,test:e}:{kind:"no-result",test:e}})}function Bt(n,a,e){const s=a.find(r=>r.StudentId===n.Id),i=e.find(r=>r.StudentId===n.Id);return s?{id:s.Id,average:Xt(s),finalGradeId:s.GradeId,freeHandGrade:i?Number(i.Grade):null,canGrade:s.CanGrade}:null}function Xt(n){return 0===n.AverageTestResult?null:n.AverageTestResult}function rt(n,a){return n===a?0:n<a?-1:1}function ot(n){return"grade"===n.kind}var se=o(3942);function dt(n,a){return[...a.filter(e=>e.Id!==n?.Id),n].filter(e=>null!=e)}function ie({id:n,selectedGradeId:a},e){return e.map(s=>s.Id!==n?s:{...s,GradeId:a})}var b=o(7483);function ae(n,a){switch(a.type){case"reset":return a.payload;case"updateResult":return n?{...n,Tests:(0,b.De)(a.payload.testResult,n.Tests||[]),Gradings:dt(a.payload.grading,n.Gradings||[])}:null;case"deleteResult":return n?{...n,Tests:(0,b.MV)(a.payload.testId,`${a.payload.testId}_${a.payload.grading.Id}`,n.Tests||[]),Gradings:dt(a.payload.grading,n.Gradings||[])}:null;case"toggle-test-state":return n?{...n,Tests:(0,b.P2)(a.payload,n.Tests||[])}:null;case"final-grade-overwritten":return n?{...n,Gradings:ie({id:a.payload.id,selectedGradeId:a.payload.selectedGradeId},n.Gradings||[])}:null;case"replace-grades":return n?{...n,Gradings:a.payload}:null;case"delete-test":return n?{...n,Tests:(0,b.yY)(a.payload,n.Tests||[])}:null;default:return n}}var re=o(1760),oe=o(7379),de=o(8366),le=o(9862);let ce=(()=>{class n extends de.v{constructor(e,s){super(e,s,oe.Ly,"Gradings")}updateGrade(e,s){return this.http.put(`${this.baseUrl}/${e}`,{GradeId:s}).pipe((0,c.U)(()=>e))}static#t=this.\u0275fac=function(s){return new(s||n)(t.LFG(le.eN),t.LFG(x.L6))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var ue=o(1608);let M=(()=>{class n{constructor(e,s,i,r,l){this.coursesRestService=e,this.gradingScalesRestService=s,this.gradingsRestService=i,this.loadingService=r,this.sortService=l,this.action$=new et.t(1),this.loading$=this.loadingService.loading$,this._courseId$=new et.t(1),this.courseId$=this._courseId$.asObservable(),this.fetchedCourse$=this._courseId$.pipe((0,_.w)(d=>this.loadingService.load(this.coursesRestService.getExpandedCourse(d))),(0,A.d)(1)),this.course$=(0,nt.T)(this.action$,this.fetchedCourse$).pipe((0,c.U)(d=>"type"in d?d:{type:"reset",payload:d}),(0,Yt.R)(ae,null),(0,st.h)(se.Nf)),this.tests$=this.course$.pipe((0,c.U)(d=>d.Tests||[]),(0,c.U)(b.df)),this.hasTests$=this.tests$.pipe((0,c.U)(d=>d.length>0)),this.filter$=new C.X("all-tests"),this.expandedHeader$=new C.X(!1),this.filteredTests$=(0,v.a)([this.tests$,this.filter$]).pipe((0,c.U)(([d,h])=>d.filter(f=>"all-tests"===h||f.IsOwner))),this.sorting$=this.sortService.sorting$,this.studentGrades$=(0,v.a)([this.course$,this.filteredTests$,this.sorting$]).pipe((0,c.U)((0,y.h)(this.toStudentGrades.bind(this)))),this.canSetFinalGrade$=this.course$.pipe((0,c.U)(bt)),this.gradingScaleIds$=this.course$.pipe((0,c.U)(d=>(0,jt.Z)([...(d.Tests??[]).map(h=>h.GradingScaleId),d.GradingScaleId]))),this.gradingScales$=this.gradingScalesRestService.loadGradingScales(this.gradingScaleIds$),this.UNDEFINED_GRADINGSCALE_ID=-1,this.gradingScalesOptions$=this.gradingScales$.pipe((0,c.U)(d=>d.map(h=>({id:h?.Id||this.UNDEFINED_GRADINGSCALE_ID,options:h?.Grades.map(U=>({Key:U.Id,Value:U.Designation}))||[]})).reduce((h,f)=>({...h,[f.id]:f.options}),{})),(0,A.d)(1)),this.meanOfStudentGradesForCourse$=this.studentGrades$.pipe((0,c.U)(d=>function ee(n){const a=n.map(e=>e.average).filter(e=>null!=e&&0!==e).map(Number);return(0,it.Y)(a)}(at(d)))),this.meanOfFinalGradesForCourse$=(0,v.a)([this.gradingScalesOptions$,this.studentGrades$]).pipe((0,_.w)((0,y.h)(this.meanOfOverwrittenGradesForCourse.bind(this))))}setCourseId(e){this._courseId$.next(e)}gradingOptionsForTest$(e){return this.gradingOptions$(e.GradingScaleId)}gradingOptionsForCourse$(){return this.course$.pipe((0,_.w)(e=>this.gradingOptions$(e.GradingScaleId)))}toStudentGrades(e,s=[],i){return function Ht(n,a,e,s){return n?.map(i=>({student:i,finalGrade:Bt(i,e,s),grades:Kt(i,a)}))}(e.ParticipatingStudents??[],s,e.Gradings??[],e.FinalGrades??[]).sort((({key:n,ascending:a})=>(e,s)=>{const i=a?1:-1;switch(n){case"FullName":return i*e.student.FullName.localeCompare(s.student.FullName);case"FinalGrade":return e.finalGrade?.finalGradeId&&s.finalGrade?.finalGradeId?i*rt(e.finalGrade.finalGradeId,s.finalGrade.finalGradeId):-1*i;case"TestsMean":return e.finalGrade?.average&&s.finalGrade?.average?i*rt(e.finalGrade.average,s.finalGrade.average):-1*i}return i*((n,a,e)=>{const s=a.grades.filter(ot).find(r=>r.test.Id===n.Id),i=e.grades.filter(ot).find(r=>r.test.Id===n.Id);return n.IsPointGrading&&s?.result.GradeId===i?.result.GradeId?(s?.result.Points??0)-(i?.result.Points??0):-1*((s?.result.GradeId??Number.POSITIVE_INFINITY)-(i?.result.GradeId??Number.POSITIVE_INFINITY))})(n,e,s)})(i))}setSorting(e){this.sortService.setSorting(e)}getSortingChar$(e){return this.sortService.getSortingChar$(e)}sortBy(e){this.sortService.toggleSorting(e)}toggleHeader(e){this.expandedHeader$.next(e)}saveGrade(e){this.course$.pipe((0,L.q)(1),(0,_.w)(s=>this.coursesRestService.updateTestResult(s.Id,e))).subscribe(s=>this.updateStudentGrades(s,e.TestId))}publish(e){this.coursesRestService.publishTest(e.Id).subscribe(this.toggleTestPublishedState.bind(this))}unpublish(e){this.coursesRestService.unpublishTest(e.Id).subscribe(this.toggleTestPublishedState.bind(this))}deleteTest(e){this.action$.next({type:"delete-test",payload:e})}overwriteFinalGrade({id:e,selectedGradeId:s}){this.gradingsRestService.updateGrade(e,s).subscribe(()=>{this.action$.next({type:"final-grade-overwritten",payload:{id:e,selectedGradeId:s}})})}setAveragesAsFinalGrades(e){this.coursesRestService.setAverageAsFinalGrade(e).subscribe(s=>this.action$.next({type:"replace-grades",payload:s.Gradings}))}updateStudentGrades(e,s){const i=e.body.Gradings.find(d=>d.EventId===e.courseId);void 0!==i&&this.action$.next(0===e.body.TestResults.length?{type:"deleteResult",payload:{testId:s,grading:i}}:{type:"updateResult",payload:{testResult:e.body.TestResults[0],grading:i}})}toggleTestPublishedState(e){this.action$.next({type:"toggle-test-state",payload:e})}gradingOptions$(e){return null===e?(0,Z.of)(null):this.gradingScalesOptions$.pipe((0,c.U)(s=>s[e]),(0,A.d)(1))}meanOfOverwrittenGradesForCourse(e,s){return this.course$.pipe((0,c.U)(i=>{if(null===i.GradingScaleId||void 0===e[i.GradingScaleId])return null;const r=e[i.GradingScaleId];return function ne(n,a){const e=n.map(i=>i.freeHandGrade).filter(i=>!!i),s=n.map(i=>i.finalGradeId).filter(i=>null!==i).map(i=>a.find(r=>r.Key===i)).filter(i=>void 0!==i).map(i=>i?.Value).filter(i=>void 0!==i).map(Number).filter(i=>!isNaN(i));return(0,it.Y)([...s,...e])}(at(s),r)}))}static#t=this.\u0275fac=function(s){return new(s||n)(t.LFG(w.s),t.LFG(re.R),t.LFG(ce),t.LFG(K.b),t.LFG(ue.K))};static#e=this.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac})}return n})();function pe(n,a){if(1&n&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function ge(n,a){if(1&n&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function _e(n,a){if(1&n&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function me(n,a){if(1&n&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function he(n,a){if(1&n&&(t.TgZ(0,"div",31),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=a.$implicit;t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors."+e.error,e.params)," ")}}function fe(n,a){if(1&n&&(t.ynx(0),t.TgZ(1,"div",32)(2,"div",33)(3,"div",17)(4,"label",34),t._uU(5),t.ALo(6,"translate"),t.qZA(),t.TgZ(7,"div",35),t._UZ(8,"input",36),t.ALo(9,"async"),t.YNc(10,me,3,4,"div",7),t.ALo(11,"async"),t.qZA()()(),t.TgZ(12,"div",33)(13,"div",17)(14,"label",37),t._uU(15),t.ALo(16,"translate"),t.qZA(),t.TgZ(17,"div",35),t._UZ(18,"input",38),t.ALo(19,"async"),t.YNc(20,he,3,4,"div",7),t.ALo(21,"async"),t.qZA()()()(),t.TgZ(22,"div",39),t.pZz(),t.TgZ(23,"math")(24,"mi"),t._uU(25),t.ALo(26,"translate"),t.qZA(),t.TgZ(27,"mo"),t._uU(28,"="),t.qZA(),t.TgZ(29,"mfrac")(30,"mrow")(31,"mi"),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"mo"),t._uU(35,"\xd7"),t.qZA(),t.TgZ(36,"mn"),t._uU(37,"5"),t.qZA()(),t.TgZ(38,"mi"),t._uU(39),t.ALo(40,"translate"),t.qZA()(),t.TgZ(41,"mo"),t._uU(42,"+"),t.qZA(),t.TgZ(43,"mn"),t._uU(44,"1"),t.qZA()()(),t.BQk()),2&n){const e=t.oxw(3);let s,i;t.xp6(5),t.Oqu(t.lcZ(6,11,"tests.form.max-points")),t.xp6(3),t.ekj("is-invalid",(null==(s=t.lcZ(9,13,e.maxPointsErrors$))?null:s.length)>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(11,15,e.maxPointsErrors$)),t.xp6(5),t.Oqu(t.lcZ(16,17,"tests.form.max-points-adjusted")),t.xp6(3),t.ekj("is-invalid",(null==(i=t.lcZ(19,19,e.maxPointsAdjustedErrors$))?null:i.length)>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(21,21,e.maxPointsAdjustedErrors$)),t.xp6(5),t.hij(" ",t.lcZ(26,23,"tests.form.math.grade")," "),t.xp6(7),t.hij(" ",t.lcZ(33,25,"tests.form.math.points")," "),t.xp6(7),t.Oqu(t.lcZ(40,27,"tests.form.math.max-points"))}}function ve(n,a){1&n&&(t.TgZ(0,"div",40)(1,"span",41),t._uU(2,"Loading..."),t.qZA()())}const xe=function(n){return["/events",n,"tests"]};function Te(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.onSubmit())}),t.TgZ(1,"div",3)(2,"div",4)(3,"label",5),t._uU(4),t.ALo(5,"translate"),t.qZA(),t._UZ(6,"input",6),t.ALo(7,"async"),t.ALo(8,"translate"),t.YNc(9,pe,3,4,"div",7),t.ALo(10,"async"),t.qZA(),t.TgZ(11,"div",8)(12,"label",9),t._uU(13),t.ALo(14,"translate"),t.qZA(),t.TgZ(15,"div",10)(16,"span",11)(17,"i",12),t._uU(18,"calendar_today"),t.qZA()(),t.TgZ(19,"input",13,14),t.NdJ("click",function(){t.CHM(e);const i=t.MAs(20);return t.KtG(i.toggle())}),t.ALo(21,"async"),t.ALo(22,"translate"),t.qZA(),t.YNc(23,ge,3,4,"div",7),t.ALo(24,"async"),t.qZA()()(),t.TgZ(25,"div",15)(26,"label",16),t._uU(27),t.ALo(28,"translate"),t.qZA(),t.TgZ(29,"div",4)(30,"div",17)(31,"label",18),t._uU(32),t.ALo(33,"translate"),t.qZA(),t.TgZ(34,"div",19),t._UZ(35,"input",20),t.ALo(36,"async"),t.YNc(37,_e,3,4,"div",7),t.ALo(38,"async"),t.qZA()()()(),t.TgZ(39,"div")(40,"label",16),t._uU(41),t.ALo(42,"translate"),t.qZA(),t.TgZ(43,"div",21),t._UZ(44,"input",22),t.TgZ(45,"label",23),t._uU(46),t.ALo(47,"translate"),t.qZA()(),t.TgZ(48,"div",21),t._UZ(49,"input",24),t.TgZ(50,"label",25),t._uU(51),t.ALo(52,"translate"),t.qZA()(),t.YNc(53,fe,45,29,"ng-container",26),t.qZA(),t.TgZ(54,"div",27)(55,"button",28),t.ALo(56,"async"),t._uU(57),t.ALo(58,"translate"),t.qZA(),t.TgZ(59,"button",29),t._uU(60),t.ALo(61,"translate"),t.YNc(62,ve,3,0,"div",30),t.qZA()()()}if(2&n){const e=t.oxw().erzLet,s=t.oxw();let i,r,l;t.Q6J("formGroup",e.formGroup),t.xp6(4),t.Oqu(t.lcZ(5,29,"tests.form.designation")),t.xp6(2),t.ekj("is-invalid",(null==(i=t.lcZ(7,31,s.designationErrors$))?null:i.length)>0),t.Q6J("placeholder",t.lcZ(8,33,"tests.form.designation-placeholder")),t.xp6(3),t.Q6J("ngForOf",t.lcZ(10,35,s.designationErrors$)),t.xp6(4),t.Oqu(t.lcZ(14,37,"tests.form.date")),t.xp6(3),t.Q6J("id",s.componentId),t.xp6(3),t.ekj("is-invalid",(null==(r=t.lcZ(21,39,s.dateErrors$))?null:r.length)>0),t.Q6J("placeholder",t.lcZ(22,41,"shared.date-select.default-placeholder")),t.xp6(4),t.Q6J("ngForOf",t.lcZ(24,43,s.dateErrors$)),t.xp6(4),t.Oqu(t.lcZ(28,45,"tests.form.weight")),t.xp6(5),t.Oqu(t.lcZ(33,47,"tests.form.factor")),t.xp6(3),t.ekj("is-invalid",(null==(l=t.lcZ(36,49,s.weightErrors$))?null:l.length)>0),t.xp6(2),t.Q6J("ngForOf",t.lcZ(38,51,s.weightErrors$)),t.xp6(4),t.Oqu(t.lcZ(42,53,"tests.form.grading-type")),t.xp6(3),t.Q6J("value",!1),t.xp6(2),t.Oqu(t.lcZ(47,55,"tests.form.grades")),t.xp6(3),t.Q6J("value",!0),t.xp6(2),t.Oqu(t.lcZ(52,57,"tests.form.points")),t.xp6(2),t.Q6J("ngIf",e.formGroup.get("isPointGrading").value),t.xp6(2),t.Q6J("disabled",s.saving)("routerLink",t.VKq(65,xe,t.lcZ(56,59,s.courseId$))),t.xp6(2),t.hij(" ",t.lcZ(58,61,"tests.form.cancel")," "),t.xp6(2),t.Q6J("disabled",s.saving),t.xp6(1),t.hij(" ",t.lcZ(61,63,"tests.form.save")," "),t.xp6(2),t.Q6J("ngIf",s.saving)}}function Ce(n,a){if(1&n&&(t.ynx(0),t.YNc(1,Te,63,67,"form",1),t.BQk()),2&n){const e=a.erzLet;t.xp6(1),t.Q6J("ngIf",e.formGroup)}}const be=function(n){return{formGroup:n}};let lt=(()=>{class n{constructor(e,s,i){this.fb=e,this.translate=s,this.testStateService=i,this.test=null,this.saving=!1,this.save=new t.vpe,this.componentId=(0,zt.Z)("erz-tests-edit-form"),this.formGroup=this.createFormGroup(),this.submitted$=new C.X(!1),this.destroy$=new $.x,this.designationErrors$=(0,P.Z6)((0,Z.of)(this.formGroup),this.submitted$,"designation"),this.dateErrors$=(0,P.Z6)((0,Z.of)(this.formGroup),this.submitted$,"date"),this.maxPointsErrors$=(0,P.Z6)((0,Z.of)(this.formGroup),this.submitted$,"maxPoints"),this.maxPointsAdjustedErrors$=(0,P.Z6)((0,Z.of)(this.formGroup),this.submitted$,"maxPointsAdjusted"),this.weightErrors$=(0,P.Z6)((0,Z.of)(this.formGroup),this.submitted$,"weight"),this.courseId$=this.testStateService.courseId$}ngOnInit(){this.test&&this.setInitialValues(this.test),(0,P.ZX)((0,Z.of)(this.formGroup),"isPointGrading").pipe((0,F.R)(this.destroy$)).subscribe(this.togglePointFieldsDisability.bind(this))}ngOnDestroy(){this.destroy$.next()}onSubmit(){this.submitted$.next(!0),this.formGroup.valid&&this.save.emit(this.formGroup.value)}createFormGroup(){return this.fb.group({designation:["",p.kI.required],date:[null,p.kI.required],weight:[1,p.kI.compose([p.kI.required,Qt(0)])],isPointGrading:[!1],maxPoints:[{value:null,disabled:!0},p.kI.required],maxPointsAdjusted:[{value:null,disabled:!0},null]})}setInitialValues(e){this.formGroup.patchValue({designation:e.Designation,date:e.Date,weight:e.Weight,isPointGrading:e.IsPointGrading,maxPoints:e.MaxPoints,maxPointsAdjusted:e.MaxPointsAdjusted}),e.Results&&e.Results.length>0&&(this.formGroup.get("isPointGrading")?.disable(),this.formGroup.get("maxPoints")?.disable(),this.formGroup.get("maxPointsAdjusted")?.disable()),this.togglePointFieldsDisability()}togglePointFieldsDisability(){const e=this.formGroup.get("maxPoints"),s=this.formGroup.get("maxPointsAdjusted");this.formGroup.get("isPointGrading")?.value?(e?.enable(),s?.enable()):(e?.reset({value:this.test?.MaxPoints,disabled:!0}),s?.reset({value:this.test?.MaxPointsAdjusted,disabled:!0}))}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(p.QS),t.Y36(g.sK),t.Y36(M))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-edit-form"]],inputs:{test:"test",saving:"saving"},outputs:{save:"save"},features:[t._Bn([{provide:G.DO,useClass:G.s5},{provide:G.NG,useClass:Rt.n}])],decls:1,vars:3,consts:[[4,"erzLet"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"row","g-3","mb-3"],[1,"col-md-6"],["for","designation",1,"form-label"],["id","designation","name","designation","type","text","formControlName","designation","required","",1,"form-control",3,"placeholder"],["class","invalid-feedback",4,"ngFor","ngForOf"],[1,"col-md-6","mb-3"],["for","date",1,"form-label"],[1,"input-group"],[1,"input-group-text",3,"id"],[1,"material-icons"],["id","date","name","date","type","text","ngbDatepicker","","formControlName","date","required","",1,"form-control",3,"placeholder","click"],["dp","ngbDatepicker"],[1,"row","mb-3"],[1,"form-label"],[1,"row"],["for","factor",1,"form-label","col-3","col-sm-2"],[1,"col-9","col-sm-10"],["id","factor","name","factor","type","number","formControlName","weight","step","0.05","min","0","required","",1,"form-control"],[1,"form-check"],["type","radio","formControlName","isPointGrading","id","type-grades",1,"form-check-input",3,"value"],["for","type-grades",1,"form-check-label"],["type","radio","formControlName","isPointGrading","id","type-points",1,"form-check-input",3,"value"],["for","type-points",1,"form-check-label"],[4,"ngIf"],[1,"d-flex","justify-content-end","mt-4"],["type","button",1,"btn","btn-outline-secondary",3,"disabled","routerLink"],["type","submit",1,"btn","btn-primary","ms-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],[1,"invalid-feedback"],[1,"row","ms-4","mb-3","g-3"],[1,"col-sm-6","col-md-4"],["for","max-points",1,"ms-2","col-4","col-form-label"],[1,"col-6"],["type","number","name","maxPoints","id","max-points","formControlName","maxPoints","step","0.01","min","0","max","999","required","",1,"form-control"],["for","max-points-adjusted",1,"ms-2","col-4","col-form-label"],["type","number","name","maxPointsAdjusted","id","max-points-adjusted","formControlName","maxPointsAdjusted","step","0.01","min","0","max","999",1,"form-control"],[1,"ms-4","ps-3","py-3"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"visually-hidden"]],template:function(s,i){1&s&&t.YNc(0,Ce,2,1,"ng-container",0),2&s&&t.Q6J("erzLet",t.VKq(1,be,i.formGroup))},dependencies:[u.sg,u.O5,p._Y,p.Fj,p.wV,p._,p.JJ,p.JL,p.Q7,p.qQ,p.Fd,G.J4,p.sg,p.u,m.rH,I.e,u.Ov,g.X$],styles:["#factor[_ngcontent-%COMP%], #max-points[_ngcontent-%COMP%], #max-points-adjusted[_ngcontent-%COMP%]{width:5em}"]})}return n})();function Ze(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",1)(1,"erz-tests-edit-form",2),t.NdJ("save",function(i){t.CHM(e);const r=t.oxw();return t.KtG(r.save(i))}),t.qZA()()}if(2&n){const e=a.erzLet;t.xp6(1),t.Q6J("saving",e.saving)}}const Ae=function(n,a){return{courseId:n,saving:a}};let ye=(()=>{class n{constructor(e,s,i,r,l){this.route=e,this.courseService=s,this.toastService=i,this.translate=r,this.router=l,this.saving$=new C.X(!1),this.courseId$=this.route.paramMap.pipe((0,c.U)(d=>Number(d.get("id"))),(0,O.x)())}save(e){this.saving$.next(!0);const{designation:s,date:i,weight:r,isPointGrading:l,maxPoints:d,maxPointsAdjusted:h}=e;this.courseId$.pipe((0,_.w)(f=>this.courseService.add(f,i,s,r,l,d,h)),(0,W.x)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastService.success(this.translate.instant("tests.form.save-success")),this.navigateBack()}navigateBack(){this.courseId$.subscribe(e=>this.router.navigate(["events",e,"tests"]))}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(m.gz),t.Y36(w.s),t.Y36(tt.k),t.Y36(g.sK),t.Y36(m.F0))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-add"]],decls:6,vars:11,consts:[["class","erz-container erz-container-limited",4,"erzLet"],[1,"erz-container","erz-container-limited"],[3,"saving","save"]],template:function(s,i){1&s&&(t.TgZ(0,"h1"),t._uU(1),t.ALo(2,"translate"),t.qZA(),t.YNc(3,Ze,2,1,"div",0),t.ALo(4,"async"),t.ALo(5,"async")),2&s&&(t.xp6(1),t.Oqu(t.lcZ(2,2,"tests.add-title")),t.xp6(2),t.Q6J("erzLet",t.WLB(8,Ae,t.lcZ(4,4,i.courseId$),t.lcZ(5,6,i.saving$))))},dependencies:[I.e,lt,u.Ov,g.X$]})}return n})(),Ie=(()=>{class n{constructor(e){this.activeModal=e}get canDeleteTest(){return 0===(this.test?.Results?.filter(s=>null!==s.GradeId||null!==s.GradeValue||null!==s.Points)||[]).length}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(G.Kz))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-delete"]],inputs:{test:"test"},decls:13,vars:10,consts:[[1,"modal-body"],["data-testid","confirmation-message"],[1,"modal-footer"],["data-testid","cancel-button","type","button",1,"btn","btn-outline-secondary",3,"hidden","click"],[1,"px-2"],["data-testid","confirm-button","type","button",1,"btn","btn-primary",3,"click"],[1,"px-3"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"div",2)(5,"button",3),t.NdJ("click",function(){return i.activeModal.dismiss()}),t.TgZ(6,"span",4),t._uU(7),t.ALo(8,"translate"),t.qZA()(),t.TgZ(9,"button",5),t.NdJ("click",function(){return i.activeModal.close(i.canDeleteTest?i.test:null)}),t.TgZ(10,"span",6),t._uU(11),t.ALo(12,"translate"),t.qZA()()()),2&s&&(t.xp6(2),t.hij(" ",t.lcZ(3,4,i.canDeleteTest?"tests.form.confirm":"tests.form.delete-not-allowed")," "),t.xp6(3),t.Q6J("hidden",!i.canDeleteTest),t.xp6(2),t.hij(" ",t.lcZ(8,6,"tests.dialog.no")," "),t.xp6(4),t.hij(" ",t.lcZ(12,8,i.canDeleteTest?"tests.dialog.yes":"tests.dialog.ok")," "))},dependencies:[g.X$]})}return n})();var ct=o(1376);const Oe=function(n){return{test:n}};function Ge(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",4)(2,"h1"),t._uU(3),t.ALo(4,"translate"),t.qZA(),t.TgZ(5,"button",5),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().erzLet,r=t.oxw();return t.KtG(r.openDeleteModal(i.test))}),t.TgZ(6,"i",6),t._uU(7,"delete"),t.qZA()()(),t.TgZ(8,"erz-tests-edit-form",7),t.NdJ("save",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.save(i))}),t.qZA(),t.BQk()}if(2&n){const e=t.oxw().erzLet;t.xp6(3),t.hij(" ",t.xi3(4,3,"tests.edit-title",t.VKq(6,Oe,e.test.Designation))," "),t.xp6(5),t.Q6J("test",e.test)("saving",e.saving)}}function $e(n,a){1&n&&t._UZ(0,"erz-spinner")}function Pe(n,a){if(1&n&&(t.TgZ(0,"div",1),t.YNc(1,Ge,9,8,"ng-container",2),t.ALo(2,"async"),t.YNc(3,$e,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&n){const e=t.MAs(4),s=t.oxw();t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(2,2,s.state.loading$))("ngIfElse",e)}}const Le=function(n,a,e){return{courseId:n,test:a,saving:e}};let Me=(()=>{class n{constructor(e,s,i,r,l,d,h){this.state=e,this.courseService=s,this.route=i,this.toastService=r,this.translate=l,this.router=d,this.modalService=h,this.saving$=new C.X(!1),this.testId$=this.route.paramMap.pipe((0,c.U)(f=>Number(f.get("testId"))),(0,O.x)()),this.test$=(0,v.a)([this.state.tests$,this.testId$]).pipe((0,c.U)(([f,S])=>f.find(U=>U.Id===S)))}openDeleteModal(e){const s=this.modalService.open(Ie);s.componentInstance.test=e,s.result.then(i=>{i&&this.courseService.delete(e.CourseId,e.Id).subscribe(this.onDeleteSuccess.bind(this))},()=>{})}save(e){this.saving$.next(!0);const{designation:s,date:i,weight:r,isPointGrading:l,maxPoints:d,maxPointsAdjusted:h}=e;(0,v.a)([this.state.courseId$,this.testId$]).pipe((0,L.q)(1),(0,_.w)(([f,S])=>this.courseService.update(f,S,s,i,r,l,d,h)),(0,W.x)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastService.success(this.translate.instant("tests.form.save-success")),this.navigateBack()}onDeleteSuccess(e){this.toastService.success(this.translate.instant("tests.form.delete-success")),this.state.deleteTest(e),this.navigateBack()}navigateBack(){this.state.courseId$.pipe((0,L.q)(1)).subscribe(e=>this.router.navigate(["events",e,"tests"]))}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(M),t.Y36(w.s),t.Y36(m.gz),t.Y36(tt.k),t.Y36(g.sK),t.Y36(m.F0),t.Y36(ct.p))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-edit"]],decls:4,vars:11,consts:[["class","erz-container erz-container-limited",4,"erzLet"],[1,"erz-container","erz-container-limited"],[4,"ngIf","ngIfElse"],["loading",""],[1,"d-flex","justify-content-between","align-items-center"],["type","button",1,"btn","btn-primary","btn-icon",3,"click"],[1,"material-icons"],[3,"test","saving","save"]],template:function(s,i){1&s&&(t.YNc(0,Pe,5,4,"div",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async")),2&s&&t.Q6J("erzLet",t.kEZ(7,Le,t.lcZ(1,1,i.state.courseId$),t.lcZ(2,3,i.test$),t.lcZ(3,5,i.saving$)))},dependencies:[u.O5,I.e,R.O,lt,u.Ov,g.X$]})}return n})();var Q=o(4229),Se=o(7921),Ee=o(4814),we=o(7625),Fe=o(9754);const Ue=function(n){return{count:n}};function ke(n,a){if(1&n&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,1===e.course.ParticipatingStudents.length?"courses.registration":"courses.registrations",t.VKq(4,Ue,e.course.ParticipatingStudents.length))," ")}}const Ne=function(){return["/events"]};let Je=(()=>{class n{constructor(e,s){this.reportsService=e,this.eventsRestService=s,this.course$=new C.X(null),this.reports$=this.course$.pipe((0,_.w)(i=>i?this.reportsService.getCourseReports(this.course.Id):(0,Z.of)([])),(0,Se.O)([]))}ngOnChanges(e){e.course&&this.course$.next(e.course.currentValue)}getDesignation(){return this.eventsRestService.getDesignation(this.course)}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(Ee.F),t.Y36(X.O))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-header"]],inputs:{course:"course"},features:[t.TTD],decls:12,vars:7,consts:[[3,"link"],[1,"d-flex"],["routerLink","add",1,"edit","btn","btn-primary","btn-icon","ms-2"],[1,"material-icons"],[1,"ms-2",3,"reports"],["id","excel-import"],[1,"d-flex","flex-column","header"],["class","additional-info",4,"ngIf"],[1,"additional-info"]],template:function(s,i){1&s&&(t.TgZ(0,"erz-backlink",0)(1,"div",1)(2,"a",2)(3,"i",3),t._uU(4,"add"),t.qZA()(),t._UZ(5,"erz-reports-link",4),t.ALo(6,"async"),t._UZ(7,"div",5),t.qZA()(),t.TgZ(8,"div",6)(9,"h1"),t._uU(10),t.qZA(),t.YNc(11,ke,3,6,"div",7),t.qZA()),2&s&&(t.Q6J("link",t.DdM(6,Ne)),t.xp6(5),t.Q6J("reports",t.lcZ(6,4,i.reports$)),t.xp6(5),t.Oqu(i.getDesignation()),t.xp6(1),t.Q6J("ngIf",i.course.ParticipatingStudents))},dependencies:[u.O5,m.rH,we.I,Fe.D,u.Ov,g.X$],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem;border-bottom:1px solid #dee2e6}h1[_ngcontent-%COMP%]{margin-bottom:0}.additional-info[_ngcontent-%COMP%]{color:#adb5bd}"]})}return n})();const qe=function(n){return{designation:n}};let ze=(()=>{class n{constructor(e){this.activeModal=e}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(G.Kz))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-publish-test"]],inputs:{test:"test"},decls:11,vars:12,consts:[[1,"modal-body"],["data-testid","confirmation-message"],[1,"modal-footer"],["data-testid","cancel-button","type","button",1,"btn","btn-outline-secondary",3,"click"],["data-testid","confirm-button","type","button",1,"btn","btn-primary",3,"click"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0)(1,"p",1),t._uU(2),t.ALo(3,"translate"),t.qZA()(),t.TgZ(4,"div",2)(5,"button",3),t.NdJ("click",function(){return i.activeModal.dismiss()}),t._uU(6),t.ALo(7,"translate"),t.qZA(),t.TgZ(8,"button",4),t.NdJ("click",function(){return i.activeModal.close(!0)}),t._uU(9),t.ALo(10,"translate"),t.qZA()()),2&s&&(t.xp6(2),t.hij(" ",t.xi3(3,3,i.test.IsPublished?"tests.publishing.unpublish":"tests.publishing.publish",t.VKq(10,qe,i.test.Designation))," "),t.xp6(4),t.hij(" ",t.lcZ(7,6,"tests.publishing.cancel")," "),t.xp6(3),t.hij(" ",t.lcZ(10,8,"tests.publishing.confirm")," "))},dependencies:[g.X$],encapsulation:2})}return n})();var ut=o(3620);const Re=function(n){return{maxPoints:n}};function Qe(n,a){if(1&n&&(t.TgZ(0,"div",8),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n){const e=t.oxw(2);t.xp6(1),t.hij(" ",t.xi3(2,1,"global.validation-errors.invalidPoints",t.VKq(4,Re,e.maxPoints))," ")}}function je(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",4)(1,"input",5,6),t.NdJ("ngModelChange",function(){t.CHM(e);const i=t.MAs(2),r=t.oxw();return t.KtG(r.onPointsChange(i.value))}),t.qZA(),t.YNc(3,Qe,3,6,"div",7),t.qZA()}if(2&n){const e=t.MAs(2),s=t.oxw();t.xp6(1),t.ekj("is-invalid",e.errors),t.s9C("max",s.maxPoints),t.s9C("tabindex",s.tabIndex),t.Q6J("disabled",s.grade.test.IsPublished)("ngModel","grade"===s.grade.kind?s.grade.result.Points:null),t.xp6(2),t.Q6J("ngIf",e.errors)}}let Ye=(()=>{class n{constructor(){this.gradeChanged=new t.vpe,this.maxPoints=0,this.pointsSubject$=new $.x,this.gradeSubject$=new $.x,this.gradingScaleDisabledSubject$=new C.X(!0),this.gradingScaleDisabled$=this.gradingScaleDisabledSubject$.asObservable(),this.points$=this.pointsSubject$.pipe((0,ut.b)(1250),(0,st.h)(this.isValid.bind(this))),this.grade$=this.gradeSubject$.pipe((0,ut.b)(1250)),this.destroy$=new $.x}ngOnInit(){this.gradingScaleDisabledSubject$.next(this.disableGradingScale()),this.maxPoints=function te(n){return(n?.test?.MaxPointsAdjusted||n?.test?.MaxPoints)??0}(this.grade),this.points$.pipe((0,F.R)(this.destroy$),(0,c.U)(this.buildRequestBodyPointsChange.bind(this))).subscribe(e=>this.gradeChanged.emit(e)),this.grade$.pipe((0,F.R)(this.destroy$),(0,c.U)(this.buildRequestBodyForGradeChange.bind(this))).subscribe(e=>this.gradeChanged.emit(e))}ngOnChanges(){this.gradingScaleDisabledSubject$.next(this.disableGradingScale())}ngOnDestroy(){this.destroy$.next()}onPointsChange(e){this.pointsSubject$.next(e),this.gradingScaleDisabledSubject$.next(!(null===e||""===e))}onGradeChange(e){this.gradeSubject$.next(e)}isValid(e){return""===e||null===e||!isNaN(Number(e))&&!(Number(e)<0||Number(e)>this.maxPoints)}buildRequestBodyPointsChange(e){const s=null===e||""===e?null:Number(e);return{StudentIds:[this.student.Id],TestId:this.grade.test.Id,Points:s}}buildRequestBodyForGradeChange(e){return{StudentIds:[this.student.Id],TestId:this.grade.test.Id,GradeId:e}}disableGradingScale(){return!!this.grade.test.IsPublished||"no-result"!==this.grade.kind&&null!=this.grade.result.Points&&this.grade.test.IsPointGrading}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-grade"]],inputs:{grade:"grade",student:"student",tabIndex:"tabIndex",gradeOptions:"gradeOptions"},outputs:{gradeChanged:"gradeChanged"},features:[t.TTD],decls:5,vars:8,consts:[[1,"d-flex","flex-column","w-100"],[1,"d-flex","flex-row"],["class","point-input-container me-2 me-md-3",4,"ngIf"],["data-testid","grade-select",1,"grade-select",3,"options","allowEmpty","value","disabled","tabindex","valueChange"],[1,"point-input-container","me-2","me-md-3"],["type","number","step","0.01","min","0","data-testid","point-input",1,"form-control",3,"max","disabled","tabindex","ngModel","ngModelChange"],["points","ngModel"],["class","invalid-feedback","data-testid","validation-error-message",4,"ngIf"],["data-testid","validation-error-message",1,"invalid-feedback"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,je,4,7,"div",2),t.TgZ(3,"erz-select",3),t.NdJ("valueChange",function(l){return i.onGradeChange(l)}),t.ALo(4,"async"),t.qZA()()()),2&s&&(t.xp6(2),t.Q6J("ngIf",i.grade.test.IsPointGrading),t.xp6(1),t.Q6J("options",i.gradeOptions)("allowEmpty",!0)("value","grade"===i.grade.kind?i.grade.result.GradeId:null)("disabled",t.lcZ(4,6,i.gradingScaleDisabled$))("tabindex",i.tabIndex))},dependencies:[u.O5,p.Fj,p.wV,p.JJ,p.qQ,p.Fd,p.On,Q.H,u.Ov,g.X$],styles:[".point-input-container[_ngcontent-%COMP%]{width:4em}[_nghost-%COMP%]     select{min-width:13ch}@media (min-width: 576px){.point-input-container[_ngcontent-%COMP%]{width:5em}}"]})}return n})();var De=o(5791),He=o(9707);let Ke=(()=>{class n{constructor(e){this.translate=e}transform(e){return`${e.Weight} (${e.WeightPercent}%)${this.getPoints(e)}`}getPoints(e){return e.IsPointGrading?`, ${e.MaxPointsAdjusted??e.MaxPoints} ${this.translate.instant("tests.summary.points")}`:""}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(g.sK,16))};static#e=this.\u0275pipe=t.Yjl({name:"testSummaryShort",type:n,pure:!0})}return n})();function Be(n,a){1&n&&(t.TgZ(0,"i",12),t._uU(1,"edit"),t.qZA())}const Xe=function(n){return[n,"edit"]};function Ve(n,a){if(1&n&&(t.TgZ(0,"div",8)(1,"div",9)(2,"erz-preserve-line-height"),t._uU(3),t.ALo(4,"date"),t.qZA(),t.TgZ(5,"a",10),t.YNc(6,Be,2,0,"i",11),t.qZA()(),t.TgZ(7,"erz-preserve-line-height"),t._uU(8),t.ALo(9,"testSummaryShort"),t.qZA(),t.TgZ(10,"erz-preserve-line-height"),t._uU(11),t.qZA()()),2&n){const e=t.oxw();t.xp6(3),t.Oqu(t.xi3(4,5,e.test.Date,"dd.MM.yyyy")),t.xp6(2),t.Q6J("routerLink",t.VKq(10,Xe,e.test.Id)),t.xp6(1),t.Q6J("ngIf",e.test.IsOwner&&!1===e.test.IsPublished),t.xp6(2),t.hij(" ",t.lcZ(9,8,e.test)," "),t.xp6(3),t.Oqu(e.test.Owner)}}function We(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",13)(1,"a",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.unpublishTest())}),t.ALo(2,"translate"),t.TgZ(3,"i",15),t._uU(4,"lock"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"erz-caret",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleHeader())}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("title",t.lcZ(2,3,"tests.edit")),t.xp6(5),t.Oqu(t.lcZ(7,5,"tests.published")),t.xp6(2),t.Q6J("expanded",e.expanded)}}function tn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",13)(1,"a",17),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.publishTest())}),t.ALo(2,"translate"),t.TgZ(3,"i",15),t._uU(4,"lock_open"),t.qZA(),t.TgZ(5,"span"),t._uU(6),t.ALo(7,"translate"),t.qZA()(),t.TgZ(8,"erz-caret",16),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.toggleHeader())}),t.qZA()()}if(2&n){const e=t.oxw();t.xp6(1),t.s9C("title",t.lcZ(2,3,"tests.publish")),t.xp6(5),t.Oqu(t.lcZ(7,5,"tests.not-published")),t.xp6(2),t.Q6J("expanded",e.expanded)}}let en=(()=>{class n{constructor(){this.toggle=new t.vpe,this.publish=new t.vpe,this.unpublish=new t.vpe}toggleHeader(){this.toggle.emit(!this.expanded)}publishTest(){this.publish.emit(this.test)}unpublishTest(){this.unpublish.emit(this.test)}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-test-table-header"]],inputs:{test:"test",expanded:"expanded"},outputs:{toggle:"toggle",publish:"publish",unpublish:"unpublish"},decls:10,vars:6,consts:[[1,"d-flex","flex-column","h-100","justify-content-between"],["role","button",1,"test-designation","d-flex","flex-row","my-3","align-items-end","justify-content-between",3,"click"],[3,"ngClass"],[1,"align-self-start",3,"expanded"],[1,"d-flex","flex-column"],["class","d-flex flex-column mb-3",4,"ngIf"],["class","d-flex align-items-center justify-content-between test-status",4,"ngIf","ngIfElse"],["notPublished",""],[1,"d-flex","flex-column","mb-3"],[1,"d-flex","flex-row","justify-content-between"],[1,"btn","btn-link","p-0","edit",3,"routerLink"],["class","material-icons",4,"ngIf"],[1,"material-icons"],[1,"d-flex","align-items-center","justify-content-between","test-status"],[1,"d-flex","btn","btn-link","ps-0","edit",3,"title","click"],[1,"material-icons","me-1"],[1,"expand-mobile",3,"expanded","click"],[1,"d-flex","btn","btn-link","ps-0",3,"title","click"]],template:function(s,i){if(1&s&&(t.TgZ(0,"div",0)(1,"div",1),t.NdJ("click",function(){return i.toggleHeader()}),t.TgZ(2,"div",2),t._uU(3),t.qZA(),t._UZ(4,"erz-caret",3),t.qZA(),t.TgZ(5,"div",4),t.YNc(6,Ve,12,12,"div",5),t.YNc(7,We,9,7,"div",6),t.YNc(8,tn,9,7,"ng-template",null,7,t.W1O),t.qZA()()),2&s){const r=t.MAs(9);t.xp6(2),t.Q6J("ngClass",i.expanded?"expanded":"collapsed"),t.xp6(1),t.hij(" ",i.test.Designation," "),t.xp6(1),t.Q6J("expanded",i.expanded),t.xp6(2),t.Q6J("ngIf",i.expanded),t.xp6(1),t.Q6J("ngIf",i.test.IsPublished)("ngIfElse",r)}},dependencies:[u.mk,u.O5,m.rH,De.Q,He.r,u.uU,g.X$,Ke],styles:["[_nghost-%COMP%]{font-weight:300}.collapsed[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.test-designation[_ngcontent-%COMP%]{display:none!important}.test-status[_ngcontent-%COMP%]{order:-1;padding-bottom:1rem}.test-status[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.test-status[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#000}.test-status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}.test-status[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{text-decoration-color:#ea161f}.edit[_ngcontent-%COMP%]{color:#00000080;text-decoration:none}@media (min-width: 750px){.test-designation[_ngcontent-%COMP%]{display:inherit!important}.test-status[_ngcontent-%COMP%]{order:initial}.expand-mobile[_ngcontent-%COMP%]{display:none!important}}"]})}return n})();var j=o(6651);function nn(n,a){if(1&n&&(t.TgZ(0,"span",3),t._uU(1),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Oqu(e.calculatePointsAverage(e.test))}}let sn=(()=>{class n{constructor(e){this.locale=e}calculatePointsAverage(e){return this.safeAverage(e,2,b.dw)}calculateGradeAverage(e){return this.safeAverage(e,3,b.dP)}safeAverage(e,s,i){try{return(0,j.ey)(i(e),this.locale,s)}catch{return j.GR}}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(t.soG))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-average-grades"]],inputs:{test:"test"},decls:4,vars:2,consts:[[1,"d-flex","flex-row","w-100"],["class","mr-2 mr-md-3 average-points","data-testid","average-points",4,"ngIf"],["data-testid","average-grade"],["data-testid","average-points",1,"mr-2","mr-md-3","average-points"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0),t.YNc(1,nn,2,1,"span",1),t.TgZ(2,"span",2),t._uU(3),t.qZA()()),2&s&&(t.xp6(1),t.Q6J("ngIf",i.test.IsPointGrading),t.xp6(2),t.Oqu(i.calculateGradeAverage(i.test)))},dependencies:[u.O5],styles:[".average-points[_ngcontent-%COMP%]{min-width:4.5em}@media (min-width: 576px){.average-points[_ngcontent-%COMP%]{min-width:6em}}"]})}return n})(),an=(()=>{class n{constructor(){this.disabled=!1,this.gradeIdSelected=new t.vpe}onGradeChange(e){void 0!==this.gradeId?.valueOf()&&this.gradeIdSelected.emit({id:this.gradeId?.valueOf(),selectedGradeId:e})}static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-grade-select"]],inputs:{options:"options",valueId:"valueId",gradeId:"gradeId",disabled:"disabled"},outputs:{gradeIdSelected:"gradeIdSelected"},decls:1,vars:4,consts:[["data-testid","grade-select",3,"options","allowEmpty","value","disabled","valueChange"]],template:function(s,i){1&s&&(t.TgZ(0,"erz-select",0),t.NdJ("valueChange",function(l){return i.onGradeChange(l)}),t.qZA()),2&s&&t.Q6J("options",i.options)("allowEmpty",!0)("value",i.valueId)("disabled",i.disabled)},dependencies:[Q.H],styles:["[_nghost-%COMP%]     select{min-width:13ch}"]})}return n})();function rn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"th",25)(1,"erz-test-table-header",26),t.NdJ("toggle",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.state.toggleHeader(i))})("publish",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.publish(i))})("unpublish",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.unpublish(i))}),t.qZA()()}if(2&n){const e=a.$implicit,s=t.oxw().erzLet,i=t.oxw();t.Q6J("ngClass",e.Id===(null==i.selectedTest?null:i.selectedTest.Id)?"selected":""),t.xp6(1),t.Q6J("test",e)("expanded",s.expanded)}}function on(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"th",27)(1,"erz-test-table-header",26),t.NdJ("toggle",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.state.toggleHeader(i))})("publish",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.publish(i))})("unpublish",function(i){t.CHM(e);const r=t.oxw(2);return t.KtG(r.unpublish(i))}),t.qZA()()}if(2&n){const e=a.$implicit,s=t.oxw().erzLet,i=t.oxw();t.Q6J("ngClass",e.Id===(null==i.selectedTest?null:i.selectedTest.Id)?"selected":""),t.xp6(1),t.Q6J("test",e)("expanded",s.expanded)}}function dn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"div",31)(1,"span",30),t.NdJ("click",function(){t.CHM(e);const i=t.oxw().$implicit,r=t.oxw(2);return t.KtG(r.state.sortBy(i))}),t._uU(2),t.ALo(3,"translate"),t.qZA()()}2&n&&(t.xp6(2),t.hij("",t.lcZ(3,1,"tests.points")," "))}function ln(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"th",28)(1,"div",11),t.YNc(2,dn,4,3,"div",29),t.TgZ(3,"div",12)(4,"span",30),t.NdJ("click",function(){const r=t.CHM(e).$implicit,l=t.oxw(2);return t.KtG(l.state.sortBy(r))}),t._uU(5),t.ALo(6,"translate"),t.qZA()(),t.TgZ(7,"div",13),t._uU(8),t.ALo(9,"async"),t.qZA()()()}if(2&n){const e=a.$implicit,s=t.oxw(2);t.Q6J("ngClass",e.Id===(null==s.selectedTest?null:s.selectedTest.Id)?"selected":""),t.xp6(2),t.Q6J("ngIf",e.IsPointGrading),t.xp6(3),t.Oqu(t.lcZ(6,4,"tests.grade")),t.xp6(3),t.hij(" ",t.lcZ(9,6,s.state.getSortingChar$(e))," ")}}function cn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"erz-grade-select",39),t.NdJ("gradeIdSelected",function(i){t.CHM(e);const r=t.oxw(3);return t.KtG(r.state.overwriteFinalGrade(i))}),t.ALo(1,"async"),t.ALo(2,"async"),t.qZA()}if(2&n){const e=t.oxw().$implicit,s=t.oxw(2);t.Q6J("options",t.lcZ(1,4,s.state.gradingOptionsForCourse$()))("valueId",e.finalGrade.finalGradeId)("gradeId",e.finalGrade.id)("disabled",!1===t.lcZ(2,6,s.isEditFinalGradesAllowed(e)))}}function un(n,a){if(1&n&&(t.TgZ(0,"div"),t._uU(1),t.qZA()),2&n){const e=t.oxw().$implicit;t.xp6(1),t.hij(" ",e.finalGrade.freeHandGrade," ")}}function pn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"td",40)(1,"erz-grade",41),t.NdJ("gradeChanged",function(i){t.CHM(e);const r=t.oxw(3);return t.KtG(r.saveGrade(i))}),t.ALo(2,"async"),t.qZA()()}if(2&n){const e=a.$implicit,s=a.index,i=t.oxw(),r=i.$implicit,l=i.index,d=t.oxw(2);t.Q6J("ngClass",void 0!==d.selectedTest&&e.test.Id===(null==d.selectedTest?null:d.selectedTest.Id)?"selected":""),t.xp6(1),t.Q6J("grade",e)("gradeOptions",t.lcZ(2,5,d.state.gradingOptionsForTest$(e.test)))("student",r.student)("tabIndex",1e3*(1+s)+l)}}const gn=function(n){return["student",n,"grades"]},Y=function(n){return{selected:n}};function _n(n,a){if(1&n&&(t.TgZ(0,"tr")(1,"td",32)(2,"a",33)(3,"span"),t._uU(4),t.qZA(),t.TgZ(5,"span",20),t._uU(6),t.ALo(7,"translate"),t.ALo(8,"decimalOrDash"),t.qZA()()(),t.TgZ(9,"td",34),t.YNc(10,cn,3,8,"erz-grade-select",35),t.YNc(11,un,2,1,"div",36),t.qZA(),t.TgZ(12,"td",37),t._uU(13),t.ALo(14,"decimalOrDash"),t.qZA(),t.YNc(15,pn,3,7,"td",38),t.qZA()),2&n){const e=a.$implicit,s=t.oxw(2);t.xp6(2),t.Q6J("routerLink",t.VKq(18,gn,e.student.Id)),t.xp6(2),t.Oqu(e.student.FullName),t.xp6(2),t.AsE(" ",t.lcZ(7,10,"tests.mean"),": ",t.xi3(8,12,null==e.finalGrade?null:e.finalGrade.average,"1-3")," "),t.xp6(3),t.Q6J("ngClass",t.VKq(20,Y,void 0===s.selectedTest)),t.xp6(1),t.Q6J("ngIf",e.finalGrade&&!e.finalGrade.freeHandGrade),t.xp6(1),t.Q6J("ngIf",e.finalGrade&&e.finalGrade.freeHandGrade),t.xp6(2),t.hij(" ",t.xi3(14,15,null==e.finalGrade?null:e.finalGrade.average,"1-3")," "),t.xp6(2),t.Q6J("ngForOf",e.grades)("ngForTrackBy",s.trackGradeOf(e.student))}}function mn(n,a){if(1&n&&(t.TgZ(0,"td",40),t._UZ(1,"erz-average-grades",42),t.qZA()),2&n){const e=a.$implicit,s=t.oxw(2);t.Q6J("ngClass",e.Id===(null==s.selectedTest?null:s.selectedTest.Id)||e.Id===(null==s.selectedTest?null:s.selectedTest.Id)?"selected":""),t.xp6(1),t.Q6J("test",e)}}const hn=function(n){return{"visible-on-mobile":n}};function fn(n,a){if(1&n){const e=t.EpF();t.TgZ(0,"button",43),t.NdJ("click",function(){t.CHM(e);const i=t.oxw(2);return t.KtG(i.setAverageAsFinalGrade())}),t._uU(1),t.ALo(2,"translate"),t.qZA()}if(2&n){const e=t.oxw().erzLet,s=t.oxw();t.Q6J("ngClass",t.VKq(4,hn,!e.hasTests||!s.selectedTest)),t.xp6(1),t.hij(" ",t.lcZ(2,2,"tests.set-final-grade")," ")}}const gt=function(n,a){return{"btn-primary":n,"btn-outline-secondary":a}};function vn(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"div",1)(2,"table",2)(3,"thead",3)(4,"tr",4)(5,"th",5)(6,"button",6),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.changeFilter("all-tests"))}),t._uU(7),t.ALo(8,"translate"),t.qZA(),t.TgZ(9,"button",7),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.changeFilter("my-tests"))}),t._uU(10),t.ALo(11,"translate"),t.qZA()(),t.YNc(12,rn,2,3,"th",8),t.YNc(13,on,2,3,"th",9),t.qZA(),t.TgZ(14,"tr")(15,"th",10),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.state.sortBy("FullName"))}),t.TgZ(16,"div",11)(17,"div",12),t._uU(18),t.ALo(19,"translate"),t.qZA(),t.TgZ(20,"div",13),t._uU(21),t.ALo(22,"async"),t.qZA()()(),t.TgZ(23,"th",14),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.state.sortBy("FinalGrade"))}),t.TgZ(24,"div",11)(25,"div",12),t._uU(26),t.ALo(27,"translate"),t.qZA(),t.TgZ(28,"div",13),t._uU(29),t.ALo(30,"async"),t.qZA()()(),t.TgZ(31,"th",15),t.NdJ("click",function(){t.CHM(e);const i=t.oxw();return t.KtG(i.state.sortBy("TestsMean"))}),t.TgZ(32,"div",11)(33,"div",12),t._uU(34),t.ALo(35,"translate"),t.qZA(),t.TgZ(36,"div",13),t._uU(37),t.ALo(38,"async"),t.qZA()()(),t.YNc(39,ln,10,8,"th",16),t.qZA()(),t.TgZ(40,"tbody"),t.YNc(41,_n,16,22,"tr",17),t.TgZ(42,"tr")(43,"td",18)(44,"div",19)(45,"div"),t._uU(46),t.ALo(47,"translate"),t.qZA(),t.TgZ(48,"div",20),t._uU(49),t.ALo(50,"translate"),t.ALo(51,"decimalOrDash"),t.ALo(52,"async"),t.qZA()()(),t.TgZ(53,"td",21),t._uU(54),t.ALo(55,"decimalOrDash"),t.ALo(56,"async"),t.qZA(),t.TgZ(57,"td",22),t._uU(58),t.ALo(59,"decimalOrDash"),t.ALo(60,"async"),t.qZA(),t.YNc(61,mn,2,2,"td",23),t.qZA()()(),t.YNc(62,fn,3,6,"button",24),t.ALo(63,"async"),t.qZA(),t.BQk()}if(2&n){const e=a.erzLet,s=t.oxw();t.xp6(6),t.Q6J("ngClass",t.WLB(61,gt,"all-tests"===e.filter,"all-tests"!==e.filter)),t.xp6(1),t.hij(" ",t.lcZ(8,24,"tests.all-tests")," "),t.xp6(2),t.Q6J("ngClass",t.WLB(64,gt,"my-tests"===e.filter,"my-tests"!==e.filter)),t.xp6(1),t.hij(" ",t.lcZ(11,26,"tests.owned-tests")," "),t.xp6(2),t.Q6J("ngForOf",e.tests),t.xp6(1),t.Q6J("ngForOf",e.tests),t.xp6(5),t.hij(" ",t.lcZ(19,28,"tests.student.name")," "),t.xp6(3),t.hij(" ",t.lcZ(22,30,s.state.getSortingChar$("FullName"))," "),t.xp6(2),t.Q6J("ngClass",t.VKq(67,Y,void 0===s.selectedTest)),t.xp6(3),t.hij(" ",t.lcZ(27,32,"tests.grade")," "),t.xp6(3),t.hij(" ",t.lcZ(30,34,s.state.getSortingChar$("FinalGrade"))," "),t.xp6(5),t.hij(" ",t.lcZ(35,36,"tests.mean")," "),t.xp6(3),t.hij(" ",t.lcZ(38,38,s.state.getSortingChar$("TestsMean"))," "),t.xp6(2),t.Q6J("ngForOf",e.tests),t.xp6(2),t.Q6J("ngForOf",e.studentGrades)("ngForTrackBy",s.trackStudentGrade),t.xp6(5),t.Oqu(t.lcZ(47,40,"tests.average")),t.xp6(3),t.AsE(" ",t.lcZ(50,42,"tests.mean"),": ",t.xi3(51,44,t.lcZ(52,47,s.state.meanOfStudentGradesForCourse$),"1-3")," "),t.xp6(4),t.Q6J("ngClass",t.VKq(69,Y,void 0===s.selectedTest)),t.xp6(1),t.hij(" ",t.xi3(55,49,t.lcZ(56,52,s.state.meanOfFinalGradesForCourse$),"1-3")," "),t.xp6(4),t.hij(" ",t.xi3(59,54,t.lcZ(60,57,s.state.meanOfStudentGradesForCourse$),"1-3")," "),t.xp6(3),t.Q6J("ngForOf",e.tests),t.xp6(1),t.Q6J("ngIf",t.lcZ(63,59,s.state.canSetFinalGrade$))}}const xn=function(n,a,e,s,i){return{tests:n,hasTests:a,studentGrades:e,filter:s,expanded:i}};let Tn=(()=>{class n{constructor(e,s){this.state=e,this.modalService=s}ngOnInit(){this.state.setSorting({key:"FullName",ascending:!0})}changeFilter(e){this.state.filter$.next(e)}saveGrade(e){this.state.saveGrade(e)}setAverageAsFinalGrade(){this.state.course$.pipe((0,L.q)(1)).subscribe(e=>this.state.setAveragesAsFinalGrades({CourseIds:[e.Id]}))}isEditFinalGradesAllowed(e){return this.state.course$.pipe((0,c.U)(s=>!(!H(s)?.value||!e.finalGrade?.canGrade)))}publish(e){const s=this.openModal(e);this.onCloseModal(s,()=>this.state.publish(e))}unpublish(e){const s=this.openModal(e);this.onCloseModal(s,()=>this.state.unpublish(e))}trackStudentGrade(e){return e}trackGradeOf(e){return function(s,i){return`${e.Id}_${i.test.Id}`}}calculatePointsAverage(e){return this.safeAverage(e,b.dw)}calculateGradeAverage(e){return this.safeAverage(e,b.dP)}safeAverage(e,s){try{return s(e).toString()}catch{return"\u2013"}}openModal(e){const s=this.modalService.open(ze);return s.componentInstance.test=e,s}onCloseModal(e,s){e.result.then(i=>{i&&s()},()=>{})}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(M),t.Y36(ct.p))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-test-edit-grades"]],inputs:{selectedTest:"selectedTest"},features:[t._Bn([z])],decls:6,vars:17,consts:[[4,"erzLet"],[1,"table-responsive-wrapper"],[1,"table","table-hover","h-100"],[1,"h-100"],[1,"h-100","header-collapsible"],["colspan","3",1,"desktop","pt-3","sticky"],["type","button",1,"btn","desktop",3,"ngClass","click"],["type","button",1,"btn","ms-2","desktop",3,"ngClass","click"],["container","body","class","grade h-100 test-info-desktop",3,"ngClass",4,"ngFor","ngForOf"],["container","body","class","grade h-100 header-mobile test-info-mobile","colspan","3",3,"ngClass",4,"ngFor","ngForOf"],[1,"primary-column-width","sticky",3,"click"],[1,"d-flex"],[1,"column-title"],[1,"sort-direction","ms-1"],[1,"secondary-column-width","sticky","sticky-col-2","desktop",3,"ngClass","click"],[1,"secondary-column-width","border-end","sticky","sticky-col-3","desktop",3,"click"],["container","body","class","grade h-100",3,"ngClass",4,"ngFor","ngForOf"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"sticky"],[1,"d-flex","flex-column"],[1,"mobile","mean"],[1,"desktop","sticky","sticky","sticky-col-2",3,"ngClass"],[1,"desktop","border-end","sticky","sticky-col-3"],["class","grade",3,"ngClass",4,"ngFor","ngForOf"],["data-testId","apply-average-button","class","apply-average-button btn btn-primary m-3","type","button",3,"ngClass","click",4,"ngIf"],["container","body",1,"grade","h-100","test-info-desktop",3,"ngClass"],[3,"test","expanded","toggle","publish","unpublish"],["container","body","colspan","3",1,"grade","h-100","header-mobile","test-info-mobile",3,"ngClass"],["container","body",1,"grade","h-100",3,"ngClass"],["class","column-title me-3 point-input-container",4,"ngIf"],[3,"click"],[1,"column-title","me-3","point-input-container"],[1,"primary-column-width","sticky","name"],[3,"routerLink"],[1,"grade","sticky","sticky-col-2",3,"ngClass"],[3,"options","valueId","gradeId","disabled","gradeIdSelected",4,"ngIf"],[4,"ngIf"],[1,"grade","border-end","sticky","sticky-col-3"],["class","grade",3,"ngClass",4,"ngFor","ngForOf","ngForTrackBy"],[3,"options","valueId","gradeId","disabled","gradeIdSelected"],[1,"grade",3,"ngClass"],[3,"grade","gradeOptions","student","tabIndex","gradeChanged"],[3,"test"],["data-testId","apply-average-button","type","button",1,"apply-average-button","btn","btn-primary","m-3",3,"ngClass","click"]],template:function(s,i){1&s&&(t.YNc(0,vn,64,71,"ng-container",0),t.ALo(1,"async"),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async")),2&s&&t.Q6J("erzLet",t.qbA(11,xn,t.lcZ(1,1,i.state.filteredTests$),t.lcZ(2,3,i.state.hasTests$),t.lcZ(3,5,i.state.studentGrades$),t.lcZ(4,7,i.state.filter$),t.lcZ(5,9,i.state.expandedHeader$)))},dependencies:[u.mk,u.sg,u.O5,m.rH,I.e,Ye,en,sn,an,u.Ov,g.X$,j.fY],styles:[".filter-hover[_ngcontent-%COMP%]:hover{background-color:#dedede}table[_ngcontent-%COMP%]   th.grade.selected[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade.selected[_ngcontent-%COMP%]{display:table-cell!important}table[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade[_ngcontent-%COMP%], .desktop[_ngcontent-%COMP%]{display:none!important}.desktop.selected[_ngcontent-%COMP%]{display:table-cell!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;vertical-align:top}.header-collapsible[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-bottom:1px solid #dee2e6;padding:0 1rem}.mobile[_ngcontent-%COMP%]{display:block!important}.mean[_ngcontent-%COMP%]{color:#4e4e4ef2;font-size:.875rem;line-height:1}td.name[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}td.name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child{text-decoration:underline}td.name[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:first-child:hover{text-decoration-color:#ea161f}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-desktop[_ngcontent-%COMP%]{display:none!important}table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:1rem}table[_ngcontent-%COMP%]   td.name[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.average[_ngcontent-%COMP%]{max-width:18ch;overflow:hidden;text-overflow:ellipsis;white-space:nowrap;padding-right:0}.point-input-container[_ngcontent-%COMP%]{width:5em}@media (min-width: 576px){.table-responsive-wrapper[_ngcontent-%COMP%]{display:block;overflow-x:auto}table[_ngcontent-%COMP%]{border-collapse:separate;border-spacing:0}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-mobile[_ngcontent-%COMP%]{display:none!important}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.test-info-desktop[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%], table[_ngcontent-%COMP%]   td.grade[_ngcontent-%COMP%], .desktop[_ngcontent-%COMP%]{display:table-cell!important}table[_ngcontent-%COMP%]   td.name[_ngcontent-%COMP%]{max-width:auto;overflow:visible}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{border-top:none;padding-top:.25rem;padding-bottom:.25rem;border-top:initial;min-width:100px;max-width:100px}thead[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   th.grade[_ngcontent-%COMP%]{min-width:300px;max-width:300px}.mobile[_ngcontent-%COMP%]{display:none!important}.primary-column-width[_ngcontent-%COMP%]{overflow:hidden;white-space:nowrap;text-overflow:ellipsis;min-width:300px;max-width:300px}.secondary-column-width[_ngcontent-%COMP%]{min-width:100px;max-width:100px}table[_ngcontent-%COMP%]   .sticky[_ngcontent-%COMP%]{position:sticky;left:0;background-color:#fff}table[_ngcontent-%COMP%]   .sticky.sticky-col-2[_ngcontent-%COMP%]{left:300px}table[_ngcontent-%COMP%]   .sticky.sticky-col-3[_ngcontent-%COMP%]{left:452px}}@media (max-width: 575.98px){.apply-average-button[_ngcontent-%COMP%]:not(.visible-on-mobile){display:none!important}}"]})}return n})();function Cn(n,a){if(1&n){const e=t.EpF();t.ynx(0),t.TgZ(1,"erz-select",7),t.NdJ("valueChange",function(i){t.CHM(e);const r=t.oxw(3);return t.KtG(r.testSelected(i))}),t.qZA(),t._UZ(2,"erz-test-edit-grades",8),t.BQk()}if(2&n){const e=t.oxw(2).erzLet;t.xp6(1),t.Q6J("options",e.testOptions)("value",e.selectedTestId)("allowEmpty",!1),t.xp6(1),t.Q6J("selectedTest",e.selectedTest)}}const bn=function(n){return{"visible-on-mobile":n}};function Zn(n,a){if(1&n&&(t.TgZ(0,"a",9),t.ALo(1,"async"),t.TgZ(2,"i",10),t._uU(3,"arrow_right_alt"),t.qZA(),t.TgZ(4,"span",11),t._uU(5),t.ALo(6,"translate"),t.qZA()()),2&n){const e=t.oxw(2).erzLet,s=t.oxw();t.s9C("href",t.lcZ(1,3,s.buildLinkToRatingOverview()),t.LSH),t.Q6J("ngClass",t.VKq(7,bn,!e.hasTests||!e.selectedTest)),t.xp6(5),t.Oqu(t.lcZ(6,5,"tests.link-to-rating-overview"))}}function An(n,a){if(1&n&&(t.ynx(0),t._UZ(1,"erz-tests-header",5),t.YNc(2,Cn,3,4,"ng-container",4),t.YNc(3,Zn,7,9,"a",6),t.ALo(4,"async"),t.BQk()),2&n){const e=t.oxw().erzLet,s=t.oxw(),i=t.MAs(9);t.xp6(1),t.Q6J("course",e.course),t.xp6(1),t.Q6J("ngIf",e.tests.length>0)("ngIfElse",i),t.xp6(1),t.Q6J("ngIf",t.lcZ(4,4,s.state.canSetFinalGrade$))}}function yn(n,a){if(1&n&&(t.ynx(0),t.YNc(1,An,5,6,"ng-container",4),t.ALo(2,"async"),t.BQk()),2&n){const e=t.oxw(),s=t.MAs(11);t.xp6(1),t.Q6J("ngIf",!1===t.lcZ(2,2,e.state.loading$))("ngIfElse",s)}}function In(n,a){1&n&&(t.TgZ(0,"p",12),t._uU(1),t.ALo(2,"translate"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"tests.no-tests")))}function On(n,a){1&n&&t._UZ(0,"erz-spinner")}const Gn=function(n,a,e,s,i,r){return{course:n,tests:a,hasTests:e,testOptions:s,selectedTestId:i,selectedTest:r}};let $n=(()=>{class n{constructor(e,s,i){this.settings=e,this.state=s,this.translate=i,this.selectTest$=new $.x,this.testOptions$=this.state.tests$.pipe((0,c.U)(r=>[{Key:-1,Value:this.translate.instant("tests.grade")},...r.map(l=>({Key:l.Id,Value:l.Designation}))]),(0,O.x)()),this.selectedTestId$=(0,nt.T)(this.selectTest$,this.state.tests$.pipe((0,L.q)(1),(0,c.U)(r=>r[0]?.Id))).pipe((0,O.x)()),this.selectedTest$=this.selectedTestId$.pipe((0,_.w)(r=>this.state.tests$.pipe((0,c.U)(l=>l.find(d=>d.Id===r)))),(0,O.x)())}testSelected(e){this.selectTest$.next(e)}buildLinkToRatingOverview(){return this.state.course$.pipe((0,L.q)(1),(0,c.U)(e=>this.settings.eventlist.evaluation.replace(":id",String(e.Id))))}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(x.L6),t.Y36(M),t.Y36(g.sK))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests-list"]],decls:12,vars:20,consts:[[1,"erz-container"],[4,"erzLet"],["noTests",""],["loading",""],[4,"ngIf","ngIfElse"],[3,"course"],["class","rating-overview d-flex justify-content-end pe-3 border-top pt-3",3,"ngClass","href",4,"ngIf"],[1,"tests-dropdown",3,"options","value","allowEmpty","valueChange"],[3,"selectedTest"],[1,"rating-overview","d-flex","justify-content-end","pe-3","border-top","pt-3",3,"ngClass","href"],[1,"material-icons","fw-bold"],[1,"ps-1"],[1,"mt-3","px-3"]],template:function(s,i){1&s&&(t.TgZ(0,"div",0),t.YNc(1,yn,3,4,"ng-container",1),t.ALo(2,"async"),t.ALo(3,"async"),t.ALo(4,"async"),t.ALo(5,"async"),t.ALo(6,"async"),t.ALo(7,"async"),t.YNc(8,In,3,3,"ng-template",null,2,t.W1O),t.YNc(10,On,1,0,"ng-template",null,3,t.W1O),t.qZA()),2&s&&(t.xp6(1),t.Q6J("erzLet",t.HTZ(13,Gn,t.lcZ(2,1,i.state.course$),t.lcZ(3,3,i.state.tests$),t.lcZ(4,5,i.state.hasTests$),t.lcZ(5,7,i.testOptions$),t.lcZ(6,9,i.selectedTestId$),t.lcZ(7,11,i.selectedTest$))))},dependencies:[u.mk,u.O5,I.e,Q.H,R.O,Je,Tn,u.Ov,g.X$],styles:[".tests-dropdown[_ngcontent-%COMP%]{display:block;padding:1rem 0}@media (min-width: 576px){.tests-dropdown[_ngcontent-%COMP%]{display:none}}a.rating-overview[_ngcontent-%COMP%]{text-decoration:none}a.rating-overview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{text-decoration:underline}a.rating-overview[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:hover{text-decoration-color:#ea161f}@media (max-width: 575.98px){a.rating-overview[_ngcontent-%COMP%]:not(.visible-on-mobile){display:none!important}}"]})}return n})(),D=(()=>{class n{constructor(e,s){this.state=e,this.route=s,this.courseId$=this.route.paramMap.pipe((0,c.U)(i=>Number(i.get("id"))),(0,O.x)()),this.destroy$=new $.x}ngOnInit(){this.courseId$.pipe((0,F.R)(this.destroy$)).subscribe(e=>this.state.setCourseId(e))}ngOnDestroy(){this.destroy$.next()}static#t=this.\u0275fac=function(s){return new(s||n)(t.Y36(M),t.Y36(m.gz))};static#e=this.\u0275cmp=t.Xpm({type:n,selectors:[["erz-tests"]],features:[t._Bn([M])],decls:1,vars:0,template:function(s,i){1&s&&t._UZ(0,"router-outlet")},dependencies:[m.lC]})}return n})();const Pn=[{path:"",component:qt,children:[{path:"",component:Jt},{path:"current",component:Nt},{path:":id",component:D,children:[{path:"tests",component:$n}]},{path:":id/tests/:testId/edit",component:D,children:[{path:"",component:Me}]},{path:":id/tests/add",component:D,children:[{path:"",component:ye}]},{path:":id/tests",children:[J.H]}]}];let Ln=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({imports:[m.Bz.forChild(Pn),m.Bz]})}return n})(),Mn=(()=>{class n{static#t=this.\u0275fac=function(s){return new(s||n)};static#e=this.\u0275mod=t.oAB({type:n});static#n=this.\u0275inj=t.cJS({providers:[k.o],imports:[N.m,Ln]})}return n})()},1608:(_t,E,o)=>{o.d(E,{K:()=>A});var k=o(8658),N=o(7398),m=o(5619),J=o(3997),t=o(7081),q=o(8180),C=o(5879);let A=(()=>{class v{getSortingChar$(_){return this.sorting$.pipe((0,N.U)(x=>x&&_===x.key?x.ascending?"\u2193":"\u2191":""))}constructor(){this.sortingSubject$=new m.X(null),this.sorting$=this.sortingSubject$.asObservable().pipe((0,J.x)(k.Z),(0,t.d)(1))}setSorting(_){this.sortingSubject$.next(_)}toggleSorting(_){this.sorting$.pipe((0,q.q)(1)).subscribe(x=>{this.sortingSubject$.next({key:_,ascending:!x||x.key!==_||!x.ascending})})}static#t=this.\u0275fac=function(x){return new(x||v)};static#e=this.\u0275prov=C.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"})}return v})()}}]);