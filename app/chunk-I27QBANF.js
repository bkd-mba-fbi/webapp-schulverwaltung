import{a as M,d as u}from"./chunk-YNODG5RP.js";import{a as G}from"./chunk-SNNR7FJ6.js";import{a as s}from"./chunk-EFJ6WEH7.js";import{h as P,z as F}from"./chunk-ZXUJZ6KS.js";import{Cd as p,Dd as A,Ed as m,Gd as U,Hd as l,Id as o,Nd as S,O as V,Od as $,Rd as v,Wd as d,_ as C,aa as I,ba as n,ea as O,j as T,ja as g,oa as f,v as a,wd as R,xd as j,yd as h,zd as x}from"./chunk-GP622B77.js";function K(e){var i=Object.create(Object.getPrototypeOf(e));return Object.assign(i,e),i}function _(e,i,c){c===void 0&&(c=e.name);var t=K(e);return t.validate=i,t.decode=function(r){return i(r,$(t))},t.name=c,t}function y(e,i,c){return c===void 0&&(c="withFallback("+e.name+")"),_(e,function(t,r){return R(function(){return h(i)})(e.validate(t,r))},c)}var z=o({Key:p,Value:p}),D=o({Id:p,Settings:S(l(z))}),b=d.pipe(o({mail:y(m,!1),gui:y(m,!1),phoneMobile:y(m,!1)})),E=new x("NotificationTypesInactive",e=>Array.isArray(e)&&e.every(i=>typeof i=="string"),(e,i)=>typeof e=="string"?h(e.split(";").filter(Boolean)):j(e,i),e=>e.join(";")),Q=function(e){return e.Grid="grid",e.List="list",e}(Q||{}),w=d.pipe(o({presenceControl:U({grid:null,list:null})})),X=o({eventId:v(A),group:v(G.props.Key)}),N=d.pipe(S(l(X))),Y=o({AccessInfo:o({Roles:l(p),Permissions:l(p)})});var L=(()=>{let i=class i extends M{constructor(){let t=f(P),r=f(F);super(t,r,D,"UserSettings")}getUserSettingsCst(t){return this.http.get(`${this.baseUrl}/Cst`,{params:t}).pipe(n(s(this.codec)))}updateUserSettingsCst(t){return this.http.patch(`${this.baseUrl}/Cst`,t)}getAccessInfo(){return this.http.get(`${this.baseUrl}/?expand=AccessInfo`).pipe(n(s(Y)),a(({AccessInfo:t})=>t))}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();var tt=100,H="presenceControlViewMode",W="presenceControlGroupView",B="notification",J="notificationTypesInactive",Vt=(()=>{let i=class i{constructor(){this.settingsRestService=f(L),this.refetch$=new T,this.settings$=this.refetch$.pipe(I(null),V(tt),n(()=>this.settingsRestService.getUserSettingsCst()),a(t=>t.Settings),C(1)),this.accessInfo$=this.settingsRestService.getAccessInfo().pipe(C(1))}refetch(){this.refetch$.next()}getSetting(t){return this.settings$.pipe(a(r=>r.find(q=>q.Key===t)?.Value??null))}saveSetting(t,r){return this.settingsRestService.updateUserSettingsCst(this.buildSettings(t,r)).pipe(O(()=>this.refetch$.next()))}getPresenceControlViewMode(){return this.getSetting(H).pipe(u('{"presenceControl":"grid"}'),n(s(w)),a(({presenceControl:t})=>t))}savePresenceControlViewMode(t){return this.saveSetting(H,w.encode({presenceControl:t}))}getPresenceControlGroupView(){return this.getSetting(W).pipe(u("[]"),n(s(N)))}savePresenceControlGroupView(t){return this.saveSetting(W,N.encode(t))}getNotificationChannels(){return this.getSetting(B).pipe(u("{}"),n(s(b)))}saveNotificationChannels(t){return this.saveSetting(B,b.encode(t))}getNotificationTypesInactive(){return this.getSetting(J).pipe(u(""),n(s(E)))}saveNotificationTypesInactive(t){return this.saveSetting(J,E.encode(t))}getRolesAndPermissions(){return this.accessInfo$.pipe(a(({Roles:t,Permissions:r})=>[...t,...r]),I(null))}buildSettings(t,r){return{Id:"Cst",Settings:[{Key:t,Value:r}]}}};i.\u0275fac=function(r){return new(r||i)},i.\u0275prov=g({token:i,factory:i.\u0275fac,providedIn:"root"});let e=i;return e})();export{Q as a,Vt as b};
