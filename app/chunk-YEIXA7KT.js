import{f as ce,g as me}from"./chunk-OIT5DRVU.js";import{a as pe}from"./chunk-R4BPAEAZ.js";import{d as K}from"./chunk-JQA5OFWE.js";import{g as Z,h as J,i as se}from"./chunk-SH7F4UJO.js";import{a as N}from"./chunk-IYRTEIDJ.js";import{a as Y}from"./chunk-P6I7Q3DU.js";import{d as le}from"./chunk-LB5PXUW6.js";import{a as O,b as q}from"./chunk-7ATI4WMB.js";import{x as V}from"./chunk-BN47ZUGZ.js";import{$a as p,Aa as g,Ab as S,Ba as a,Bb as C,Cb as v,Ic as re,La as M,Oa as ee,Qc as d,Rb as h,Rc as U,S as F,Sa as b,Sb as x,Tb as j,Va as te,Wc as z,Wd as oe,Xa as ne,_ as D,bd as f,ca as u,cd as R,eb as c,fb as m,ga as X,gb as s,ic as ie,lc as ae,ld as E,m as P,nb as l,p as G,q as T,rb as y,sc as B,uc as w,z as W,zb as r}from"./chunk-RXW5CQPZ.js";var de=z({Email:f(d),Email2:f(d),PhoneBusiness:f(d),CompanyName:R(d),CompanyNameAddition:R(d),Firstname:f(d),Lastname:f(d),AddressLine1:R(d),AddressLine2:R(d),PostalCode:f(d),Location:f(d),Id:U});var ue=(()=>{class t extends O{constructor(){let e=u(w),i=u(E);super(e,i,de,"ApprenticeshipManagers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var he=z({Email:f(d),Email2:f(d),PhoneBusiness:f(d),PhoneMobile:f(d),Firstname:f(d),Lastname:f(d),Id:U});var fe=(()=>{class t extends O{constructor(){let e=u(w),i=u(E);super(e,i,he,"JobTrainers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Q(t,o){let e=+Z(t)-+Z(o);return e<0?-1:e>0?1:e}function ge(t,o,e){let[i,n]=J(e?.in,t,o);return i.getFullYear()-n.getFullYear()}function ye(t,o,e){let[i,n]=J(e?.in,t,o),_=Q(i,n),L=Math.abs(ge(i,n));i.setFullYear(1584),n.setFullYear(1584);let k=Q(i,n)===-_,A=_*(L-+k);return A===0?0:A}var ve=18;function Ce(t){return ye(new Date,t.Birthdate||new Date)>=ve}var wt=(()=>{class t{constructor(){this.studentService=u(ce),this.personsService=u(le),this.apprenticeshipManagersService=u(ue),this.jobTrainersService=u(fe),this.loadingService=u(se),this.dropDownItemsService=u(pe),this.storageService=u(N),this.loading$=this.loadingService.loading$}getProfile(e){return this.loadingService.load(T([this.loadStudent(e),this.loadLegalRepresentatives(e),this.loadApprenticeshipContracts(e)]).pipe(F(K(this.mapToProfile.bind(this)))))}getMyProfile(){let i=(this.storageService.getPayload()?.roles?.split(";")??[]).includes("StudentRole");return this.loadingService.load(this.personsService.getMyself({context:new B().set(Y,{disableErrorHandlingForStatus:[403]})}).pipe(F(n=>T([P(n),i?this.loadLegalRepresentatives(n.Id):P([]),i?this.loadApprenticeshipContracts(n.Id):P([]),this.loadStayPermitValue(n.StayPermit)]))).pipe(F(K(this.mapToProfile.bind(this))),W(V)))}loadStudent(e){return this.studentService.get(e,{context:new B().set(Y,{disableErrorHandlingForStatus:[404]})}).pipe(q())}loadLegalRepresentatives(e){return this.studentService.getLegalRepresentatives(e)}loadApprenticeshipContracts(e){return this.studentService.getCurrentApprenticeshipContracts(e,{context:new B().set(Y,{disableErrorHandlingForStatus:[404]})}).pipe(q([]))}loadStayPermitValue(e){return this.dropDownItemsService.getStayPermits().pipe(G(i=>i.find(n=>n.Key===e)?.Value||null))}mapToProfile(e,i,n,_=null){return e?(i=this.getRelevantLegalRepresentatives(e,i),T([this.loadLegalRepresentativPersons(i),this.loadJobTrainers(n),this.loadApprenticeshipManagers(n)]).pipe(G(([L,k,A])=>this.createProfile(e,_,i,L,n,A,k)))):P(null)}loadLegalRepresentativPersons(e){return e.length===0?P([]):this.personsService.getListForIds(e.map(i=>i.RepresentativeId))}loadJobTrainers(e){let i=e.map(n=>n.JobTrainer).filter(n=>typeof n=="number");return i.length===0?P([]):T(i.map(n=>this.jobTrainersService.get(n)))}loadApprenticeshipManagers(e){let i=e.map(n=>n.ApprenticeshipManagerId);return i.length===0?P([]):T(i.map(n=>this.apprenticeshipManagersService.get(n)))}createProfile(e,i,n,_,L,k,A){return{student:e,stayPermitValue:i||void 0,legalRepresentativePersons:n.map(H=>this.findPerson(H.RepresentativeId,_)).filter(V),apprenticeshipCompanies:L.map(H=>this.createApprenticeshipCompany(H,k,A))}}getRelevantLegalRepresentatives(e,i){let n=Ce(e);return i.filter(_=>!n||_.RepresentativeAfterMajority)}createApprenticeshipCompany(e,i,n){return{apprenticeshipContract:e,jobTrainer:this.findPerson(e.JobTrainer,n),apprenticeshipManager:this.findPerson(e.ApprenticeshipManagerId,i)}}findPerson(e,i){return e&&i.find(n=>n.Id===e)||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=D({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Se(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.student.AddressLine2,"")}}function _e(t,o){if(t&1&&(c(0,"a",0),r(1),m(),s(2,"br")),t&2){let e=l();y("href","tel:",e.student.PhonePrivate,"",g),a(),C(" ",e.student.PhonePrivate," ")}}function be(t,o){if(t&1&&(c(0,"a",0),r(1),m(),s(2,"br")),t&2){let e=l();y("href","tel:",e.student.PhoneMobile,"",g),a(),C(" ",e.student.PhoneMobile," ")}}function Pe(t,o){if(t&1&&(c(0,"a",0),r(1),m()),t&2){let e=l();y("href","mailto:",e.email,"",g),a(),C(" ",e.email," ")}}var zt=(()=>{class t{constructor(){this.emailProperty="DisplayEmail"}get postalCode(){return"PostalCode"in this.student?this.student.PostalCode:this.student.Zip}get email(){return this.emailProperty==="Email2"&&"Email2"in this.student?this.student.Email2||null:this.student.DisplayEmail}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["bkd-student-dossier-address"]],inputs:{student:"student",emailProperty:"emailProperty"},decls:9,vars:7,consts:[[3,"href"]],template:function(i,n){i&1&&(c(0,"address"),r(1),s(2,"br"),b(3,Se,2,1),r(4),s(5,"br"),b(6,_e,3,3)(7,be,3,3)(8,Pe,2,3,"a",0),m()),i&2&&(a(),C(" ",n.student.AddressLine1,""),a(2),p(n.student.AddressLine2?3:-1),a(),v(" ",n.postalCode||""," ",n.student.Location,""),a(2),p(n.student.PhonePrivate?6:-1),a(),p(n.student.PhoneMobile?7:-1),a(),p(n.email?8:-1))},styles:["address[_ngcontent-%COMP%]{padding-left:1rem}"],changeDetection:0})}}return t})();var $=(()=>{class t{transform(e){return e?.DisplayEmail||e?.Email||e?.Email2||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=ee({name:"bkdPersonEmail",type:t,pure:!0})}}return t})();function Me(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.CompanyName,"")}}function Ie(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.CompanyNameAddition,"")}}function Ae(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();v(" ",(e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.Lastname)||""," ",(e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.Firstname)||"","")}}function Te(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.AddressLine1,"")}}function De(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.AddressLine2,"")}}function Ee(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();v(" ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.PostalCode," ",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.Location,"")}}function Le(t,o){if(t&1&&(c(0,"a",0),r(1),s(2,"br"),m()),t&2){let e=l();y("href","tel:",e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.PhoneBusiness,"",g),a(),S(e.company.apprenticeshipManager==null?null:e.company.apprenticeshipManager.PhoneBusiness)}}function ke(t,o){if(t&1&&(c(0,"a",0),h(1,"bkdPersonEmail"),r(2),h(3,"bkdPersonEmail"),m()),t&2){let e=l();y("href","mailto:",x(1,3,e.company.apprenticeshipManager),"",g),a(2),S(x(3,5,e.company.apprenticeshipManager))}}function je(t,o){if(t&1&&(c(0,"div",1),r(1),h(2,"translate"),h(3,"addSpace"),s(4,"br"),r(5),h(6,"date"),h(7,"date"),m()),t&2){let e=l();a(),v(" ",x(2,4,"shared.profile.apprenticeship-period"),"",j(3,6,":",":"),""),a(4),v(" ",j(6,9,e.company.apprenticeshipContract.ContractDateFrom,"dd.MM.yyyy"),"\u2013",j(7,12,e.company.apprenticeshipContract.ContractDateTo,"dd.MM.yyyy")," ")}}function Re(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l(2);v(" ",e.company.jobTrainer.Lastname||""," ",e.company.jobTrainer.Firstname||"","")}}function Fe(t,o){if(t&1&&(c(0,"a",0),r(1),s(2,"br"),m()),t&2){let e=l(2);y("href","tel:",e.company.jobTrainer.PhoneBusiness,"",g),a(),S(e.company.jobTrainer.PhoneBusiness)}}function Be(t,o){if(t&1&&(c(0,"a",0),r(1),s(2,"br"),m()),t&2){let e=l(2);y("href","tel:",e.company.jobTrainer.PhoneMobile,"",g),a(),S(e.company.jobTrainer.PhoneMobile)}}function we(t,o){if(t&1&&(c(0,"a",0),h(1,"bkdPersonEmail"),r(2),h(3,"bkdPersonEmail"),m()),t&2){let e=l(2);y("href","mailto:",x(1,3,e.company.jobTrainer),"",g),a(2),S(x(3,5,e.company.jobTrainer))}}function Ue(t,o){if(t&1&&(c(0,"div",1),r(1),h(2,"translate"),h(3,"addSpace"),c(4,"address"),b(5,Re,2,2)(6,Fe,3,3,"a",0)(7,Be,3,3,"a",0)(8,we,4,7,"a",0),h(9,"bkdPersonEmail"),m()()),t&2){let e=l();a(),v(" ",x(2,6,"shared.profile.job-trainer"),"",j(3,8,":",":")," "),a(4),p(e.company.jobTrainer.Lastname||e.company.jobTrainer.Firstname?5:-1),a(),p(e.company.jobTrainer.PhoneBusiness?6:-1),a(),p(e.company.jobTrainer.PhoneMobile?7:-1),a(),p(x(9,11,e.company.jobTrainer)?8:-1)}}var Gt=(()=>{class t{constructor(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["bkd-student-dossier-apprenticeship-company"]],inputs:{company:"company"},decls:12,vars:12,consts:[[3,"href"],[1,"subentry"]],template:function(i,n){i&1&&(c(0,"address"),b(1,Me,2,1)(2,Ie,2,1)(3,Ae,2,2)(4,Te,2,1)(5,De,2,1)(6,Ee,2,2)(7,Le,3,3,"a",0)(8,ke,4,7,"a",0),h(9,"bkdPersonEmail"),m(),b(10,je,8,15,"div",1)(11,Ue,10,13,"div",1)),i&2&&(a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.CompanyName?1:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.CompanyNameAddition?2:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.Lastname||n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.Firstname?3:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.AddressLine1?4:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.AddressLine2?5:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.PostalCode&&(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.Location)?6:-1),a(),p(n.company.apprenticeshipManager!=null&&n.company.apprenticeshipManager.PhoneBusiness?7:-1),a(),p(x(9,10,n.company.apprenticeshipManager)?8:-1),a(2),p(n.company.apprenticeshipContract.ContractDateFrom?10:-1),a(),p(n.company.jobTrainer?11:-1))},dependencies:[ae,oe,me,$],styles:[".subentry[_ngcontent-%COMP%]{padding-bottom:1rem}"],changeDetection:0})}}return t})();function ze(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.person.AddressLine1,"")}}function Ne(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();C(" ",e.person.AddressLine2,"")}}function Oe(t,o){if(t&1&&(r(0),s(1,"br")),t&2){let e=l();v(" ",e.person.Zip," ",e.person.Location,"")}}function Je(t,o){if(t&1&&(c(0,"a",0),r(1),s(2,"br"),m()),t&2){let e=l();y("href","tel:",e.person.PhonePrivate,"",g),a(),S(e.person.PhonePrivate)}}function Ye(t,o){if(t&1&&(c(0,"a",0),r(1),s(2,"br"),m()),t&2){let e=l();y("href","tel:",e.person.PhoneMobile,"",g),a(),S(e.person.PhoneMobile)}}function $e(t,o){if(t&1&&(c(0,"a",0),h(1,"bkdPersonEmail"),r(2),h(3,"bkdPersonEmail"),m()),t&2){let e=l();y("href","mailto:",x(1,3,e.person),"",g),a(2),S(x(3,5,e.person))}}var qt=(()=>{class t{constructor(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["bkd-student-dossier-legal-representative"]],inputs:{person:"person"},decls:10,vars:10,consts:[[3,"href"]],template:function(i,n){i&1&&(c(0,"address"),r(1),s(2,"br"),b(3,ze,2,1)(4,Ne,2,1)(5,Oe,2,2)(6,Je,3,3,"a",0)(7,Ye,3,3,"a",0)(8,$e,4,7,"a",0),h(9,"bkdPersonEmail"),m()),i&2&&(a(),v(" ",n.person.LastName," ",n.person.FirstName,""),a(2),p(n.person.AddressLine1?3:-1),a(),p(n.person.AddressLine2?4:-1),a(),p(n.person.Zip&&n.person.Zip?5:-1),a(),p(n.person.PhonePrivate?6:-1),a(),p(n.person.PhoneMobile?7:-1),a(),p(x(9,8,n.person)?8:-1))},dependencies:[$],encapsulation:2,changeDetection:0})}}return t})();var rn=(()=>{class t{constructor(){this.settings=u(E),this.storageService=u(N),this.avatarStyles={}}ngOnChanges(e){e.studentId&&(this.avatarStyles=this.buildAvatarStyles(this.studentId))}buildAvatarStyles(e){return{"background-image":[this.buildAvatarUrl(e),this.fallbackAvatarUrl].map(i=>`url(${i})`).join(", ")}}buildAvatarUrl(e){let i=this.storageService.getAccessToken()||"";return`${this.settings.apiUrl}/Files/personPictures/${e}?token=${i}`}get fallbackAvatarUrl(){return`${this.settings.scriptsAndAssetsPath}/assets/images/avatar-placeholder.png`}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=M({type:t,selectors:[["bkd-avatar"]],inputs:{studentId:"studentId",link:"link",linkParams:"linkParams"},features:[X],decls:1,vars:5,consts:[[1,"avatar",3,"routerLink","queryParams","ngStyle"]],template:function(i,n){i&1&&s(0,"a",0),i&2&&(ne("disabled",!n.link),te("routerLink",n.link)("queryParams",n.linkParams)("ngStyle",n.avatarStyles))},dependencies:[re,ie],styles:["[_nghost-%COMP%]{display:flex}.small[_nghost-%COMP%]{width:40px;min-width:40px;height:50px}.medium[_nghost-%COMP%]{width:58px;min-width:58px;height:75px}.large[_nghost-%COMP%]{width:100px;min-width:100px;height:130px}.avatar[_ngcontent-%COMP%]{flex:1;border:1px solid rgba(0,0,0,.25);background-repeat:no-repeat;background-size:cover;background-position:center}a.disabled[_ngcontent-%COMP%]{pointer-events:none;cursor:default}"]})}}return t})();export{wt as a,zt as b,Gt as c,qt as d,rn as e};
