import{l as q,m as U,n as z,s as J}from"./chunk-HMAHRXLK.js";import{i as V}from"./chunk-XWISOVKN.js";import{e as O,f as N}from"./chunk-6LRQCBUO.js";import"./chunk-Y4QYVF5K.js";import"./chunk-JE6RMKPQ.js";import"./chunk-RXV77OBQ.js";import"./chunk-M3VKTN3S.js";import{a as A}from"./chunk-USF5QQBL.js";import{b as Y}from"./chunk-S6U5TJNW.js";import"./chunk-GXPB5I4C.js";import"./chunk-D2H555EG.js";import{i as H}from"./chunk-QWYAXZZX.js";import"./chunk-KKDVS2NL.js";import"./chunk-WNZFLLQC.js";import"./chunk-DVBPCEX4.js";import{b as I,h as b}from"./chunk-DQAQYQ7K.js";import{A as j,s as P}from"./chunk-RYYQAFJB.js";import{Ac as g,Bc as v,Cc as y,F as k,Fc as C,Gc as B,Hb as L,Ib as T,Jb as D,Lc as o,Mc as n,Ob as f,Pb as u,Qb as m,Rb as p,X as _,_ as R,dc as E,fb as d,ha as F,j as w,je as G,ma as r,rc as S,sc as h,t as a,td as $,u as M,ub as c}from"./chunk-CHBP6U4G.js";var l=(()=>{class t{constructor(){this.storageService=r(A),this.loadingService=r(O),this.coursesRestService=r(q),this.subscriptionRestService=r(Y),this.reportsService=r(V),this.gradingScalesRestService=r(U),this.settings=r(j),this.studentId$=new w(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(_(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(a(e=>e.slice().sort((i,Z)=>i.Designation.localeCompare(Z.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Id))),this.subscriptionIds$=M([this.studentId$,this.studentCourseIds$]).pipe(k(([e,i])=>i.length>0),R(([e,i])=>this.subscriptionRestService.getSubscriptionIdsByStudentAndCourse(e,i))),this.testReports$=this.subscriptionIds$.pipe(a(e=>this.reportsService.getStudentSubscriptionGradesReports(e))),this.tests$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Tests).filter(I))),this.gradingScaleIdsFromTests$=this.tests$.pipe(a(e=>[...e.map(i=>i.GradingScaleId)].filter(I).filter(b))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.GradingScaleId).filter(I).filter(b))),this.gradingScaleIds$=M([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe(a(([e,i])=>e.concat(i).filter(b))),this.gradingScales$=this.gradingScaleIds$.pipe(R(e=>this.gradingScalesRestService.getListForIds(e)));let s=this.storageService.getPayload()?.id_person;s&&this.studentId$.next(Number(s))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=F({token:t,factory:t.\u0275fac})}}return t})();var ee=()=>[],K=(()=>{class t{constructor(){this.myGradesService=r(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-header"]],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(e,i){e&1&&(u(0,"div",0)(1,"div"),S(2),o(3,"translate"),m(),u(4,"div"),p(5,"bkd-reports-link",1),o(6,"async"),m()()),e&2&&(d(2),h(n(3,2,"my-grades.header")),d(3),f("reports",n(6,4,i.myGradesService.testReports$)??B(6,ee)))},dependencies:[N,$,G],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return t})();function te(t,X){t&1&&p(0,"bkd-spinner")}function ie(t,X){if(t&1&&p(0,"bkd-dossier-grades-view",1),t&2){E();let s=y(0),e=y(2),i=y(4);f("courses",s)("studentId",e)("gradingScales",i)("isEditable",!1)}}var Q=(()=>{class t{constructor(){this.myGradesService=r(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-show"]],features:[C([z])],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(e,i){e&1&&(g(0),o(1,"async"),g(2),o(3,"async"),g(4),o(5,"async"),u(6,"div",0)(7,"h1"),S(8),o(9,"translate"),m(),p(10,"bkd-my-grades-header"),L(11,te,1,0,"bkd-spinner"),o(12,"async"),T(13,ie,1,4,"bkd-dossier-grades-view",1),m()),e&2&&(v(n(1,2,i.myGradesService.studentCoursesSorted$)),d(2),v(n(3,5,i.myGradesService.studentId$)),d(2),v(n(5,8,i.myGradesService.gradingScales$)),d(4),h(n(9,11,"my-grades.title")),d(3),D(n(12,13,i.myGradesService.loading$)?11:13))},dependencies:[K,J,H,$,G],encapsulation:2})}}return t})();var W=(()=>{class t{constructor(){}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades"]],features:[C([l])],decls:1,vars:0,template:function(e,i){e&1&&p(0,"router-outlet")},dependencies:[P],encapsulation:2})}}return t})();var Pe=[{path:"",component:W,children:[{path:"",component:Q}]}];export{Pe as MY_GRADES_ROUTES};
