import{l as N,m as q,n as Y,s as z}from"./chunk-DHMHYNJ6.js";import{d as U}from"./chunk-R5MHC4WA.js";import{a as A,b as O}from"./chunk-6IL6P7CV.js";import"./chunk-Y4QYVF5K.js";import"./chunk-VPK5QO7U.js";import"./chunk-2QS7YZBA.js";import{a as j}from"./chunk-C32G5SWR.js";import{a as V}from"./chunk-ODFAZZFF.js";import"./chunk-KG7WGTAP.js";import{i as H}from"./chunk-H3RI53QQ.js";import"./chunk-ZELJT2WS.js";import"./chunk-KOTWO6JI.js";import"./chunk-Q6TACXIT.js";import{b,h as M}from"./chunk-DQAQYQ7K.js";import{r as P,z as B}from"./chunk-LGTM5FIB.js";import{Ab as w,Cc as o,Dc as n,Gb as S,Mb as T,Rb as f,Sb as m,Tb as p,_ as F,_b as D,ba as x,dd as G,hb as d,ja as L,kc as h,l as k,lc as g,pa as r,tc as v,ub as c,uc as y,v as a,vc as C,ve as I,w as R,wc as $,xc as E}from"./chunk-GUP4UHKK.js";var l=(()=>{class t{constructor(){this.storageService=r(j),this.loadingService=r(A),this.coursesRestService=r(N),this.subscriptionRestService=r(V),this.reportsService=r(U),this.gradingScalesRestService=r(q),this.settings=r(B),this.studentId$=new k(1),this.loading$=this.loadingService.loading$,this.studentCourses$=this.loadCourses().pipe(F(1)),this.studentCoursesSorted$=this.studentCourses$.pipe(a(e=>e.slice().sort((i,u)=>i.Designation.localeCompare(u.Designation)))),this.studentCourseIds$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Id))),this.subscriptionIds$=R([this.studentId$,this.studentCourseIds$]).pipe(x(([e,i])=>this.subscriptionRestService.getSubscriptionIdsByStudentAndCourse(e,i))),this.testReports$=this.subscriptionIds$.pipe(a(e=>this.reportsService.getStudentSubscriptionGradesReports(e))),this.tests$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.Tests).filter(b))),this.gradingScaleIdsFromTests$=this.tests$.pipe(a(e=>[...e.map(i=>i.GradingScaleId)].filter(b).filter(M))),this.gradingScaleIdsFromCourses$=this.studentCourses$.pipe(a(e=>e.flatMap(i=>i.GradingScaleId).filter(b).filter(M))),this.gradingScaleIds$=R([this.gradingScaleIdsFromCourses$,this.gradingScaleIdsFromTests$]).pipe(a(([e,i])=>e.concat(i).filter(M))),this.gradingScales$=this.gradingScaleIds$.pipe(x(e=>this.gradingScalesRestService.getListForIds(e)));let s=this.storageService.getPayload()?.id_person;s&&this.studentId$.next(Number(s))}loadCourses(){return this.loadingService.load(this.coursesRestService.getExpandedCoursesForStudent())}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275prov=L({token:t,factory:t.\u0275fac})}}return t})();var X=()=>[],J=(()=>{class t{constructor(){this.myGradesService=r(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-header"]],decls:7,vars:7,consts:[[1,"d-flex","justify-content-between","header"],[3,"reports"]],template:function(e,i){if(e&1&&(f(0,"div",0)(1,"div"),h(2),o(3,"translate"),m(),f(4,"div"),p(5,"bkd-reports-link",1),o(6,"async"),m()()),e&2){let u;d(2),g(n(3,2,"my-grades.header")),d(3),S("reports",(u=n(6,4,i.myGradesService.testReports$))!==null&&u!==void 0?u:E(6,X))}},dependencies:[O,G,I],styles:[".header[_ngcontent-%COMP%]{padding-bottom:1rem}.report[_ngcontent-%COMP%]{margin-left:1rem}"]})}}return t})();function Z(t,W){t&1&&p(0,"bkd-spinner")}function ee(t,W){if(t&1&&p(0,"bkd-dossier-grades-view",1),t&2){D();let s=C(0),e=C(2),i=C(4);S("courses",s)("studentId",e)("gradingScales",i)("isEditable",!1)}}var K=(()=>{class t{constructor(){this.myGradesService=r(l)}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades-show"]],features:[$([Y])],decls:14,vars:15,consts:[[1,"bkd-container","bkd-container-limited"],[3,"courses","studentId","gradingScales","isEditable"]],template:function(e,i){e&1&&(v(0),o(1,"async"),v(2),o(3,"async"),v(4),o(5,"async"),f(6,"div",0)(7,"h1"),h(8),o(9,"translate"),m(),p(10,"bkd-my-grades-header"),w(11,Z,1,0,"bkd-spinner"),o(12,"async"),w(13,ee,1,4,"bkd-dossier-grades-view",1),m()),e&2&&(y(n(1,2,i.myGradesService.studentCoursesSorted$)),d(2),y(n(3,5,i.myGradesService.studentId$)),d(2),y(n(5,8,i.myGradesService.gradingScales$)),d(4),g(n(9,11,"my-grades.title")),d(3),T(n(12,13,i.myGradesService.loading$)?11:13))},dependencies:[J,z,H,G,I],encapsulation:2})}}return t})();var Q=(()=>{class t{constructor(){}static{this.\u0275fac=function(e){return new(e||t)}}static{this.\u0275cmp=c({type:t,selectors:[["bkd-my-grades"]],features:[$([l])],decls:1,vars:0,template:function(e,i){e&1&&p(0,"router-outlet")},dependencies:[P],encapsulation:2})}}return t})();var Ee=[{path:"",component:Q,children:[{path:"",component:K}]}];export{Ee as MY_GRADES_ROUTES};
