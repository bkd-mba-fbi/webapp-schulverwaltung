import{f as se,g as de}from"./chunk-RDNZARDR.js";import{a as oe}from"./chunk-C4EQUSNO.js";import{e as pe}from"./chunk-6LRQCBUO.js";import{j as V,k as $}from"./chunk-RXV77OBQ.js";import{a as ne}from"./chunk-USF5QQBL.js";import{b as w}from"./chunk-KZWEGXU2.js";import{d as ae}from"./chunk-KFP6476W.js";import{a as X,b as k}from"./chunk-QWYAXZZX.js";import{b as re}from"./chunk-GH7I4V3C.js";import{A as M,e as O,i as T}from"./chunk-RYYQAFJB.js";import{$d as x,Ac as ee,Bc as G,Cc as C,Ec as E,Hb as s,Jb as p,Lc as h,Mc as S,Md as u,Nc as F,Nd as Y,Sb as c,Sc as q,Sd as H,Tb as m,Ub as l,Wc as B,_ as N,ac as _,ae as U,cb as g,dc as d,fb as o,ha as y,je as ie,ma as f,o as j,rc as a,sc as D,t as I,tc as v,u as z,ub as L,uc as P,ud as te,xb as W}from"./chunk-CHBP6U4G.js";function Pe(t,r){if(t&1&&(a(0),l(1,"br")),t&2){let e=d();v(" ",e.student().AddressLine2)}}function be(t,r){if(t&1&&(c(0,"a",0),a(1),m(),l(2,"br")),t&2){let e=d();_("href",E("tel:",e.student().PhonePrivate),g),o(),v(" ",e.student().PhonePrivate," ")}}function De(t,r){if(t&1&&(c(0,"a",0),a(1),m(),l(2,"br")),t&2){let e=d();_("href",E("tel:",e.student().PhoneMobile),g),o(),v(" ",e.student().PhoneMobile," ")}}function ye(t,r){if(t&1&&(c(0,"a",0),a(1),m()),t&2){let e=d();_("href",E("mailto:",e.email()),g),o(),v(" ",e.email()," ")}}var We=(()=>{class t{constructor(){this.student=B.required(),this.emailProperty=B("DisplayEmail"),this.postalCode=q(()=>{let e=this.student();return"PostalCode"in e?e.PostalCode:e.Zip}),this.email=q(()=>{let e=this.student();return this.emailProperty()==="Email2"&&"Email2"in e?e.Email2||null:e.DisplayEmail})}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=L({type:t,selectors:[["bkd-student-dossier-address"]],inputs:{student:[1,"student"],emailProperty:[1,"emailProperty"]},decls:9,vars:7,consts:[[3,"href"]],template:function(i,n){i&1&&(c(0,"address"),a(1),l(2,"br"),s(3,Pe,2,1),a(4),l(5,"br"),s(6,be,3,3),s(7,De,3,3),s(8,ye,2,3,"a",0),m()),i&2&&(o(),v(" ",n.student().AddressLine1),o(2),p(n.student().AddressLine2?3:-1),o(),P(" ",n.postalCode()||""," ",n.student().Location),o(2),p(n.student().PhonePrivate?6:-1),o(),p(n.student().PhoneMobile?7:-1),o(),p(n.email()?8:-1))},styles:["address[_ngcontent-%COMP%]{padding-left:1rem}"],changeDetection:0})}}return t})();var J=(()=>{class t{transform(e){return e?.DisplayEmail||e?.Email||e?.Email2||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275pipe=W({name:"bkdPersonEmail",type:t,pure:!0})}}return t})();function Ae(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);v(" ",e.CompanyName)}}function Ie(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);v(" ",e.CompanyNameAddition)}}function Le(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);P(" ",e.Lastname||""," ",e.Firstname||"")}}function Te(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);v(" ",e.AddressLine1)}}function Me(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);v(" ",e.AddressLine2)}}function Re(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(0);P(" ",e.PostalCode," ",e.Location)}}function Ne(t,r){if(t&1&&(c(0,"a",1),a(1),l(2,"br"),m()),t&2){d(2);let e=C(0);_("href",E("tel:",e.PhoneBusiness),g),o(),D(e.PhoneBusiness)}}function Fe(t,r){if(t&1&&(c(0,"a",1),h(1,"bkdPersonEmail"),a(2),h(3,"bkdPersonEmail"),m()),t&2){d(2);let e=C(0);_("href",E("mailto:",S(1,3,e)),g),o(2),D(S(3,5,e))}}function Be(t,r){if(t&1&&(c(0,"address"),s(1,Ae,2,1),s(2,Ie,2,1),s(3,Le,2,2),s(4,Te,2,1),s(5,Me,2,1),s(6,Re,2,2),s(7,Ne,3,3,"a",1),s(8,Fe,4,7,"a",1),h(9,"bkdPersonEmail"),m()),t&2){d();let e=C(0);o(),p(e.CompanyName?1:-1),o(),p(e.CompanyNameAddition?2:-1),o(),p(e.Lastname||e.Firstname?3:-1),o(),p(e.AddressLine1?4:-1),o(),p(e.AddressLine2?5:-1),o(),p(e.PostalCode&&e.Location?6:-1),o(),p(e.PhoneBusiness?7:-1),o(),p(S(9,8,e)?8:-1)}}function Oe(t,r){if(t&1&&(c(0,"div",0),a(1),h(2,"translate"),h(3,"addSpace"),l(4,"br"),a(5),h(6,"date"),h(7,"date"),m()),t&2){d();let e=C(1);o(),P(" ",S(2,4,"shared.profile.apprenticeship-period"),"",F(3,6,":",":")),o(4),P(" ",F(6,9,e.ContractDateFrom,"dd.MM.yyyy"),"\u2013",F(7,12,e.ContractDateTo,"dd.MM.yyyy")," ")}}function Ue(t,r){if(t&1&&(a(0),l(1,"br")),t&2){d(2);let e=C(2);P(" ",e.Lastname||""," ",e.Firstname||"")}}function ke(t,r){if(t&1&&(c(0,"a",1),a(1),l(2,"br"),m()),t&2){d(2);let e=C(2);_("href",E("tel:",e.PhoneBusiness),g),o(),D(e.PhoneBusiness)}}function we(t,r){if(t&1&&(c(0,"a",1),a(1),l(2,"br"),m()),t&2){d(2);let e=C(2);_("href",E("tel:",e.PhoneMobile),g),o(),D(e.PhoneMobile)}}function je(t,r){if(t&1&&(c(0,"a",1),h(1,"bkdPersonEmail"),a(2),h(3,"bkdPersonEmail"),m()),t&2){d(2);let e=C(2);_("href",E("mailto:",S(1,3,e)),g),o(2),D(S(3,5,e))}}function ze(t,r){if(t&1&&(c(0,"div",0),a(1),h(2,"translate"),h(3,"addSpace"),c(4,"address"),s(5,Ue,2,2),s(6,ke,3,3,"a",1),s(7,we,3,3,"a",1),s(8,je,4,7,"a",1),h(9,"bkdPersonEmail"),m()()),t&2){d();let e=C(2);o(),P(" ",S(2,6,"shared.profile.job-trainer"),"",F(3,8,":",":")," "),o(4),p(e.Lastname||e.Firstname?5:-1),o(),p(e.PhoneBusiness?6:-1),o(),p(e.PhoneMobile?7:-1),o(),p(S(9,11,e)?8:-1)}}var dt=(()=>{class t{constructor(){this.apprenticeship=B.required()}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=L({type:t,selectors:[["bkd-student-dossier-apprenticeship"]],inputs:{apprenticeship:[1,"apprenticeship"]},decls:6,vars:6,consts:[[1,"subentry"],[3,"href"]],template:function(i,n){if(i&1&&(ee(0)(1)(2),s(3,Be,10,10,"address"),s(4,Oe,8,15,"div",0),s(5,ze,10,13,"div",0)),i&2){let b=G(n.apprenticeship().apprenticeshipManager);o();let R=G(n.apprenticeship().apprenticeshipContract);o();let Z=G(n.apprenticeship().jobTrainer);o(),p(b?3:-1),o(),p(R.ContractDateFrom?4:-1),o(),p(Z?5:-1)}},dependencies:[te,ie,de,J],styles:[".subentry[_ngcontent-%COMP%]{padding-bottom:1rem}"],changeDetection:0})}}return t})();function Ge(t,r){if(t&1&&(a(0),l(1,"br")),t&2){let e=d();v(" ",e.person.AddressLine1)}}function Ye(t,r){if(t&1&&(a(0),l(1,"br")),t&2){let e=d();v(" ",e.person.AddressLine2)}}function He(t,r){if(t&1&&(a(0),l(1,"br")),t&2){let e=d();P(" ",e.person.Zip," ",e.person.Location)}}function Xe(t,r){if(t&1&&(c(0,"a",0),a(1),l(2,"br"),m()),t&2){let e=d();_("href",E("tel:",e.person.PhonePrivate),g),o(),D(e.person.PhonePrivate)}}function $e(t,r){if(t&1&&(c(0,"a",0),a(1),l(2,"br"),m()),t&2){let e=d();_("href",E("tel:",e.person.PhoneMobile),g),o(),D(e.person.PhoneMobile)}}function Je(t,r){if(t&1&&(c(0,"a",0),h(1,"bkdPersonEmail"),a(2),h(3,"bkdPersonEmail"),m()),t&2){let e=d();_("href",E("mailto:",S(1,3,e.person)),g),o(2),D(S(3,5,e.person))}}var mt=(()=>{class t{constructor(){}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275cmp=L({type:t,selectors:[["bkd-student-dossier-legal-representative"]],inputs:{person:"person"},decls:10,vars:10,consts:[[3,"href"]],template:function(i,n){i&1&&(c(0,"address"),a(1),l(2,"br"),s(3,Ge,2,1),s(4,Ye,2,1),s(5,He,2,2),s(6,Xe,3,3,"a",0),s(7,$e,3,3,"a",0),s(8,Je,4,7,"a",0),h(9,"bkdPersonEmail"),m()),i&2&&(o(),P(" ",n.person.LastName," ",n.person.FirstName),o(2),p(n.person.AddressLine1?3:-1),o(),p(n.person.AddressLine2?4:-1),o(),p(n.person.Zip&&n.person.Zip?5:-1),o(),p(n.person.PhonePrivate?6:-1),o(),p(n.person.PhoneMobile?7:-1),o(),p(S(9,8,n.person)?8:-1))},dependencies:[J],encapsulation:2,changeDetection:0})}}return t})();var le=H({Email:x(u),Email2:x(u),PhoneBusiness:x(u),CompanyName:U(u),CompanyNameAddition:U(u),Firstname:x(u),Lastname:x(u),AddressLine1:U(u),AddressLine2:U(u),PostalCode:x(u),Location:x(u),Id:Y});var ce=(()=>{class t extends X{constructor(){let e=f(T),i=f(M);super(e,i,le,"ApprenticeshipManagers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();var me=H({Email:x(u),Email2:x(u),PhoneBusiness:x(u),PhoneMobile:x(u),Firstname:x(u),Lastname:x(u),Id:Y});var ue=(()=>{class t extends X{constructor(){let e=f(T),i=f(M);super(e,i,me,"JobTrainers")}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function K(t,r){let e=+V(t)-+V(r);return e<0?-1:e>0?1:e}function fe(t,r,e){let[i,n]=$(e?.in,t,r);return i.getFullYear()-n.getFullYear()}function he(t,r,e){let[i,n]=$(e?.in,t,r),b=K(i,n),R=Math.abs(fe(i,n));i.setFullYear(1584),n.setFullYear(1584);let Z=K(i,n)===-b,Q=b*(R-+Z);return Q===0?0:Q}var qe=18;function Ce(t){return he(new Date,t.Birthdate||new Date)>=qe}var xe="dossier-myself",ge="dossier-student",_e="dossier-legal-reps",ve="dossier-apprenticeships",Ee="dossier-stay-permit",ni=(()=>{class t{constructor(){this.studentService=f(se),this.personsService=f(ae),this.apprenticeshipManagersService=f(ce),this.jobTrainersService=f(ue),this.dropDownItemsService=f(oe),this.loadingService=f(pe),this.IGNORE_404_CONTEXT=new O().set(w,{disableErrorHandlingForStatus:[404]}),this.loadingStudent$=this.loadingService.loading(ge),this.loadingMyself$=this.loadingService.loading(xe),this.loadingLegalRepresentatives$=this.loadingService.loading(_e),this.loadingApprenticeships$=this.loadingService.loading(ve),this.loadingStayPermit$=this.loadingService.loading(Ee)}getStudent(e){return this.loadingService.load(this.personsService.get(e,{context:this.IGNORE_404_CONTEXT}).pipe(I(i=>this.createStudentFromPerson(i)),k()),ge)}createStudentFromPerson(e){return{Id:e.Id,AddressLine1:e.AddressLine1,AddressLine2:e.AddressLine2,Birthdate:e.Birthdate,DisplayEmail:e.DisplayEmail,FirstName:e.FirstName??"",FullName:e.FullName??"",Gender:e.Gender??"X",LastName:e.LastName??"",Location:e.Location,PhoneMobile:e.PhoneMobile,PhonePrivate:e.PhonePrivate,PostalCode:e.Zip}}getMyself(){return this.loadingService.load(this.personsService.getMyself({context:new O().set(w,{disableErrorHandlingForStatus:[403]})}),xe)}getLegalRepresentatives(e){return this.loadingService.load(this.loadLegalRepresentatives(e).pipe(N(i=>this.loadLegalRepresentativePersons(i).pipe(I(n=>i.map(b=>this.findPerson(b.RepresentativeId,n)).filter(re))))),_e)}getApprenticeships(e){return this.loadingService.load(this.loadApprenticeshipContracts(e).pipe(N(i=>z([this.loadApprenticeshipManagers(i),this.loadJobTrainers(i)]).pipe(I(([n,b])=>i.map(R=>this.createApprenticeshipCompany(R,n,b)))))),ve)}getStayPermitValue(e){return this.loadingService.load(this.dropDownItemsService.getStayPermits().pipe(I(i=>i.find(n=>n.Key===e)?.Value||null)),Ee)}loadLegalRepresentatives(e){return this.studentService.getLegalRepresentatives(e.Id).pipe(I(i=>{let n=Ce(e);return i.filter(b=>!n||b.RepresentativeAfterMajority)}))}loadLegalRepresentativePersons(e){return e.length===0?j([]):this.personsService.getListForIds(e.map(i=>i.RepresentativeId))}loadApprenticeshipContracts(e){return this.studentService.getCurrentApprenticeshipContracts(e,{context:this.IGNORE_404_CONTEXT}).pipe(k([]))}loadJobTrainers(e){let i=e.map(n=>n.JobTrainer).filter(n=>typeof n=="number");return i.length===0?j([]):z(i.map(n=>this.jobTrainersService.get(n)))}loadApprenticeshipManagers(e){let i=e.map(n=>n.ApprenticeshipManagerId);return i.length===0?j([]):z(i.map(n=>this.apprenticeshipManagersService.get(n)))}createApprenticeshipCompany(e,i,n){return{apprenticeshipContract:e,jobTrainer:this.findPerson(e.JobTrainer,n),apprenticeshipManager:this.findPerson(e.ApprenticeshipManagerId,i)}}findPerson(e,i){return e&&i.find(n=>n.Id===e)||null}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();function Se(t){return new Promise((r,e)=>{let i=new FileReader;i.onloadend=()=>{r(i.result)},i.onerror=e,i.readAsDataURL(t)})}var hi=(()=>{class t{constructor(){this.settings=f(M),this.storageService=f(ne),this.http=f(T)}getAvatarUrl(e){let i=this.storageService.getAccessToken()||"";return`${this.settings.apiUrl}/Files/personPictures/${e}?token=${i}`}getAvatarPlaceholderUrl(){return`${this.settings.scriptsAndAssetsPath}/assets/images/avatar-placeholder.png`}loadAvatarDataUri(e){let i=new O().set(w,{disableErrorHandlingForStatus:[404]});return this.http.get(this.getAvatarUrl(e),{context:i,responseType:"blob"}).pipe(N(Se),k(null))}static{this.\u0275fac=function(i){return new(i||t)}}static{this.\u0275prov=y({token:t,factory:t.\u0275fac,providedIn:"root"})}}return t})();export{ni as a,We as b,dt as c,mt as d,hi as e};
