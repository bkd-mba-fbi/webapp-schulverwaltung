import{c as Ve}from"./chunk-Y77VRHQG.js";import{b as Q}from"./chunk-NTSKCSYH.js";import{a as He}from"./chunk-DYBK5FKC.js";import{a as Ue}from"./chunk-LO6577BN.js";import"./chunk-LZK2LD3F.js";import{p as Ne}from"./chunk-LLGOVPQJ.js";import"./chunk-2H6IFZM2.js";import{e as Z}from"./chunk-P7Z5652Z.js";import{b as Fe}from"./chunk-7FRZV7VF.js";import"./chunk-Y4QYVF5K.js";import"./chunk-OFB4XAK2.js";import{c as z,d as ze}from"./chunk-TKH5QF5L.js";import"./chunk-WACRWBCS.js";import"./chunk-MIRGHONI.js";import"./chunk-YUHFF3NM.js";import{L as Be,b as Re,g as se,p as Le,q as we}from"./chunk-H6G6Q6V6.js";import"./chunk-NL5E3FC5.js";import"./chunk-YD3RJIHU.js";import{a as je,b as J}from"./chunk-KK2SHN2W.js";import{u as Oe}from"./chunk-AP373D4K.js";import"./chunk-B6WYZ7BT.js";import{$a as ne,Ab as y,Bb as j,Cc as ke,Dc as Ie,Gb as a,Ha as l,Hb as o,Ib as E,Ic as Ae,Jd as M,Kb as Se,Kd as k,La as ie,Ld as Ee,M as x,Ma as u,Na as be,O as le,P,Ra as p,S as pe,Ua as ue,Va as fe,Wa as d,X as q,Xa as r,Ya as f,Yb as xe,Yc as R,Zb as O,_ as $,_b as Y,aa as v,ab as _e,cb as F,d as de,da as me,db as h,eb as Ce,fb as ge,g as te,gc as Te,h as ce,ia as K,ja as W,ka as he,l as L,lc as De,mb as ae,n as b,nb as m,o as H,ob as T,pb as S,qb as oe,rb as ve,sc as Pe,tc as $e,uc as Me,va as w,wa as n,wb as B,xa as g,xb as V,yb as G,zb as ye}from"./chunk-IFJN5CDK.js";var at=["*"];function ot(e,c){e&1&&ne(0)}function st(e,c){if(e&1&&(d(0,"a",1),l(1,ot,1,0,"ng-container",3),r()),e&2){let t=h(),i=ae(3);u("routerLink",t.link)("queryParams",t.linkParams),n(),u("ngTemplateOutlet",i)}}function rt(e,c){e&1&&ne(0)}function dt(e,c){if(e&1&&(d(0,"a",2),l(1,rt,1,0,"ng-container",3),r()),e&2){let t=h(),i=ae(3);u("href",t.externalLink,w),n(),u("ngTemplateOutlet",i)}}function ct(e,c){if(e&1&&(d(0,"span",5),m(1),r()),e&2){let t=h(2);n(),T(t.count)}}function lt(e,c){e&1&&(he(),d(0,"svg",6),f(1,"path",7),r())}function pt(e,c){if(e&1&&(d(0,"span",4),m(1),a(2,"translate"),r(),d(3,"div"),ge(4),l(5,ct,2,1,"span",5)(6,lt,2,0,":svg:svg",6),r()),e&2){let t=h();n(),T(o(2,2,t.label)),n(4),p(t.hasCount(t.count)?5:6)}}var Ge=(()=>{class e{constructor(){}hasCount(t){return typeof t=="number"&&t>=0}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-action"]],inputs:{label:"label",count:"count",link:"link",linkParams:"linkParams",externalLink:"externalLink"},standalone:!0,features:[y],ngContentSelectors:at,decls:4,vars:2,consts:[["actionContent",""],[3,"routerLink","queryParams"],[3,"href"],[4,"ngTemplateOutlet"],[1,"label"],[1,"count"],["xmlns","http://www.w3.org/2000/svg","width","24","height","24","fill","none"],["fill","currentColor","d","m12 20-1.425-1.4 5.6-5.6H4v-2h12.175l-5.6-5.6L12 4l8 8-8 8Z"]],template:function(i,s){i&1&&(Ce(),l(0,st,2,3,"a",1)(1,dt,2,2,"a",2)(2,pt,7,4,"ng-template",null,0,Se)),i&2&&(p(s.externalLink?-1:0),n(),p(s.externalLink?1:-1))},dependencies:[Me,xe,k,M],styles:["a[_ngcontent-%COMP%]{display:flex;gap:1rem;justify-content:space-between;align-items:center;padding:1rem 1.5rem;background:#f7e9d2;text-decoration:none;line-height:1}a[_ngcontent-%COMP%]:hover{background:#f2e0c3}a[_ngcontent-%COMP%]:focus-visible{outline-width:2px;outline-offset:-2px}div[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:1rem}.label[_ngcontent-%COMP%]{font-weight:400}.count[_ngcontent-%COMP%]{font-size:1.5rem}"]})}}return e})();var qe=(()=>{class e{constructor(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-deadline"]],inputs:{count:"count"},standalone:!0,features:[y],decls:3,vars:8,template:function(i,s){i&1&&(m(0),a(1,"translate"),a(2,"addSpace")),i&2&&ve("",o(1,3,"dashboard.actions.deadline"),"",E(2,5,": ",":"),"",s.count,`
`)},dependencies:[k,M,ze],styles:["[_nghost-%COMP%]{background:#ea161f;color:#fff;white-space:nowrap;font-weight:500;font-size:.875rem;min-height:1.5rem;display:flex;padding:.375rem .5rem;align-items:center;border-radius:2.5rem}"]})}}return e})();var Ke=Ae({Id:Ie,Holder:ke});var We=(()=>{class e extends je{constructor(t,i){super(t,i,Ke,"TeacherSubstitutions")}getTeacherSubstitution(t){return this.getList({params:{"filter.Id":`=${t}`}}).pipe(b(i=>i[0]||null))}static{this.\u0275fac=function(i){return new(i||e)($(Te),$(R))}}static{this.\u0275prov=q({token:e,factory:e.\u0275fac,providedIn:"root"})}}return e})();var ut=["LessonTeacherRole","ClassTeacherRole","TeacherRole","AbsenceAdministratorRole"],ft=["LessonTeacherRole","TeacherRole","StudentRole","SubstituteAdministratorRole"],_t=["LessonTeacherRole","StudentRole"],A=(()=>{class e{constructor(t,i,s,_,D,N,U,nt){this.settingsService=t,this.lessonPresencesService=i,this.studentsService=s,this.courseService=_,this.teacherSubstitutionService=D,this.personService=N,this.storageService=U,this.settings=nt,this.rolesAndPermissions$=this.settingsService.getRolesAndPermissions(),this.studentId$=new ce(1),this.lessonAbsences$=this.studentId$.pipe(P(C=>this.studentsService.getLessonAbsences(C)),x(1)),this.lessonIncidents$=this.studentId$.pipe(P(C=>this.studentsService.getLessonIncidents(C)),x(1)),this.loading$=this.rolesAndPermissions$.pipe(b(C=>C==null)),this.hasSearch$=this.rolesAndPermissions$.pipe(b(this.hasRoles(ut))),this.hasActions$=this.rolesAndPermissions$.pipe(b(this.hasRoles(ft))),this.hasTimetable$=this.rolesAndPermissions$.pipe(b(this.hasRoles(_t))),this.hasLessonTeacherRole$=this.rolesAndPermissions$.pipe(b(this.hasRoles(["LessonTeacherRole"])),x(1)),this.hasTeacherRole$=this.rolesAndPermissions$.pipe(b(this.hasRoles(["TeacherRole"])),x(1)),this.hasStudentRole$=this.rolesAndPermissions$.pipe(b(this.hasRoles(["StudentRole"])),x(1)),this.hasSubstituteAdministratorRole$=this.rolesAndPermissions$.pipe(b(this.hasRoles(["SubstituteAdministratorRole"])),x(1)),this.editAbsencesCount$=this.hasLessonTeacherRole$.pipe(P(C=>C?this.lessonPresencesService.checkableAbsencesCount():L(!1)),x(1)),this.openAbsencesCount$=this.rolesAndPermissions$.pipe(b(this.hasRoles(["LessonTeacherRole","ClassTeacherRole"])),P(C=>C?this.lessonPresencesService.getListOfUnconfirmed():L([])),b(C=>C.length),x(1)),this.myAbsencesCount$=this.hasStudentRole$.pipe(P(C=>C?this.getMyAbsences():L([])),b(this.getMyAbsencesCount.bind(this)),x(1)),this.coursesToRateCount$=this.courseService.getNumberOfCoursesForRating().pipe(le(0),x(1)),this.hasPresenceControl$=this.hasLessonTeacherRole$.pipe(P(C=>C?this.lessonPresencesService.hasLessonsLessonTeacher():L(!1)),x(1)),this.hasOpenAbsences$=this.openAbsencesCount$.pipe(b(C=>C>0),x(1)),this.editAbsencesParams$=this.getFullName().pipe(b(C=>({confirmationStates:this.settings.checkableAbsenceStateId,teacher:C})),x(1));let re=this.storageService.getPayload()?.id_person;re&&this.studentId$.next(Number(re))}hasRoles(t){return i=>(i??[]).some(s=>t.includes(s))}getMyAbsences(){return H([this.studentId$,this.lessonAbsences$,this.lessonIncidents$]).pipe(P(([t,i,s])=>this.loadTimetableEntries(t,i,s).pipe(b(_=>[...i,...s].map(D=>this.withTimetableEntry(D,_)).filter(Oe)))))}getMyAbsencesCount(t){return t?.filter(i=>("ConfirmationStateId"in i?i.ConfirmationStateId:null)===this.settings.unconfirmedAbsenceStateId).length||0}getFullName(){let t=Number(this.storageService.getPayload()?.substitution_id)||null;return t?this.teacherSubstitutionService.getTeacherSubstitution(t).pipe(b(i=>i?.Holder)):this.personService.getMyself().pipe(b(i=>i.FullName))}withTimetableEntry(t,i){return i.find(s=>s.Id===t.LessonRef.Id)?t:null}loadTimetableEntries(t,i,s){return this.studentsService.getTimetableEntries(t,{"filter.Id":`;${[...i,...s].map(_=>_.LessonRef.Id).join(";")}`})}static{this.\u0275fac=function(i){return new(i||e)($(Q),$(Z),$(z),$(Ne),$(We),$(Fe),$(Ee),$(R))}}static{this.\u0275prov=q({token:e,factory:e.\u0275fac})}}return e})();var Ct=()=>["/presence-control"],gt=()=>["/edit-absences"],vt=()=>["/open-absences"],yt=()=>["/events"],St=()=>["/my-absences","report"],xt=()=>["/my-absences"];function Tt(e,c){e&1&&f(0,"bkd-dashboard-action",0),e&2&&u("label","dashboard.actions.presence-control")("link",j(2,Ct))}function Dt(e,c){if(e&1&&(f(0,"bkd-dashboard-action",1),a(1,"async"),a(2,"async")),e&2){let t=h();u("label","dashboard.actions.edit-absences")("link",j(8,gt))("linkParams",o(1,4,t.dashboardService.editAbsencesParams$))("count",o(2,6,t.dashboardService.editAbsencesCount$))}}function Pt(e,c){if(e&1&&(f(0,"bkd-dashboard-action",2),a(1,"async")),e&2){let t=h();u("label","dashboard.actions.open-absences")("link",j(5,vt))("count",o(1,3,t.dashboardService.openAbsencesCount$))}}function $t(e,c){if(e&1&&(f(0,"bkd-dashboard-deadline",4),a(1,"async")),e&2){let t=h(2);u("count",o(1,1,t.dashboardService.coursesToRateCount$))}}function Mt(e,c){if(e&1&&(d(0,"bkd-dashboard-action",0),l(1,$t,2,3,"bkd-dashboard-deadline",4),a(2,"async"),r()),e&2){let t,i=h();u("label","dashboard.actions.tests")("link",j(5,yt)),n(),p((t=o(2,3,i.dashboardService.coursesToRateCount$))!==null&&t!==void 0&&t?1:-1)}}function kt(e,c){e&1&&f(0,"bkd-dashboard-action",0),e&2&&u("label","dashboard.actions.my-absences-report")("link",j(2,St))}function It(e,c){if(e&1&&(f(0,"bkd-dashboard-action",2),a(1,"async")),e&2){let t=h();u("label","dashboard.actions.my-absences")("link",j(5,xt))("count",o(1,3,t.dashboardService.myAbsencesCount$))}}function At(e,c){if(e&1&&f(0,"bkd-dashboard-action",3),e&2){let t=h();u("label","dashboard.actions.substitutions")("externalLink",t.substitutionsAdminLink)}}var Ze=(()=>{class e{constructor(t,i){this.dashboardService=t,this.settings=i}get substitutionsAdminLink(){return this.settings.dashboard.substitutionsAdminLink}static{this.\u0275fac=function(i){return new(i||e)(g(A),g(R))}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-actions"]],standalone:!0,features:[y],decls:15,vars:23,consts:[[3,"label","link"],[3,"label","link","linkParams","count"],[3,"label","link","count"],[3,"label","externalLink"],[3,"count"]],template:function(i,s){i&1&&(l(0,Tt,1,3,"bkd-dashboard-action",0),a(1,"async"),l(2,Dt,3,9,"bkd-dashboard-action",1),a(3,"async"),a(4,"async"),l(5,Pt,2,6,"bkd-dashboard-action",2),a(6,"async"),l(7,Mt,3,6,"bkd-dashboard-action",0),a(8,"async"),l(9,kt,1,3,"bkd-dashboard-action",0),a(10,"async"),l(11,It,2,6,"bkd-dashboard-action",2),a(12,"async"),l(13,At,1,2,"bkd-dashboard-action",3),a(14,"async")),i&2&&(p(o(1,7,s.dashboardService.hasPresenceControl$)?0:-1),n(2),p(o(3,9,s.dashboardService.hasLessonTeacherRole$)&&o(4,11,s.dashboardService.editAbsencesParams$)?2:-1),n(3),p(o(6,13,s.dashboardService.hasOpenAbsences$)?5:-1),n(2),p(o(8,15,s.dashboardService.hasTeacherRole$)?7:-1),n(2),p(o(10,17,s.dashboardService.hasStudentRole$)?9:-1),n(2),p(o(12,19,s.dashboardService.hasStudentRole$)?11:-1),n(2),p(o(14,21,s.dashboardService.hasSubstituteAdministratorRole$)?13:-1))},dependencies:[Ge,qe,O],styles:["[_nghost-%COMP%]{display:flex;flex-direction:column;gap:.5rem}"]})}}return e})();var Je=(()=>{class e{constructor(t,i){this.studentsRestService=t,this.router=i}navigateToDossier(t){return de(this,null,function*(){let i=Number(t);yield this.router.navigate(["dashboard","student",i,"addresses"])})}static{this.\u0275fac=function(i){return new(i||e)(g(z),g($e))}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-search"]],standalone:!0,features:[y],decls:1,vars:2,consts:[[3,"valueChange","typeaheadService","placeholder"]],template:function(i,s){i&1&&(d(0,"bkd-typeahead",0),F("valueChange",function(D){return D&&s.navigateToDossier(D)}),r()),i&2&&u("typeaheadService",s.studentsRestService)("placeholder","dashboard.search.placeholder")},dependencies:[He],styles:["[_nghost-%COMP%]{display:block;padding:.75rem;background:#f7e9d2}"]})}}return e})();var Qe=(()=>{class e{constructor(t){this.sanitizer=t}transform(t,i){switch(i){case"html":return this.sanitizer.bypassSecurityTrustHtml(t);case"style":return this.sanitizer.bypassSecurityTrustStyle(t);case"script":return this.sanitizer.bypassSecurityTrustScript(t);case"url":return this.sanitizer.bypassSecurityTrustUrl(t);case"resourceUrl":return this.sanitizer.bypassSecurityTrustResourceUrl(t);default:throw new Error(`Invalid safe type specified: ${i}`)}}static{this.\u0275fac=function(i){return new(i||e)(g(De,16))}}static{this.\u0275pipe=me({name:"safe",type:e,pure:!0,standalone:!0})}}return e})();var Et=(e,c)=>c.id;function Ot(e,c){e&1&&(d(0,"th"),m(1),a(2,"translate"),r()),e&2&&(n(),S(" ",o(2,1,"dashboard.timetable.table.teacher")," "))}function Rt(e,c){e&1&&(d(0,"th"),m(1),a(2,"translate"),r()),e&2&&(n(),S(" ",o(2,1,"dashboard.timetable.table.room")," "))}function Lt(e,c){if(e&1&&(d(0,"a",3),m(1),d(2,"span",7),m(3),r()()),e&2){let t=h().$implicit,i=h(2);u("href",i.buildLink(t.eventId),w),n(),S(" ",t.subject,""),n(2),S(", ",t.studyClass,"")}}function wt(e,c){if(e&1&&m(0),e&2){let t=h().$implicit;S(" ",t.subject," ")}}function Bt(e,c){if(e&1&&(d(0,"td",4),m(1),a(2,"translate"),r()),e&2){let t=h().$implicit;n(),oe(" ",o(2,2,"dashboard.timetable.table.study-class"),": ",t.studyClass," ")}}function jt(e,c){if(e&1&&(d(0,"td",5),m(1),r()),e&2){let t=h().$implicit;n(),S(" ",t.teacher," ")}}function Ft(e,c){e&1&&(d(0,"span",8),m(1),a(2,"translate"),r()),e&2&&(n(),T(o(2,1,"dashboard.timetable.table.room")))}function zt(e,c){if(e&1&&(d(0,"td",6),l(1,Ft,3,3,"span",8),m(2),r()),e&2){let t=h().$implicit;n(),p(t.room?1:-1),n(),S(" ",t.room," ")}}function Nt(e,c){if(e&1&&(d(0,"tr")(1,"td",1),m(2),a(3,"date"),a(4,"date"),r(),d(5,"td",2),l(6,Lt,4,3,"a",3),a(7,"async"),l(8,wt,1,1),r(),l(9,Bt,3,4,"td",4),a(10,"async"),l(11,jt,2,1,"td",5),a(12,"async"),l(13,zt,3,2,"td",6),a(14,"async"),r()),e&2){let t=c.$implicit,i=h(2);n(2),oe(" ",E(3,6,t.from,"HH:mm"),"\u2013",E(4,9,t.until,"HH:mm")," "),n(4),p(o(7,12,i.isTeacher$)?6:8),n(3),p(o(10,14,i.isTeacher$)?9:-1),n(2),p(o(12,16,i.isStudent$)?11:-1),n(2),p(o(14,18,i.isStudent$)?13:-1)}}function Ut(e,c){if(e&1&&(d(0,"table",0)(1,"thead")(2,"tr")(3,"th"),m(4),a(5,"translate"),r(),d(6,"th"),m(7),a(8,"translate"),r(),l(9,Ot,3,3,"th"),a(10,"async"),l(11,Rt,3,3,"th"),a(12,"async"),r()(),d(13,"tbody"),ue(14,Nt,15,20,"tr",null,Et),r()()),e&2){let t=h();n(4),T(o(5,4,"dashboard.timetable.table.time")),n(3),T(o(8,6,"dashboard.timetable.table.subject")),n(2),p(o(10,8,t.isStudent$)?9:-1),n(2),p(o(12,10,t.isStudent$)?11:-1),n(3),fe(t.entries)}}function Ht(e,c){e&1&&(d(0,"p"),m(1),a(2,"translate"),r()),e&2&&(n(),T(o(2,1,"dashboard.timetable.no-entries")))}var Xe=(()=>{class e{constructor(t,i){this.dashboardService=t,this.settings=i,this.entries=[],this.isStudent$=this.dashboardService.hasStudentRole$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$}buildLink(t){return this.settings.eventlist.eventdetail.replace(":id",String(t))}static{this.\u0275fac=function(i){return new(i||e)(g(A),g(R))}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-timetable-table"]],inputs:{entries:"entries"},standalone:!0,features:[y],decls:2,vars:1,consts:[[1,"table"],[1,"time"],[1,"subject"],["target","_parent",3,"href"],[1,"study-class"],[1,"teacher"],[1,"room"],[1,"subject-study-class"],[1,"room-label"]],template:function(i,s){i&1&&l(0,Ut,16,12,"table",0)(1,Ht,3,3,"p"),i&2&&p(s.entries.length>0?0:1)},dependencies:[O,Y,k,M],styles:['td[_ngcontent-%COMP%], th[_ngcontent-%COMP%]{padding:1rem 1.75rem}.room-label[_ngcontent-%COMP%], td.study-class[_ngcontent-%COMP%]{display:none}@media (max-width: 767.98px){table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{display:none}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]{border-top:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-template-areas:"time room" "subject subject" "study-class study-class" "teacher teacher";gap:.5rem;padding:1rem;border-bottom:1px solid var(--bs-border-color)}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border-bottom:0;padding:0}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.time[_ngcontent-%COMP%]{grid-area:time;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.subject[_ngcontent-%COMP%]{grid-area:subject;font-size:1rem;line-height:1.25rem;font-weight:400}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.teacher[_ngcontent-%COMP%]{grid-area:teacher;font-size:.8125rem;line-height:1.0625rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.room[_ngcontent-%COMP%]{grid-area:room;text-align:right;font-size:.875rem;line-height:1.125rem;font-weight:300}table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   td.study-class[_ngcontent-%COMP%]{grid-area:study-class;font-size:.8125rem;line-height:1.0625rem;font-weight:300}td.study-class[_ngcontent-%COMP%]{display:block}.subject-study-class[_ngcontent-%COMP%]{display:none}.room-label[_ngcontent-%COMP%]{display:inline}}']})}}return e})();function Vt(e,c){e&1&&(d(0,"a",6),a(1,"safe"),m(2),a(3,"translate"),r()),e&2&&(u("href",E(1,2,c,"url"),w),n(2),S(" ",o(3,5,"dashboard.timetable.subscribe-calendar")," "))}function Gt(e,c){e&1&&f(0,"bkd-spinner")}function qt(e,c){e&1&&(d(0,"a",8),a(1,"safe"),m(2),a(3,"translate"),r()),e&2&&(u("href",E(1,2,c,"url"),w),n(2),S(" ",o(3,5,"dashboard.timetable.subscribe-calendar")," "))}function Kt(e,c){if(e&1&&(f(0,"bkd-dashboard-timetable-table",7),l(1,qt,4,7,"a",8),a(2,"async")),e&2){let t,i=h(),s=G(18);u("entries",s),n(),p((t=o(2,2,i.getSubscribeCalendarUrl()))?1:-1,t)}}var Wt="cal",et=(()=>{class e{constructor(t,i,s,_){this.studentsService=t,this.lessonPresencesService=i,this.userSettings=s,this.dashboardService=_,this.studentId$=this.dashboardService.studentId$,this.isTeacher$=this.dashboardService.hasLessonTeacherRole$,this.isStudent$=this.dashboardService.hasStudentRole$,this.date$=new te(se(new Date)),this.loading$=new te(!0),this.timetableEntries$=this.loadTimetableEntries()}gotoToday(){this.loading$.next(!0),this.date$.next(se(new Date))}gotoPreviousDay(){this.loading$.next(!0),this.date$.next(we(this.date$.getValue(),1))}gotoNextDay(){this.loading$.next(!0),this.date$.next(Re(this.date$.getValue(),1))}getSubscribeCalendarUrl(){return this.userSettings.getSetting(Wt)}loadTimetableEntries(){return H([this.isTeacher$,this.isStudent$]).pipe(P(([t,i])=>t?this.loadTeacherTimetableEntries():i?this.loadStudentTimetableEntries():L([])),pe(()=>this.loading$.next(!1)))}loadTeacherTimetableEntries(){return this.date$.pipe(P(t=>this.lessonPresencesService.getLessonsByDate(t)),b(Ve),b(t=>t.map(this.convertLesson.bind(this))))}loadStudentTimetableEntries(){return H([this.studentId$,this.date$]).pipe(P(([t,i])=>this.studentsService.getTimetableEntries(t,{"filter.From":`=${Le(i,"yyyy-MM-dd")}`,sort:"From,To"})),b(t=>t.map(this.convertTimetableEntry.bind(this))))}convertLesson(t){return{id:`${t.LessonRef.Id}-${t.StudyClassNumber}`,from:t.LessonDateTimeFrom,until:t.LessonDateTimeTo,eventId:t.EventRef.Id,subject:t.EventDesignation,studyClass:t.StudyClassNumber}}convertTimetableEntry(t){return{id:String(t.Id),from:t.From,until:t.To,eventId:t.EventId,subject:t.EventDesignation,room:t.EventLocation||void 0,teacher:t.EventManagerInformation||void 0}}static{this.\u0275fac=function(i){return new(i||e)(g(z),g(Z),g(Q),g(A))}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-timetable"]],standalone:!0,features:[y],decls:23,vars:24,consts:[[1,"header"],["type","button",1,"btn","btn-primary","today",3,"click"],["type","button",1,"btn","btn-secondary","previous-day",3,"click"],[1,"material-icons"],["type","button",1,"btn","btn-secondary","next-day",3,"click"],[1,"date"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-header",3,"href"],[3,"entries"],["target","_parent",1,"btn","btn-secondary","subscribe-calendar-bottom",3,"href"]],template:function(i,s){if(i&1){let _=_e();d(0,"div",0)(1,"button",1),F("click",function(){return K(_),W(s.gotoToday())}),m(2),a(3,"translate"),r(),d(4,"button",2),a(5,"translate"),F("click",function(){return K(_),W(s.gotoPreviousDay())}),d(6,"span",3),m(7,"chevron_left"),r()(),d(8,"button",4),a(9,"translate"),F("click",function(){return K(_),W(s.gotoNextDay())}),d(10,"span",3),m(11,"chevron_right"),r()(),d(12,"div",5),m(13),a(14,"async"),a(15,"date"),r(),l(16,Vt,4,7,"a",6),a(17,"async"),r(),B(18),a(19,"async"),l(20,Gt,1,0,"bkd-spinner"),a(21,"async"),l(22,Kt,3,4)}if(i&2){let _;n(2),S(" ",o(3,6,"dashboard.timetable.today")," "),n(2),ie("aria-label",o(5,8,"dashboard.timetable.previousDay")),n(4),ie("aria-label",o(9,10,"dashboard.timetable.nextDay")),n(5),T(E(15,14,o(14,12,s.date$),"E, dd. MMMM yyyy")),n(3),p((_=o(17,17,s.getSubscribeCalendarUrl()))?16:-1,_),n(2),V(o(19,19,s.timetableEntries$)),n(2),p(o(21,22,s.loading$)?20:22)}},dependencies:[Xe,J,O,Y,k,M,Qe],styles:["[_nghost-%COMP%]{display:block;margin-bottom:1rem}.header[_ngcontent-%COMP%]{margin-top:1rem;margin-bottom:2rem;display:flex;align-items:center;gap:1rem}.previous-day[_ngcontent-%COMP%], .next-day[_ngcontent-%COMP%]{padding-left:.375rem;padding-right:.375rem}.date[_ngcontent-%COMP%]{font-size:1.25rem;font-weight:600}.subscribe-calendar-header[_ngcontent-%COMP%]{margin-left:auto}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:none}a.btn[_ngcontent-%COMP%]{text-decoration:none}@media (max-width: 767.98px){.subscribe-calendar-header[_ngcontent-%COMP%]{display:none}.subscribe-calendar-bottom[_ngcontent-%COMP%]{display:block;margin-top:2rem}}@media (max-width: 767.98px) and (max-width: 575.98px){.header[_ngcontent-%COMP%]{flex-wrap:wrap-reverse}.header[_ngcontent-%COMP%]   .date[_ngcontent-%COMP%]{width:100%}}"]})}}return e})();function Yt(e,c){e&1&&f(0,"bkd-spinner")}function Zt(e,c){e&1&&(d(0,"p"),m(1),a(2,"translate"),r()),e&2&&(n(),S(" ",o(2,1,"dashboard.no-access")," "))}function Jt(e,c){e&1&&(d(0,"div")(1,"h2"),m(2),a(3,"translate"),r(),f(4,"bkd-dashboard-search"),r()),e&2&&(n(2),T(o(3,1,"dashboard.search.title")))}function Qt(e,c){e&1&&(d(0,"div")(1,"h2"),m(2),a(3,"translate"),r(),f(4,"bkd-dashboard-actions"),r()),e&2&&(n(2),T(o(3,1,"dashboard.actions.title")))}function Xt(e,c){if(e&1&&(d(0,"div",1),l(1,Jt,5,3,"div")(2,Qt,5,3,"div"),r()),e&2){h();let t=G(2),i=G(4);n(),p(t?1:-1),n(),p(i?2:-1)}}function ei(e,c){e&1&&(d(0,"div",2)(1,"h2"),m(2),a(3,"translate"),r(),f(4,"bkd-dashboard-timetable"),r()),e&2&&(n(2),T(o(3,1,"dashboard.timetable.title")))}var tt=(()=>{class e{constructor(t){this.dashboardService=t}static{this.\u0275fac=function(i){return new(i||e)(g(A))}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard-layout"]],standalone:!0,features:[y],decls:17,vars:19,consts:[[1,"columns"],[1,"search-actions-column"],[1,"timetable-column"]],template:function(i,s){if(i&1&&(B(0),a(1,"async"),B(2),a(3,"async"),B(4),a(5,"async"),B(6),a(7,"async"),d(8,"div")(9,"h1"),m(10),a(11,"translate"),r(),l(12,Yt,1,0,"bkd-spinner")(13,Zt,3,3,"p"),d(14,"div",0),l(15,Xt,3,2,"div",1)(16,ei,5,3,"div",2),r()()),i&2){let _=o(1,7,s.dashboardService.loading$);n(2);let D=V(o(3,9,s.dashboardService.hasSearch$));n(2);let N=V(o(5,12,s.dashboardService.hasActions$)),U=o(7,15,s.dashboardService.hasTimetable$);n(5),be("visually-hidden",_||D||N||U),n(),S(" ",o(11,17,"dashboard.heading")," "),n(2),p(_?12:-1),n(),p(!_&&!D&&!N&&!U?13:-1),n(2),p(D||N?15:-1),n(),p(U?16:-1)}},dependencies:[J,Je,Ze,et,O,k,M],styles:[".columns[_ngcontent-%COMP%]{display:flex;flex-direction:column}.columns[_ngcontent-%COMP%], .search-actions-column[_ngcontent-%COMP%]{gap:3rem}.search-actions-column[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;max-width:40rem}.timetable-column[_ngcontent-%COMP%]{flex:2}@media (min-width: 992px){.columns[_ngcontent-%COMP%]{flex-direction:row;gap:1.5rem}.search-actions-column[_ngcontent-%COMP%]{max-width:33%}}"],changeDetection:0})}}return e})();var it=(()=>{class e{constructor(){}static{this.\u0275fac=function(i){return new(i||e)}}static{this.\u0275cmp=v({type:e,selectors:[["bkd-dashboard"]],standalone:!0,features:[ye([A,Be]),y],decls:1,vars:0,template:function(i,s){i&1&&f(0,"router-outlet")},dependencies:[Pe],changeDetection:0})}}return e})();var sn=[{path:"",component:it,children:[{path:"",component:tt},Ue]}];export{sn as DASHBOARD_ROUTES};
