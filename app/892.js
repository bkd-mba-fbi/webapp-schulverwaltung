"use strict";(self.webpackChunkwebapp_schulverwaltung=self.webpackChunkwebapp_schulverwaltung||[]).push([[892],{6892:(I,u,e)=>{e.r(u),e.d(u,{MySettingsModule:()=>V});var v=e(6482),l=e(6159),t=e(4650),m=e(1135),g=e(3900),f=e(4004),M=e(4782),b=e(8746),C=e(5698),p=e(876),Z=e(8189),x=e(9300),N=e(6590),A=e(590),T=e(8505),U=e(2786),F=e(331),J=e(1306);let d=(()=>{class i{constructor(n){this.settingsService=n,this.refetchSubject=new m.X(null),this.settingsService.getUserSettingsCst().subscribe(s=>sessionStorage.setItem("userSettings",JSON.stringify(p.sh.encode(s))))}get refetch(){return this.refetchSubject.asObservable()}getCurrentNotificationSettingsPropertyValue(){return this.settingsService.getUserSettingsCst().pipe((0,f.U)(n=>n.Settings),(0,Z.J)(),(0,x.h)(n=>"notification"===n.Key),(0,N.d)({Value:"{}"}),(0,A.P)(),(0,f.U)(n=>JSON.parse(n.Value)),(0,g.w)((0,U.Jx)(p.xk)))}updateCurrentNotificationSettingsPropertyValue(n,s,r){const X={Key:"notification",Value:JSON.stringify({gui:n,mail:s,phoneMobile:r})},S=Object.assign({},(0,F.kl)());return S.Settings.push(X),this.settingsService.updateUserSettingsCst(S).pipe((0,T.b)(()=>this.refetchSubject.next(null)))}}return i.\u0275fac=function(n){return new(n||i)(t.LFG(J.j))},i.\u0275prov=t.Yz7({token:i,factory:i.\u0275fac}),i})();var c=e(4006),z=e(1443),h=e(6188),y=e(6895),G=e(1104);function L(i,o){1&i&&(t.TgZ(0,"div",15)(1,"span",16),t._uU(2,"Loading..."),t.qZA()())}function j(i,o){if(1&i){const n=t.EpF();t.TgZ(0,"form",4),t.NdJ("ngSubmit",function(){t.CHM(n);const r=t.oxw(2);return t.KtG(r.onSubmit())}),t.TgZ(1,"div",5),t._UZ(2,"input",6),t.TgZ(3,"label",7),t._uU(4),t.ALo(5,"translate"),t.qZA()(),t.TgZ(6,"div",5),t._UZ(7,"input",8),t.TgZ(8,"label",9),t._uU(9),t.ALo(10,"translate"),t.qZA()(),t.TgZ(11,"div",5),t._UZ(12,"input",10),t.TgZ(13,"label",11),t._uU(14),t.ALo(15,"translate"),t.qZA()(),t.TgZ(16,"div",12)(17,"button",13),t.ALo(18,"async"),t._uU(19),t.ALo(20,"translate"),t.YNc(21,L,3,0,"div",14),t.ALo(22,"async"),t.qZA()()()}if(2&i){const n=t.oxw().erzLet,s=t.oxw();t.Q6J("formGroup",n.notificationFormGroup),t.xp6(4),t.hij(" ",t.lcZ(5,7,"my-settings.notifications.gui")," "),t.xp6(5),t.hij(" ",t.lcZ(10,9,"my-settings.notifications.mail")," "),t.xp6(5),t.hij(" ",t.lcZ(15,11,"my-settings.notifications.phoneMobile")," "),t.xp6(3),t.Q6J("disabled",t.lcZ(18,13,s.saving$)),t.xp6(2),t.hij(" ",t.lcZ(20,15,"my-settings.notifications.save")," "),t.xp6(2),t.Q6J("ngIf",t.lcZ(22,17,s.saving$))}}function $(i,o){if(1&i&&(t.TgZ(0,"div",1)(1,"h5",2),t._uU(2),t.ALo(3,"translate"),t.qZA(),t.YNc(4,j,23,19,"form",3),t.qZA()),2&i){const n=o.erzLet;t.xp6(2),t.hij(" ",t.lcZ(3,2,"my-settings.notifications.title")," "),t.xp6(2),t.Q6J("ngIf",n.notificationFormGroup)}}const P=function(i){return{notificationFormGroup:i}};let B=(()=>{class i{constructor(n,s,r,a){this.settingsService=n,this.formBuilder=s,this.toastService=r,this.translate=a,this.notificationSettings$=this.settingsService.refetch.pipe((0,g.w)(()=>this.settingsService.getCurrentNotificationSettingsPropertyValue())),this.notificationFormGroup$=this.notificationSettings$.pipe((0,f.U)(this.createNotificationFormGroup.bind(this)),(0,M.d)(1)),this.saving$=new m.X(!1),this.submitted$=new m.X(!1)}createNotificationFormGroup(n){return this.formBuilder.group({notificationsGui:[n.gui],notificationsMail:[n.mail],notificationsPhoneMobile:[n.phoneMobile]})}save(n,s,r){this.saving$.next(!0),this.settingsService.updateCurrentNotificationSettingsPropertyValue(n,s,r).pipe((0,b.x)(()=>this.saving$.next(!1))).subscribe(this.onSaveSuccess.bind(this))}onSaveSuccess(){this.toastService.success(this.translate.instant("my-settings.notifications.save-success"))}onSubmit(){this.submitted$.next(!0),this.notificationFormGroup$.pipe((0,C.q)(1)).subscribe(n=>{if(n.valid){const{notificationsGui:s,notificationsMail:r,notificationsPhoneMobile:a}=n.value;this.save(s,r,a)}})}}return i.\u0275fac=function(n){return new(n||i)(t.Y36(d),t.Y36(c.QS),t.Y36(z.k),t.Y36(h.sK))},i.\u0275cmp=t.Xpm({type:i,selectors:[["erz-my-settings-notifications"]],decls:2,vars:5,consts:[["class","border-bottom mb-3 pb-3",4,"erzLet"],[1,"border-bottom","mb-3","pb-3"],[1,"m-0","pb-3"],[3,"formGroup","ngSubmit",4,"ngIf"],[3,"formGroup","ngSubmit"],[1,"checkbox"],["id","my-settings-notifications-gui","type","checkbox","formControlName","notificationsGui",1,"form-check-input"],["for","my-settings-notifications-gui",1,"ps-2","form-label"],["id","my-settings-notifications-mail","type","checkbox","formControlName","notificationsMail",1,"form-check-input"],["for","my-settings-notifications-mail",1,"ps-2","form-label"],["id","my-settings-notifications-phoneMobile","type","checkbox","formControlName","notificationsPhoneMobile",1,"form-check-input"],["for","my-settings-notifications-phoneMobile",1,"ps-2","form-label"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary","ms-2",3,"disabled"],["class","spinner-border spinner-border-sm align-middle","role","status",4,"ngIf"],["role","status",1,"spinner-border","spinner-border-sm","align-middle"],[1,"visually-hidden"]],template:function(n,s){1&n&&(t.YNc(0,$,5,4,"div",0),t.ALo(1,"async")),2&n&&t.Q6J("erzLet",t.VKq(3,P,t.lcZ(1,1,s.notificationFormGroup$)))},dependencies:[y.O5,c._Y,c.Wl,c.JJ,c.JL,c.sg,c.u,G.e,y.Ov,h.X$],styles:[".checkbox[_ngcontent-%COMP%]   input.form-check-input[_ngcontent-%COMP%]{position:static!important;margin:0!important}"],changeDetection:0}),i})();const O=[{path:"",component:(()=>{class i{constructor(){}}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["erz-my-settings"]],features:[t._Bn([d])],decls:1,vars:0,template:function(n,s){1&n&&t._UZ(0,"router-outlet")},dependencies:[l.lC],changeDetection:0}),i})(),children:[{path:"",component:(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275cmp=t.Xpm({type:i,selectors:[["erz-my-settings-show"]],decls:2,vars:0,consts:[[1,"erz-container","erz-container-limited","erz-container-padding-y"]],template:function(n,s){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"erz-my-settings-notifications"),t.qZA())},dependencies:[B]}),i})()}]}];let Y=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[l.Bz.forChild(O),l.Bz]}),i})(),V=(()=>{class i{}return i.\u0275fac=function(n){return new(n||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[v.m,Y]}),i})()}}]);