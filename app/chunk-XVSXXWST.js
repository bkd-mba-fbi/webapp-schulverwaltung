import{a as gt}from"./chunk-M3VKTN3S.js";import{a as pt,c as p,g as ct,j as ut,l as R,q as dt,u as _t,w as ft,z as mt}from"./chunk-DVBPCEX4.js";import{$b as nt,Ab as v,B as S,Ba as u,Ca as W,Fb as K,Fc as ot,Hb as G,Ja as g,Jb as Y,Jc as at,Kb as b,Ma as U,Mb as y,Nb as C,Ob as d,Pb as q,Pc as rt,Qb as J,Rb as Q,Sb as X,Tb as tt,Yb as et,Zb as it,_ as H,ac as x,ba as N,bc as _,cd as ht,dc as h,fb as c,ga as $,h as D,ha as B,i as P,ia as A,kb as L,ma as r,nc as st,o as V,pc as I,qc as T,rc as E,sa as f,sc as F,sd as lt,t as k,ta as m,ub as w,vb as z,wb as Z,xa as M,ya as j}from"./chunk-CHBP6U4G.js";function bt(i,s){if(i&1&&(X(0,"span"),E(1),tt()),i&2){let t=h().$implicit,e=h();T(e.highlightClass),c(),F(t)}}function yt(i,s){if(i&1&&(et(0),E(1),it()),i&2){let t=h().$implicit;c(),F(t)}}function Ct(i,s){if(i&1&&G(0,bt,2,3,"span",0)(1,yt,2,1,"ng-container"),i&2){let t=s.$index;Y(t%2!==0?0:1)}}var xt=(i,s,t)=>({result:i,term:s,formatter:t});function It(i,s){if(i&1&&Q(0,"ngb-highlight",2),i&2){let t=s.result,e=s.term,n=s.formatter;d("result",n(t))("term",e)}}function Tt(i,s){}function Et(i,s){if(i&1){let t=nt();q(0,"button",3),_("mouseenter",function(){let n=f(t).$index,o=h();return m(o.markActive(n))})("click",function(){let n=f(t).$implicit,o=h();return m(o.select(n))}),v(1,Tt,0,0,"ng-template",4),J()}if(i&2){let t=s.$implicit,e=s.$index,n=h(),o=st(1);I("active",e===n.activeIdx),d("id",n.id+"-"+e),c(),d("ngTemplateOutlet",n.resultTemplate||o)("ngTemplateOutletContext",at(5,xt,t,n.term,n.formatter))}}var Ft=(()=>{class i{constructor(){this.highlightClass="ngb-highlight",this.accentSensitive=!0}ngOnChanges(t){!this.accentSensitive&&!String.prototype.normalize&&(console.warn("The `accentSensitive` input in `ngb-highlight` cannot be set to `false` in a browser that does not implement the `String.normalize` function. You will have to include a polyfill in your application to use this feature in the current browser."),this.accentSensitive=!0);let e=p(this.result),n=Array.isArray(this.term)?this.term:[this.term],o=a=>this.accentSensitive?a:R(a),l=n.map(a=>ut(o(p(a)))).filter(a=>a),wt=this.accentSensitive?e:R(e),O=l.length?wt.split(new RegExp(`(${l.join("|")})`,"gmi")):[e];if(this.accentSensitive)this.parts=O;else{let a=0;this.parts=O.map(vt=>e.substring(a,a+=vt.length))}}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=w({type:i,selectors:[["ngb-highlight"]],inputs:{highlightClass:"highlightClass",result:"result",term:"term",accentSensitive:"accentSensitive"},features:[g],decls:2,vars:0,consts:[[3,"class"]],template:function(e,n){e&1&&y(0,Ct,2,1,null,null,b),e&2&&C(n.parts)},styles:[`.ngb-highlight{font-weight:700}
`],encapsulation:2,changeDetection:0})}}return i})(),Rt=(()=>{class i{constructor(){this.editable=!0,this.focusFirst=!0,this.selectOnExact=!1,this.showHint=!1,this.placement=["bottom-start","bottom-end","top-start","top-end"],this.popperOptions=t=>t}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275prov=B({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})(),Ot=(()=>{class i{constructor(){this.activeIdx=0,this.focusFirst=!0,this.formatter=p,this.selectEvent=new u,this.activeChangeEvent=new u}hasActive(){return this.activeIdx>-1&&this.activeIdx<this.results.length}getActive(){return this.results[this.activeIdx]}markActive(t){this.activeIdx=t,this._activeChanged()}next(){this.activeIdx===this.results.length-1?this.activeIdx=this.focusFirst?(this.activeIdx+1)%this.results.length:-1:this.activeIdx++,this._activeChanged()}prev(){this.activeIdx<0?this.activeIdx=this.results.length-1:this.activeIdx===0?this.activeIdx=this.focusFirst?this.results.length-1:-1:this.activeIdx--,this._activeChanged()}resetActive(){this.activeIdx=this.focusFirst?0:-1,this._activeChanged()}select(t){this.selectEvent.emit(t)}ngOnInit(){this.resetActive()}_activeChanged(){this.activeChangeEvent.emit(this.activeIdx>=0?this.id+"-"+this.activeIdx:void 0)}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275cmp=w({type:i,selectors:[["ngb-typeahead-window"]],hostAttrs:["role","listbox"],hostVars:3,hostBindings:function(e,n){e&1&&_("mousedown",function(l){return l.preventDefault()}),e&2&&(x("id",n.id),T("dropdown-menu show"+(n.popupClass?" "+n.popupClass:"")))},inputs:{id:"id",focusFirst:"focusFirst",results:"results",term:"term",formatter:"formatter",resultTemplate:"resultTemplate",popupClass:"popupClass"},outputs:{selectEvent:"select",activeChangeEvent:"activeChange"},exportAs:["ngbTypeaheadWindow"],decls:4,vars:0,consts:[["rt",""],["type","button","role","option",1,"dropdown-item",3,"id","active"],[3,"result","term"],["type","button","role","option",1,"dropdown-item",3,"mouseenter","click","id"],[3,"ngTemplateOutlet","ngTemplateOutletContext"]],template:function(e,n){e&1&&(v(0,It,1,2,"ng-template",null,0,rt),y(2,Et,2,9,"button",1,b)),e&2&&(c(2),C(n.results))},dependencies:[Ft,lt],encapsulation:2})}}return i})(),Dt=0,Zt=(()=>{class i{constructor(){this._nativeElement=r(U).nativeElement,this._config=r(Rt),this._live=r(mt),this._document=r(j),this._ngZone=r(W),this._changeDetector=r(ht),this._injector=r(M),this._popupService=new ft(Ot),this._positioning=pt(),this._subscription=null,this._closed$=new D,this._inputValueBackup=null,this._inputValueForSelectOnExact=null,this._valueChanges$=S(this._nativeElement,"input").pipe(k(t=>t.target.value)),this._resubscribeTypeahead$=new P(null),this._windowRef=null,this.autocomplete="off",this.container=this._config.container,this.editable=this._config.editable,this.focusFirst=this._config.focusFirst,this.selectOnExact=this._config.selectOnExact,this.showHint=this._config.showHint,this.placement=this._config.placement,this.popperOptions=this._config.popperOptions,this.selectItem=new u,this.activeDescendant=null,this.popupId=`ngb-typeahead-${Dt++}`,this._onTouched=()=>{},this._onChange=t=>{}}ngOnInit(){this._subscribeToUserInput()}ngOnChanges({ngbTypeahead:t}){t&&!t.firstChange&&(this._unsubscribeFromUserInput(),this._subscribeToUserInput())}ngOnDestroy(){this._closePopup(),this._unsubscribeFromUserInput()}registerOnChange(t){this._onChange=t}registerOnTouched(t){this._onTouched=t}writeValue(t){this._writeInputValue(this._formatItemForInput(t)),this.showHint&&(this._inputValueBackup=t)}setDisabledState(t){this._nativeElement.disabled=t}dismissPopup(){this.isPopupOpen()&&(this._resubscribeTypeahead$.next(null),this._closePopup(),this.showHint&&this._inputValueBackup!==null&&this._writeInputValue(this._inputValueBackup),this._changeDetector.markForCheck())}isPopupOpen(){return this._windowRef!=null}handleBlur(){this._resubscribeTypeahead$.next(null),this._onTouched()}handleKeyDown(t){if(this.isPopupOpen())switch(t.key){case"ArrowDown":t.preventDefault(),this._windowRef.instance.next(),this._showHint();break;case"ArrowUp":t.preventDefault(),this._windowRef.instance.prev(),this._showHint();break;case"Enter":case"Tab":{let e=this._windowRef.instance.getActive();ct(e)&&(t.preventDefault(),t.stopPropagation(),this._selectResult(e)),this._closePopup();break}}}_openPopup(){if(!this.isPopupOpen()){this._inputValueBackup=this._nativeElement.value;let{windowRef:t}=this._popupService.open();this._windowRef=t,this._windowRef.setInput("id",this.popupId),this._windowRef.setInput("popupClass",this.popupClass),this._windowRef.instance.selectEvent.subscribe(e=>this._selectResultClosePopup(e)),this._windowRef.instance.activeChangeEvent.subscribe(e=>this.activeDescendant=e),this.container==="body"&&(this._windowRef.location.nativeElement.style.zIndex="1055",this._document.body.appendChild(this._windowRef.location.nativeElement)),this._changeDetector.markForCheck(),this._ngZone.runOutsideAngular(()=>{this._windowRef&&(this._positioning.createPopper({hostElement:this._nativeElement,targetElement:this._windowRef.location.nativeElement,placement:this.placement,updatePopperOptions:e=>this.popperOptions(_t([0,2])(e))}),this._afterRenderRef=L({mixedReadWrite:()=>{this._positioning.update()}},{injector:this._injector}))}),dt(this._ngZone,this._document,"outside",()=>this.dismissPopup(),this._closed$,[this._nativeElement,this._windowRef.location.nativeElement])}}_closePopup(){this._popupService.close().subscribe(()=>{this._positioning.destroy(),this._afterRenderRef?.destroy(),this._closed$.next(),this._windowRef=null,this.activeDescendant=null})}_selectResult(t){let e=!1;this.selectItem.emit({item:t,preventDefault:()=>{e=!0}}),this._resubscribeTypeahead$.next(null),e||(this.writeValue(t),this._onChange(t))}_selectResultClosePopup(t){this._selectResult(t),this._closePopup()}_showHint(){if(this.showHint&&this._windowRef?.instance.hasActive()&&this._inputValueBackup!=null){let t=this._inputValueBackup.toLowerCase(),e=this._formatItemForInput(this._windowRef.instance.getActive());t===e.substring(0,this._inputValueBackup.length).toLowerCase()?(this._writeInputValue(this._inputValueBackup+e.substring(this._inputValueBackup.length)),this._nativeElement.setSelectionRange.apply(this._nativeElement,[this._inputValueBackup.length,e.length])):this._writeInputValue(e)}}_formatItemForInput(t){return t!=null&&this.inputFormatter?this.inputFormatter(t):p(t)}_writeInputValue(t){this._nativeElement.value=p(t)}_subscribeToUserInput(){let t=this._valueChanges$.pipe(N(e=>{this._inputValueBackup=this.showHint?e:null,this._inputValueForSelectOnExact=this.selectOnExact?e:null,this._onChange(this.editable?e:null)}),this.ngbTypeahead?this.ngbTypeahead:()=>V([]));this._subscription=this._resubscribeTypeahead$.pipe(H(()=>t)).subscribe(e=>{!e||e.length===0?this._closePopup():this.selectOnExact&&e.length===1&&this._formatItemForInput(e[0])===this._inputValueForSelectOnExact?(this._selectResult(e[0]),this._closePopup()):(this._openPopup(),this._windowRef.setInput("focusFirst",this.focusFirst),this._windowRef.setInput("results",e),this._windowRef.setInput("term",this._nativeElement.value),this.resultFormatter&&this._windowRef.setInput("formatter",this.resultFormatter),this.resultTemplate&&this._windowRef.setInput("resultTemplate",this.resultTemplate),this._windowRef.instance.resetActive(),this._windowRef.changeDetectorRef.detectChanges(),this._showHint());let n=e?e.length:0;this._live.say(n===0?"No results available":`${n} result${n===1?"":"s"} available`)})}_unsubscribeFromUserInput(){this._subscription&&this._subscription.unsubscribe(),this._subscription=null}static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275dir=Z({type:i,selectors:[["input","ngbTypeahead",""]],hostAttrs:["autocapitalize","off","autocorrect","off","role","combobox"],hostVars:7,hostBindings:function(e,n){e&1&&_("blur",function(){return n.handleBlur()})("keydown",function(l){return n.handleKeyDown(l)}),e&2&&(x("autocomplete",n.autocomplete),K("aria-autocomplete",n.showHint?"both":"list")("aria-activedescendant",n.activeDescendant)("aria-controls",n.isPopupOpen()?n.popupId:null)("aria-expanded",n.isPopupOpen()),I("open",n.isPopupOpen()))},inputs:{autocomplete:"autocomplete",container:"container",editable:"editable",focusFirst:"focusFirst",inputFormatter:"inputFormatter",ngbTypeahead:"ngbTypeahead",resultFormatter:"resultFormatter",resultTemplate:"resultTemplate",selectOnExact:"selectOnExact",showHint:"showHint",placement:"placement",popperOptions:"popperOptions",popupClass:"popupClass"},outputs:{selectItem:"selectItem"},exportAs:["ngbTypeahead"],features:[ot([{provide:gt,useExisting:$(()=>i),multi:!0}]),g]})}}return i})(),Kt=(()=>{class i{static{this.\u0275fac=function(e){return new(e||i)}}static{this.\u0275mod=z({type:i})}static{this.\u0275inj=A({})}}return i})();export{Zt as a,Kt as b};
